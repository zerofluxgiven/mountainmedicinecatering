/*! For license information please see main.8361646a.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var x=Array.isArray,_=Object.prototype.hasOwnProperty,N={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,r){var i,s={},a=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)_.call(t,i)&&!E.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:N.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function j(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function I(e,t,i,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===s?"."+j(l,0):s,x(a)?(i="",null!=e&&(i=e.replace(C,"$&/")+"/"),I(a,t,i,"",function(e){return e})):null!=a&&(S(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(C,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",x(e))for(var c=0;c<e.length;c++){var u=s+j(o=e[c],c);l+=I(o,t,i,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=I(o=o.value,t,i,u=s+j(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,n){if(null==e)return e;var r=[],i=0;return I(e,r,"","",function(e){return t.call(n,e,i++)}),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},D={transition:null},P={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:D,ReactCurrentOwner:N};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return T(e,function(){t++}),t},toArray:function(e){return T(e,function(e){return e})||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.act=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=N.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function x(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,D(_);else{var t=r(u);null!==t&&P(x,t.startTime-e)}}function _(e,n){m=!1,g&&(g=!1,y(S),S=-1),p=!0;var s=f;try{for(w(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!I());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&i(c),w(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&P(x,d.startTime-n),l=!1}return l}finally{h=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,E=!1,k=null,S=-1,C=5,j=-1;function I(){return!(t.unstable_now()-j<C)}function T(){if(null!==k){var e=t.unstable_now();j=e;var n=!0;try{n=k(!0,e)}finally{n?N():(E=!1,k=null)}}else E=!1}if("function"===typeof b)N=function(){b(T)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,R=A.port2;A.port1.onmessage=T,N=function(){R.postMessage(null)}}else N=function(){v(T,0)};function D(e){k=e,E||(E=!0,N())}function P(e,n){S=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(y(S),S=-1):g=!0,P(x,s-a))):(e.sortIndex=o,n(c,e),m||p||(m=!0,D(_))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),_=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),C=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var L,M=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var U=!1;function V(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||i[a]!==s[o]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function B(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case _:return"Portal";case k:return"Profiler";case E:return"StrictMode";case I:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case j:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(ha){return e.body}}function Q(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){X(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function se(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ve=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Ne=null,Ee=null;function ke(e){if(e=bi(e)){if("function"!==typeof _e)throw Error(s(280));var t=e.stateNode;t&&(t=xi(t),_e(e.stateNode,e.type,t))}}function Se(e){Ne?Ee?Ee.push(e):Ee=[e]:Ne=e}function Ce(){if(Ne){var e=Ne,t=Ee;if(Ee=Ne=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function je(e,t){return e(t)}function Ie(){}var Te=!1;function Ae(e,t,n){if(Te)return e(t,n);Te=!0;try{return je(e,t,n)}finally{Te=!1,(null!==Ne||null!==Ee)&&(Ie(),Ce())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=xi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(u)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(ue){De=!1}function Oe(e,t,n,r,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Le=!1,Me=null,Fe=!1,Ue=null,Ve={onError:function(e){Le=!0,Me=e}};function Be(e,t,n,r,i,s,a,o,l){Le=!1,Me=null,Oe.apply(Ve,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(ze(e)!==e)throw Error(s(188))}function He(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return qe(i),e;if(a===r)return qe(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),null!==e?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Xe=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~i;0!==o?r=dt(o):0!==(s&=a)&&(r=dt(s))}else 0!==(a=n&~i)?r=dt(a):0!==s&&(r=dt(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,_t,Nt,Et,kt,St=!1,Ct=[],jt=null,It=null,Tt=null,At=new Map,Rt=new Map,Dt=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":jt=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Lt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&_t(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Mt(e){var t=yi(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void kt(e.priority,function(){Nt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&_t(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function Vt(){St=!1,null!==jt&&Ft(jt)&&(jt=null),null!==It&&Ft(It)&&(It=null),null!==Tt&&Ft(Tt)&&(Tt=null),At.forEach(Ut),Rt.forEach(Ut)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Vt)))}function zt(e){function t(t){return Bt(t,e)}if(0<Ct.length){Bt(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==jt&&Bt(jt,e),null!==It&&Bt(It,e),null!==Tt&&Bt(Tt,e),At.forEach(t),Rt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Mt(n),null===n.blockedOn&&Dt.shift()}var $t=w.ReactCurrentBatchConfig,qt=!0;function Ht(e,t,n,r){var i=bt,s=$t.transition;$t.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=i,$t.transition=s}}function Wt(e,t,n,r){var i=bt,s=$t.transition;$t.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=i,$t.transition=s}}function Kt(e,t,n,r){if(qt){var i=Qt(e,t,n,r);if(null===i)qr(e,t,r,Gt,n),Ot(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return jt=Lt(jt,e,t,n,r,i),!0;case"dragenter":return It=Lt(It,e,t,n,r,i),!0;case"mouseover":return Tt=Lt(Tt,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return At.set(s,Lt(At.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Rt.set(s,Lt(Rt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Pt.indexOf(e)){for(;null!==i;){var s=bi(i);if(null!==s&&xt(s),null===(s=Qt(e,t,n,r))&&qr(e,t,r,Gt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Gt=null;function Qt(e,t,n,r){if(Gt=null,null!==(e=yi(e=xe(r))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,i="value"in Xt?Xt.value:Xt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=M({},cn,{view:0,detail:0}),hn=sn(dn),fn=M({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=sn(fn),mn=sn(M({},fn,{dataTransfer:0})),gn=sn(M({},dn,{relatedTarget:0})),vn=sn(M({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=M({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(yn),wn=sn(M({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function kn(){return En}var Sn=M({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=sn(Sn),jn=sn(M({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=sn(M({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),Tn=sn(M({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=M({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=sn(An),Dn=[9,13,27,32],Pn=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var Ln=u&&"TextEvent"in window&&!On,Mn=u&&(!Pn||On&&8<On&&11>=On),Fn=String.fromCharCode(32),Un=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var $n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$n[e.type]:"textarea"===t}function Hn(e,t,n,r){Se(r),0<(t=Wr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,Kn=null;function Gn(e){Fr(e,0)}function Qn(e){if(K(wi(e)))return e}function Yn(e,t){if("change"===e)return t}var Xn=!1;if(u){var Jn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;Xn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),Kn=Wn=null)}function nr(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];Hn(t,Kn,e,xe(e)),Ae(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function sr(e,t){if("click"===e)return Qn(t)}function ar(e,t){if("input"===e||"change"===e)return Qn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!or(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var a=ur(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==G(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Wr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _r={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},Nr={},Er={};function kr(e){if(Nr[e])return Nr[e];if(!_r[e])return e;var t,n=_r[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Nr[e]=n[t];return e}u&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete _r.animationend.animation,delete _r.animationiteration.animation,delete _r.animationstart.animation),"TransitionEvent"in window||delete _r.transitionend.transition);var Sr=kr("animationend"),Cr=kr("animationiteration"),jr=kr("animationstart"),Ir=kr("transitionend"),Tr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Tr.set(e,t),l(t,[e])}for(var Dr=0;Dr<Ar.length;Dr++){var Pr=Ar[Dr];Rr(Pr.toLowerCase(),"on"+(Pr[0].toUpperCase()+Pr.slice(1)))}Rr(Sr,"onAnimationEnd"),Rr(Cr,"onAnimationIteration"),Rr(jr,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Ir,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,o,l,c){if(Be.apply(this,arguments),Le){if(!Le)throw Error(s(198));var u=Me;Le=!1,Me=null,Fe||(Fe=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Mr(i,o,c),s=l}else for(a=0;a<r.length;a++){if(l=(o=r[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Mr(i,o,c),s=l}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Ur(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||($r(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),$r(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function zr(e){if(!e[Br]){e[Br]=!0,a.forEach(function(t){"selectionchange"!==t&&(Lr.has(t)||Vr(t,!1,e),Vr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,Vr("selectionchange",!1,t))}}function $r(e,t,n,r){switch(Yt(t)){case 1:var i=Ht;break;case 4:i=Wt;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==o;){if(null===(a=yi(o)))return;if(5===(l=a.tag)||6===l){r=s=a;continue e}o=o.parentNode}}r=r.return}Ae(function(){var r=s,i=xe(n),a=[];e:{var o=Tr.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case Sr:case Cr:case jr:l=vn;break;case Ir:l=Tn;break;case"scroll":l=hn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=jn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=Re(p,h))&&u.push(Hr(p,m,f)))),d)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,i),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!yi(c)&&!c[pi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?yi(c):null)&&(c!==(d=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=jn,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?o:wi(l),f=null==c?o:wi(c),(o=new u(m,p+"leave",l,n,i)).target=d,o.relatedTarget=f,m=null,yi(i)===r&&((u=new u(h,p+"enter",c,n,i)).target=f,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Kr(f))p++;for(f=0,m=h;m;m=Kr(m))f++;for(;0<p-f;)u=Kr(u),p--;for(;0<f-p;)h=Kr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Kr(u),h=Kr(h)}u=null}else u=null;null!==l&&Gr(a,o,l,u,!1),null!==c&&null!==d&&Gr(a,d,c,u,!0)}if("select"===(l=(o=r?wi(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Yn;else if(qn(o))if(Xn)g=ar;else{g=ir;var v=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=sr);switch(g&&(g=g(e,r))?Hn(a,g,n,i):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=r?wi(r):window,e){case"focusin":(qn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(a,n,i)}var y;if(Pn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else zn?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Mn&&"ko"!==n.locale&&(zn||"onCompositionStart"!==b?"onCompositionEnd"===b&&zn&&(y=en()):(Jt="value"in(Xt=i)?Xt.value:Xt.textContent,zn=!0)),0<(v=Wr(r,b)).length&&(b=new wn(b,e,null,n,i),a.push({event:b,listeners:v}),y?b.data=y:null!==(y=Bn(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!Pn&&Vn(e,t)?(e=en(),Zt=Jt=Xt=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Wr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=y))}Fr(a,t)})}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Re(e,n))&&r.unshift(Hr(e,s,i)),null!=(s=Re(e,t))&&r.push(Hr(e,s,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,i){for(var s=t._reactName,a=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=Re(n,s))&&a.unshift(Hr(n,l,o)):i||null!=(l=Re(n,s))&&a.push(Hr(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Qr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Yr,"")}function Jr(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(oi)}:ri;function oi(e){setTimeout(function(){throw e})}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void zt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);zt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,fi="__reactProps$"+di,pi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,vi="__reactHandles$"+di;function yi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[hi])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function xi(e){return e[fi]||null}var _i=[],Ni=-1;function Ei(e){return{current:e}}function ki(e){0>Ni||(e.current=_i[Ni],_i[Ni]=null,Ni--)}function Si(e,t){Ni++,_i[Ni]=e.current,e.current=t}var Ci={},ji=Ei(Ci),Ii=Ei(!1),Ti=Ci;function Ai(e,t){var n=e.type.contextTypes;if(!n)return Ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ri(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Di(){ki(Ii),ki(ji)}function Pi(e,t,n){if(ji.current!==Ci)throw Error(s(168));Si(ji,t),Si(Ii,n)}function Oi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,$(e)||"Unknown",i));return M({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,Ti=ji.current,Si(ji,e),Si(Ii,Ii.current),!0}function Mi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Oi(e,t,Ti),r.__reactInternalMemoizedMergedChildContext=e,ki(Ii),ki(ji),Si(ji,e)):ki(Ii),Si(Ii,n)}var Fi=null,Ui=!1,Vi=!1;function Bi(e){null===Fi?Fi=[e]:Fi.push(e)}function zi(){if(!Vi&&null!==Fi){Vi=!0;var e=0,t=bt;try{var n=Fi;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fi=null,Ui=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),Ke(Ze,zi),i}finally{bt=t,Vi=!1}}return null}var $i=[],qi=0,Hi=null,Wi=0,Ki=[],Gi=0,Qi=null,Yi=1,Xi="";function Ji(e,t){$i[qi++]=Wi,$i[qi++]=Hi,Hi=e,Wi=t}function Zi(e,t,n){Ki[Gi++]=Yi,Ki[Gi++]=Xi,Ki[Gi++]=Qi,Qi=e;var r=Yi;e=Xi;var i=32-at(r)-1;r&=~(1<<i),n+=1;var s=32-at(t)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Yi=1<<32-at(t)+i|n<<i|r,Xi=s+e}else Yi=1<<s|n<<i|r,Xi=e}function es(e){null!==e.return&&(Ji(e,1),Zi(e,1,0))}function ts(e){for(;e===Hi;)Hi=$i[--qi],$i[qi]=null,Wi=$i[--qi],$i[qi]=null;for(;e===Qi;)Qi=Ki[--Gi],Ki[Gi]=null,Xi=Ki[--Gi],Ki[Gi]=null,Yi=Ki[--Gi],Ki[Gi]=null}var ns=null,rs=null,is=!1,ss=null;function as(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qi?{id:Yi,overflow:Xi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(is){var t=rs;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=ci(n.nextSibling);var r=ns;t&&os(e,t)?as(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function ds(e){if(e!==ns)return!1;if(!is)return us(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw hs(),Error(s(418));for(;t;)as(e,t),t=ci(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ci(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=rs;e;)e=ci(e.nextSibling)}function fs(){rs=ns=null,is=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var ms=w.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===N?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===R&&ys(s)===t.type)?((r=i(t,n.props)).ref=gs(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=gs(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=Lc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case _:return(t=Uc(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Lc(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===i?c(e,t,n,r):null;case _:return n.key===i?u(e,t,n,r):null;case R:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||O(n))return null!==i?null:d(e,t,n,r,null);vs(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case _:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case R:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||O(r))return d(t,e=e.get(n)||null,r,i,null);vs(t,r)}return null}function m(i,s,o,l){for(var c=null,u=null,d=s,m=s=0,g=null;null!==d&&m<o.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=f(i,d,o[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(i,d),s=a(v,s,m),null===u?c=v:u.sibling=v,u=v,d=g}if(m===o.length)return n(i,d),is&&Ji(i,m),c;if(null===d){for(;m<o.length;m++)null!==(d=h(i,o[m],l))&&(s=a(d,s,m),null===u?c=d:u.sibling=d,u=d);return is&&Ji(i,m),c}for(d=r(i,d);m<o.length;m++)null!==(g=p(d,i,m,o[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=a(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(i,e)}),is&&Ji(i,m),c}function g(i,o,l,c){var u=O(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=f(i,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),o=a(b,o,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(i,m),is&&Ji(i,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(i,y.value,c))&&(o=a(y,o,g),null===d?u=y:d.sibling=y,d=y);return is&&Ji(i,g),u}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=p(m,i,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=a(y,o,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach(function(e){return t(i,e)}),is&&Ji(i,g),u}return function e(r,s,a,l){if("object"===typeof a&&null!==a&&a.type===N&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case x:e:{for(var c=a.key,u=s;null!==u;){if(u.key===c){if((c=a.type)===N){if(7===u.tag){n(r,u.sibling),(s=i(u,a.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&ys(c)===u.type){n(r,u.sibling),(s=i(u,a.props)).ref=gs(r,u,a),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===N?((s=Lc(a.props.children,r.mode,l,a.key)).return=r,r=s):((l=Oc(a.type,a.key,a.props,null,r.mode,l)).ref=gs(r,s,a),l.return=r,r=l)}return o(r);case _:e:{for(u=a.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(r,s.sibling),(s=i(s,a.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Uc(a,r.mode,l)).return=r,r=s}return o(r);case R:return e(r,s,(u=a._init)(a._payload),l)}if(te(a))return m(r,s,a,l);if(O(a))return g(r,s,a,l);vs(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,a)).return=r,r=s):(n(r,s),(s=Fc(a,r.mode,l)).return=r,r=s),o(r)):n(r,s)}}var ws=bs(!0),xs=bs(!1),_s=Ei(null),Ns=null,Es=null,ks=null;function Ss(){ks=Es=Ns=null}function Cs(e){var t=_s.current;ki(_s),e._currentValue=t}function js(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Is(e,t){Ns=e,ks=Es=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wo=!0),e.firstContext=null)}function Ts(e){var t=e._currentValue;if(ks!==e)if(e={context:e,memoizedValue:t,next:null},null===Es){if(null===Ns)throw Error(s(308));Es=e,Ns.dependencies={lanes:0,firstContext:e}}else Es=Es.next=e;return t}var As=null;function Rs(e){null===As?As=[e]:As.push(e)}function Ds(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Rs(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ps(e,r)}function Ps(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Os=!1;function Ls(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ms(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Il)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ps(e,n)}return null===(i=r.interleaved)?(t.next=t,Rs(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ps(e,n)}function Vs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Bs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zs(e,t,n,r){var i=e.updateQueue;Os=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=i.baseState;for(a=0,u=c=l=null,o=s;;){var h=o.lane,f=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(h=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=m.payload)?p.call(f,d,h):p)||void 0===h)break e;d=M({},d,h);break e;case 2:Os=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,a|=h;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(h=o).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Ml|=a,e.lanes=a,e.memoizedState=d}}function $s(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var qs={},Hs=Ei(qs),Ws=Ei(qs),Ks=Ei(qs);function Gs(e){if(e===qs)throw Error(s(174));return e}function Qs(e,t){switch(Si(Ks,t),Si(Ws,e),Si(Hs,qs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ki(Hs),Si(Hs,t)}function Ys(){ki(Hs),ki(Ws),ki(Ks)}function Xs(e){Gs(Ks.current);var t=Gs(Hs.current),n=le(t,e.type);t!==n&&(Si(Ws,e),Si(Hs,n))}function Js(e){Ws.current===e&&(ki(Hs),ki(Ws))}var Zs=Ei(0);function ea(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ta=[];function na(){for(var e=0;e<ta.length;e++)ta[e]._workInProgressVersionPrimary=null;ta.length=0}var ra=w.ReactCurrentDispatcher,ia=w.ReactCurrentBatchConfig,sa=0,aa=null,oa=null,la=null,ca=!1,ua=!1,da=0,fa=0;function pa(){throw Error(s(321))}function ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ga(e,t,n,r,i,a){if(sa=a,aa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ra.current=null===e||null===e.memoizedState?Za:eo,e=n(r,i),ua){a=0;do{if(ua=!1,da=0,25<=a)throw Error(s(301));a+=1,la=oa=null,t.updateQueue=null,ra.current=to,e=n(r,i)}while(ua)}if(ra.current=Ja,t=null!==oa&&null!==oa.next,sa=0,la=oa=aa=null,ca=!1,t)throw Error(s(300));return e}function va(){var e=0!==da;return da=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=e:la=la.next=e,la}function ba(){if(null===oa){var e=aa.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===la?aa.memoizedState:la.next;if(null!==t)la=t,oa=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=e:la=la.next=e}return la}function wa(e,t){return"function"===typeof t?t(e):t}function xa(e){var t=ba(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=oa,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((sa&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,aa.lanes|=d,Ml|=d}u=u.next}while(null!==u&&u!==a);null===c?o=r:c.next=l,or(r,t.memoizedState)||(wo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,aa.lanes|=a,Ml|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function _a(e){var t=ba(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);or(a,t.memoizedState)||(wo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Na(){}function Ea(e,t){var n=aa,r=ba(),i=t(),a=!or(r.memoizedState,i);if(a&&(r.memoizedState=i,wo=!0),r=r.queue,La(Ca.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,Aa(9,Sa.bind(null,n,r,i,t),void 0,null),null===Tl)throw Error(s(349));0!==(30&sa)||ka(n,t,i)}return i}function ka(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Sa(e,t,n,r){t.value=n,t.getSnapshot=r,ja(t)&&Ia(e)}function Ca(e,t,n){return n(function(){ja(t)&&Ia(e)})}function ja(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Ia(e){var t=Ps(e,1);null!==t&&rc(t,e,1,-1)}function Ta(e){var t=ya();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:e},t.queue=e,e=e.dispatch=Ga.bind(null,aa,e),[t.memoizedState,e]}function Aa(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ra(){return ba().memoizedState}function Da(e,t,n,r){var i=ya();aa.flags|=e,i.memoizedState=Aa(1|t,n,void 0,void 0===r?null:r)}function Pa(e,t,n,r){var i=ba();r=void 0===r?null:r;var s=void 0;if(null!==oa){var a=oa.memoizedState;if(s=a.destroy,null!==r&&ma(r,a.deps))return void(i.memoizedState=Aa(t,n,s,r))}aa.flags|=e,i.memoizedState=Aa(1|t,n,s,r)}function Oa(e,t){return Da(8390656,8,e,t)}function La(e,t){return Pa(2048,8,e,t)}function Ma(e,t){return Pa(4,2,e,t)}function Fa(e,t){return Pa(4,4,e,t)}function Ua(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Va(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pa(4,4,Ua.bind(null,t,e),n)}function Ba(){}function za(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $a(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qa(e,t,n){return 0===(21&sa)?(e.baseState&&(e.baseState=!1,wo=!0),e.memoizedState=n):(or(n,t)||(n=mt(),aa.lanes|=n,Ml|=n,e.baseState=!0),t)}function Ha(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ia.transition;ia.transition={};try{e(!1),t()}finally{bt=n,ia.transition=r}}function Wa(){return ba().memoizedState}function Ka(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qa(e))Ya(t,n);else if(null!==(n=Ds(e,t,n,r))){rc(n,e,r,tc()),Xa(n,t,r)}}function Ga(e,t,n){var r=nc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qa(e))Ya(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,or(o,a)){var l=t.interleaved;return null===l?(i.next=i,Rs(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ds(e,t,i,r))&&(rc(n,e,r,i=tc()),Xa(n,t,r))}}function Qa(e){var t=e.alternate;return e===aa||null!==t&&t===aa}function Ya(e,t){ua=ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xa(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Ja={readContext:Ts,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useInsertionEffect:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useMutableSource:pa,useSyncExternalStore:pa,useId:pa,unstable_isNewReconciler:!1},Za={readContext:Ts,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:Ts,useEffect:Oa,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Da(4194308,4,Ua.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Da(4194308,4,e,t)},useInsertionEffect:function(e,t){return Da(4,2,e,t)},useMemo:function(e,t){var n=ya();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ya();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ka.bind(null,aa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:Ta,useDebugValue:Ba,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=Ta(!1),t=e[0];return e=Ha.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=aa,i=ya();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Tl)throw Error(s(349));0!==(30&sa)||ka(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Oa(Ca.bind(null,r,a,e),[e]),r.flags|=2048,Aa(9,Sa.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=ya(),t=Tl.identifierPrefix;if(is){var n=Xi;t=":"+t+"R"+(n=(Yi&~(1<<32-at(Yi)-1)).toString(32)+n),0<(n=da++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},eo={readContext:Ts,useCallback:za,useContext:Ts,useEffect:La,useImperativeHandle:Va,useInsertionEffect:Ma,useLayoutEffect:Fa,useMemo:$a,useReducer:xa,useRef:Ra,useState:function(){return xa(wa)},useDebugValue:Ba,useDeferredValue:function(e){return qa(ba(),oa.memoizedState,e)},useTransition:function(){return[xa(wa)[0],ba().memoizedState]},useMutableSource:Na,useSyncExternalStore:Ea,useId:Wa,unstable_isNewReconciler:!1},to={readContext:Ts,useCallback:za,useContext:Ts,useEffect:La,useImperativeHandle:Va,useInsertionEffect:Ma,useLayoutEffect:Fa,useMemo:$a,useReducer:_a,useRef:Ra,useState:function(){return _a(wa)},useDebugValue:Ba,useDeferredValue:function(e){var t=ba();return null===oa?t.memoizedState=e:qa(t,oa.memoizedState,e)},useTransition:function(){return[_a(wa)[0],ba().memoizedState]},useMutableSource:Na,useSyncExternalStore:Ea,useId:Wa,unstable_isNewReconciler:!1};function no(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ro(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),s=Fs(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(rc(t,e,i,r),Vs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),s=Fs(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(rc(t,e,i,r),Vs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),i=Fs(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Us(e,i,r))&&(rc(t,e,r,n),Vs(t,e,r))}};function so(e,t,n,r,i,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function ao(e,t,n){var r=!1,i=Ci,s=t.contextType;return"object"===typeof s&&null!==s?s=Ts(s):(i=Ri(t)?Ti:ji.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ai(e,i):Ci),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function oo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function lo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Ls(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Ts(s):(s=Ri(t)?Ti:ji.current,i.context=Ai(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ro(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&io.enqueueReplaceState(i,i.state,null),zs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function co(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function uo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var fo="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=Fs(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Wl=r),ho(0,t)},n}function mo(e,t,n){(n=Fs(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ho(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ho(0,t),"function"!==typeof r&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function go(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fo;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function vo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fs(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var bo=w.ReactCurrentOwner,wo=!1;function xo(e,t,n,r){t.child=null===e?xs(t,null,n,r):ws(t,e.child,n,r)}function _o(e,t,n,r,i){n=n.render;var s=t.ref;return Is(t,i),r=ga(e,t,n,r,s,i),n=va(),null===e||wo?(is&&n&&es(t),t.flags|=1,xo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ho(e,t,i))}function No(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Dc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Eo(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return Ho(e,t,i)}return t.flags|=1,(e=Pc(s,r)).ref=t.ref,e.return=t,t.child=e}function Eo(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(wo=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Ho(e,t,i);0!==(131072&e.flags)&&(wo=!0)}}return Co(e,t,n,r,i)}function ko(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Si(Pl,Dl),Dl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Si(Pl,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Si(Pl,Dl),Dl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Si(Pl,Dl),Dl|=r;return xo(e,t,i,n),t.child}function So(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Co(e,t,n,r,i){var s=Ri(n)?Ti:ji.current;return s=Ai(t,s),Is(t,i),n=ga(e,t,n,r,s,i),r=va(),null===e||wo?(is&&r&&es(t),t.flags|=1,xo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ho(e,t,i))}function jo(e,t,n,r,i){if(Ri(n)){var s=!0;Li(t)}else s=!1;if(Is(t,i),null===t.stateNode)qo(e,t),ao(t,n,r),lo(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ts(c):c=Ai(t,c=Ri(n)?Ti:ji.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==c)&&oo(t,a,r,c),Os=!1;var h=t.memoizedState;a.state=h,zs(t,r,a,i),l=t.memoizedState,o!==r||h!==l||Ii.current||Os?("function"===typeof u&&(ro(t,n,u,r),l=t.memoizedState),(o=Os||so(t,n,o,r,h,l,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Ms(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:no(t.type,o),a.props=c,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ts(l):l=Ai(t,l=Ri(n)?Ti:ji.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&oo(t,a,r,l),Os=!1,h=t.memoizedState,a.state=h,zs(t,r,a,i);var p=t.memoizedState;o!==d||h!==p||Ii.current||Os?("function"===typeof f&&(ro(t,n,f,r),p=t.memoizedState),(c=Os||so(t,n,c,r,h,p,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Io(e,t,n,r,s,i)}function Io(e,t,n,r,i,s){So(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Mi(t,n,!1),Ho(e,t,s);r=t.stateNode,bo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,o,s)):xo(e,t,o,s),t.memoizedState=r.state,i&&Mi(t,n,!0),t.child}function To(e){var t=e.stateNode;t.pendingContext?Pi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pi(0,t.context,!1),Qs(e,t.containerInfo)}function Ao(e,t,n,r,i){return fs(),ps(i),t.flags|=256,xo(e,t,n,r),t.child}var Ro,Do,Po,Oo,Lo={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,n){var r,i=t.pendingProps,a=Zs.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Si(Zs,1&a),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Mc(l,i,0,null),e=Lc(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(n),t.memoizedState=Lo,e):Uo(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,o){if(n)return 256&t.flags?(t.flags&=-257,Vo(e,t,o,r=uo(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Mc({mode:"visible",children:r.children},i,0,null),(a=Lc(a,i,o,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&ws(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=Lo,a);if(0===(1&t.mode))return Vo(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Vo(e,t,o,r=uo(a=Error(s(419)),r,void 0))}if(l=0!==(o&e.childLanes),wo||l){if(null!==(r=Tl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|o))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Ps(e,i),rc(r,e,i,-1))}return gc(),Vo(e,t,o,r=uo(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=jc.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,rs=ci(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Ki[Gi++]=Yi,Ki[Gi++]=Xi,Ki[Gi++]=Qi,Yi=e.id,Xi=e.overflow,Qi=t),t=Uo(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,a,n);if(o){o=i.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Pc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?o=Pc(r,o):(o=Lc(o,l,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?Mo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Lo,i}return e=(o=e.child).sibling,i=Pc(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Uo(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Vo(e,t,n,r){return null!==r&&ps(r),ws(t,e.child,null,n),(e=Uo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),js(e.return,t,n)}function zo(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function $o(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(xo(e,t,r.children,n),0!==(2&(r=Zs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bo(e,n,t);else if(19===e.tag)Bo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Si(Zs,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ea(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),zo(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ea(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}zo(t,!0,n,null,s);break;case"together":zo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ho(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Wo(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Go(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Ri(t.type)&&Di(),Ko(t),null;case 3:return r=t.stateNode,Ys(),ki(Ii),ki(ji),na(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Do(e,t),Ko(t),null;case 5:Js(t);var i=Gs(Ks.current);if(n=t.type,null!==e&&null!=t.stateNode)Po(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ko(t),null}if(e=Gs(Hs.current),ds(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hi]=t,r[fi]=a,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<Or.length;i++)Ur(Or[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":Y(r,a),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ur("invalid",r);break;case"textarea":ie(r,a),Ur("invalid",r)}for(var l in ye(n,a),i=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":W(r),Z(r,a,!0);break;case"textarea":W(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[fi]=r,Ro(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<Or.length;i++)Ur(Or[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":Y(e,r),i=Q(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=M({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(a in ye(n,i),c=i)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Ur("scroll",e):null!=u&&b(e,a,u,l))}switch(n){case"input":W(e),Z(e,r,!1);break;case"textarea":W(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)Oo(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Gs(Ks.current),Gs(Hs.current),ds(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(a=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Ko(t),null;case 13:if(ki(Zs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))hs(),fs(),t.flags|=98560,a=!1;else if(a=ds(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[hi]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),a=!1}else null!==ss&&(oc(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Ol&&(Ol=3):gc())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return Ys(),Do(e,t),null===e&&zr(t.stateNode.containerInfo),Ko(t),null;case 10:return Cs(t.type._context),Ko(t),null;case 19:if(ki(Zs),null===(a=t.memoizedState))return Ko(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Wo(a,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ea(e))){for(t.flags|=128,Wo(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Si(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==a.tail&&Xe()>$l&&(t.flags|=128,r=!0,Wo(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ea(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Wo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!is)return Ko(t),null}else 2*Xe()-a.renderingStartTime>$l&&1073741824!==n&&(t.flags|=128,r=!0,Wo(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Xe(),t.sibling=null,n=Zs.current,Si(Zs,r?1&n|2:1&n),t):(Ko(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Qo(e,t){switch(ts(t),t.tag){case 1:return Ri(t.type)&&Di(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),ki(Ii),ki(ji),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Js(t),null;case 13:if(ki(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ki(Zs),null;case 4:return Ys(),null;case 10:return Cs(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ro=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Do=function(){},Po=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Gs(Hs.current);var s,a=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),a=[];break;case"select":i=M({},i,{value:void 0}),r=M({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ye(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Oo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Yo=!1,Xo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Zo=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){kc(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){kc(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&tl(t,n,s)}i=i.next}while(i!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[fi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var dl=null,hl=!1;function fl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(o){}switch(n.tag){case 5:Xo||el(n,t);case 6:var r=dl,i=hl;dl=null,fl(e,t,n),hl=i,null!==(dl=r)&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),zt(e)):li(dl,n.stateNode));break;case 4:r=dl,i=hl,dl=n.stateNode.containerInfo,hl=!0,fl(e,t,n),dl=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Xo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&tl(n,t,a),i=i.next}while(i!==r)}fl(e,t,n);break;case 1:if(!Xo&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){kc(n,t,o)}fl(e,t,n);break;case 21:fl(e,t,n);break;case 22:1&n.mode?(Xo=(r=Xo)||null!==n.memoizedState,fl(e,t,n),Xo=r):fl(e,t,n);break;default:fl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jo),t.forEach(function(t){var r=Ic.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,hl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===dl)throw Error(s(160));pl(a,o,i),dl=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){kc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),yl(e),4&r){try{rl(3,e,e.return),il(3,e)}catch(g){kc(e,e.return,g)}try{rl(5,e,e.return)}catch(g){kc(e,e.return,g)}}break;case 1:gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){kc(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&X(i,a),be(l,o);var u=be(l,a);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):b(i,d,h,u)}switch(l){case"input":J(i,a);break;case"textarea":se(i,a);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(i,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[fi]=a}catch(g){kc(e,e.return,g)}}break;case 6:if(gl(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){kc(e,e.return,g)}}break;case 3:if(gl(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(g){kc(e,e.return,g)}break;case 4:default:gl(t,e),yl(e);break;case 13:gl(t,e),yl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(zl=Xe())),4&r&&ml(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xo=(u=Xo)||d,gl(t,e),Xo=u):gl(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Zo=e,d=e.child;null!==d;){for(h=Zo=d;null!==Zo;){switch(p=(f=Zo).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:el(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){kc(r,n,g)}}break;case 5:el(f,f.return);break;case 22:if(null!==f.memoizedState){_l(h);continue}}null!==p?(p.return=f,Zo=p):_l(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){kc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){kc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gl(t,e),yl(e),4&r&&ml(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),ul(e,ll(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;cl(e,ll(e),a);break;default:throw Error(s(161))}}catch(o){kc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Zo=e,wl(e,t,n)}function wl(e,t,n){for(var r=0!==(1&e.mode);null!==Zo;){var i=Zo,s=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Yo;if(!a){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Xo;o=Yo;var c=Xo;if(Yo=a,(Xo=l)&&!c)for(Zo=i;null!==Zo;)l=(a=Zo).child,22===a.tag&&null!==a.memoizedState?Nl(i):null!==l?(l.return=a,Zo=l):Nl(i);for(;null!==s;)Zo=s,wl(s,t,n),s=s.sibling;Zo=i,Yo=o,Xo=c}xl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Zo=s):xl(e)}}function xl(e){for(;null!==Zo;){var t=Zo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xo||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xo)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:no(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&$s(t,a,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}$s(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&zt(h)}}}break;default:throw Error(s(163))}Xo||512&t.flags&&sl(t)}catch(f){kc(t,t.return,f)}}if(t===e){Zo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zo=n;break}Zo=t.return}}function _l(e){for(;null!==Zo;){var t=Zo;if(t===e){Zo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zo=n;break}Zo=t.return}}function Nl(e){for(;null!==Zo;){var t=Zo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){kc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){kc(t,i,l)}}var s=t.return;try{sl(t)}catch(l){kc(t,s,l)}break;case 5:var a=t.return;try{sl(t)}catch(l){kc(t,a,l)}}}catch(l){kc(t,t.return,l)}if(t===e){Zo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Zo=o;break}Zo=t.return}}var El,kl=Math.ceil,Sl=w.ReactCurrentDispatcher,Cl=w.ReactCurrentOwner,jl=w.ReactCurrentBatchConfig,Il=0,Tl=null,Al=null,Rl=0,Dl=0,Pl=Ei(0),Ol=0,Ll=null,Ml=0,Fl=0,Ul=0,Vl=null,Bl=null,zl=0,$l=1/0,ql=null,Hl=!1,Wl=null,Kl=null,Gl=!1,Ql=null,Yl=0,Xl=0,Jl=null,Zl=-1,ec=0;function tc(){return 0!==(6&Il)?Xe():-1!==Zl?Zl:Zl=Xe()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Il)&&0!==Rl?Rl&-Rl:null!==ms.transition?(0===ec&&(ec=mt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,n,r){if(50<Xl)throw Xl=0,Jl=null,Error(s(185));vt(e,n,r),0!==(2&Il)&&e===Tl||(e===Tl&&(0===(2&Il)&&(Fl|=n),4===Ol&&lc(e,Rl)),ic(e,r),1===n&&0===Il&&0===(1&t.mode)&&($l=Xe()+500,Ui&&zi()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=i[a];-1===l?0!==(o&n)&&0===(o&r)||(i[a]=ft(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var r=ht(e,e===Tl?Rl:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Ui=!0,Bi(e)}(cc.bind(null,e)):Bi(cc.bind(null,e)),ai(function(){0===(6&Il)&&zi()}),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Zl=-1,ec=0,0!==(6&Il))throw Error(s(327));var n=e.callbackNode;if(Nc()&&e.callbackNode!==n)return null;var r=ht(e,e===Tl?Rl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var i=Il;Il|=2;var a=mc();for(Tl===e&&Rl===t||(ql=null,$l=Xe()+500,fc(e,t));;)try{bc();break}catch(l){pc(e,l)}Ss(),Sl.current=a,Il=i,null!==Al?t=0:(Tl=null,Rl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=ac(e,i))),1===t)throw n=Ll,fc(e,0),lc(e,r),ic(e,Xe()),n;if(6===t)lc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!or(s(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vc(e,r))&&(0!==(a=pt(e))&&(r=a,t=ac(e,a))),1===t))throw n=Ll,fc(e,0),lc(e,r),ic(e,Xe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:_c(e,Bl,ql);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=zl+500-Xe())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(_c.bind(null,e,Bl,ql),t);break}_c(e,Bl,ql);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-at(r);a=1<<o,(o=t[o])>i&&(i=o),r&=~a}if(r=i,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kl(r/1960))-r)){e.timeoutHandle=ri(_c.bind(null,e,Bl,ql),r);break}_c(e,Bl,ql);break;default:throw Error(s(329))}}}return ic(e,Xe()),e.callbackNode===n?sc.bind(null,e):null}function ac(e,t){var n=Vl;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Bl,Bl=n,null!==t&&oc(t)),e}function oc(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function lc(e,t){for(t&=~Ul,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Il))throw Error(s(327));Nc();var t=ht(e,0);if(0===(1&t))return ic(e,Xe()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Ll,fc(e,0),lc(e,t),ic(e,Xe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,Bl,ql),ic(e,Xe()),null}function uc(e,t){var n=Il;Il|=1;try{return e(t)}finally{0===(Il=n)&&($l=Xe()+500,Ui&&zi())}}function dc(e){null!==Ql&&0===Ql.tag&&0===(6&Il)&&Nc();var t=Il;Il|=1;var n=jl.transition,r=bt;try{if(jl.transition=null,bt=1,e)return e()}finally{bt=r,jl.transition=n,0===(6&(Il=t))&&zi()}}function hc(){Dl=Pl.current,ki(Pl)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Di();break;case 3:Ys(),ki(Ii),ki(ji),na();break;case 5:Js(r);break;case 4:Ys();break;case 13:case 19:ki(Zs);break;case 10:Cs(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Tl=e,Al=e=Pc(e.current,null),Rl=Dl=t,Ol=0,Ll=null,Ul=Fl=Ml=0,Bl=Vl=null,null!==As){for(t=0;t<As.length;t++)if(null!==(r=(n=As[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var a=s.next;s.next=i,r.next=a}n.pending=r}As=null}return e}function pc(e,t){for(;;){var n=Al;try{if(Ss(),ra.current=Ja,ca){for(var r=aa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ca=!1}if(sa=0,la=oa=aa=null,ua=!1,da=0,Cl.current=null,null===n||null===n.return){Ol=1,Ll=t,Al=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=vo(o);if(null!==p){p.flags&=-257,yo(p,o,l,0,t),1&p.mode&&go(a,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){go(a,u,t),gc();break e}c=Error(s(426))}else if(is&&1&l.mode){var v=vo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),yo(v,o,l,0,t),ps(co(c,l));break e}}a=c=co(c,l),4!==Ol&&(Ol=2),null===Vl?Vl=[a]:Vl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Bs(a,po(0,c,t));break e;case 1:l=c;var y=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Kl||!Kl.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,Bs(a,mo(a,l,t));break e}}a=a.return}while(null!==a)}xc(n)}catch(w){t=w,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function mc(){var e=Sl.current;return Sl.current=Ja,null===e?Ja:e}function gc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Tl||0===(268435455&Ml)&&0===(268435455&Fl)||lc(Tl,Rl)}function vc(e,t){var n=Il;Il|=2;var r=mc();for(Tl===e&&Rl===t||(ql=null,fc(e,t));;)try{yc();break}catch(i){pc(e,i)}if(Ss(),Il=n,Sl.current=r,null!==Al)throw Error(s(261));return Tl=null,Rl=0,Ol}function yc(){for(;null!==Al;)wc(Al)}function bc(){for(;null!==Al&&!Qe();)wc(Al)}function wc(e){var t=El(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?xc(e):Al=t,Cl.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Go(n,t,Dl)))return void(Al=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Ol=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Ol&&(Ol=5)}function _c(e,t,n){var r=bt,i=jl.transition;try{jl.transition=null,bt=1,function(e,t,n,r){do{Nc()}while(null!==Ql);if(0!==(6&Il))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,a),e===Tl&&(Al=Tl=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Tc(tt,function(){return Nc(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=jl.transition,jl.transition=null;var o=bt;bt=1;var l=Il;Il|=4,Cl.current=null,function(e,t){if(ei=qt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(x){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=o+i),h!==a||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=o),f===a&&++d===r&&(c=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},qt=!1,Zo=t;null!==Zo;)if(e=(t=Zo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zo=e;else for(;null!==Zo;){t=Zo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:no(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(x){kc(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Zo=e;break}Zo=t.return}m=nl,nl=!1}(e,n),vl(n,e),pr(ti),qt=!!ei,ti=ei=null,e.current=n,bl(n,e,i),Ye(),Il=l,bt=o,jl.transition=a}else e.current=n;if(Gl&&(Gl=!1,Ql=e,Yl=i),a=e.pendingLanes,0===a&&(Kl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hl)throw Hl=!1,e=Wl,Wl=null,e;0!==(1&Yl)&&0!==e.tag&&Nc(),a=e.pendingLanes,0!==(1&a)?e===Jl?Xl++:(Xl=0,Jl=e):Xl=0,zi()}(e,t,n,r)}finally{jl.transition=i,bt=r}return null}function Nc(){if(null!==Ql){var e=wt(Yl),t=jl.transition,n=bt;try{if(jl.transition=null,bt=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Yl=0,0!==(6&Il))throw Error(s(331));var i=Il;for(Il|=4,Zo=e.current;null!==Zo;){var a=Zo,o=a.child;if(0!==(16&Zo.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zo=u;null!==Zo;){var d=Zo;switch(d.tag){case 0:case 11:case 15:rl(8,d,a)}var h=d.child;if(null!==h)h.return=d,Zo=h;else for(;null!==Zo;){var f=(d=Zo).sibling,p=d.return;if(al(d),d===u){Zo=null;break}if(null!==f){f.return=p,Zo=f;break}Zo=p}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Zo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Zo=o;else e:for(;null!==Zo;){if(0!==(2048&(a=Zo).flags))switch(a.tag){case 0:case 11:case 15:rl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Zo=y;break e}Zo=a.return}}var b=e.current;for(Zo=b;null!==Zo;){var w=(o=Zo).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,Zo=w;else e:for(o=b;null!==Zo;){if(0!==(2048&(l=Zo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(_){kc(l,l.return,_)}if(l===o){Zo=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Zo=x;break e}Zo=l.return}}if(Il=i,zi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(_){}r=!0}return r}finally{bt=n,jl.transition=t}}return!1}function Ec(e,t,n){e=Us(e,t=po(0,t=co(n,t),1),1),t=tc(),null!==e&&(vt(e,1,t),ic(e,t))}function kc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kl||!Kl.has(r))){t=Us(t,e=mo(t,e=co(n,e),1),1),e=tc(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Rl&n)===n&&(4===Ol||3===Ol&&(130023424&Rl)===Rl&&500>Xe()-zl?fc(e,0):Ul|=n),ic(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Ps(e,t))&&(vt(e,t,n),ic(e,n))}function jc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Ic(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Cc(e,n)}function Tc(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,r){return new Ac(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,i,a){var o=2;if(r=e,"function"===typeof e)Dc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case N:return Lc(n.children,i,a,t);case E:o=8,i|=8;break;case k:return(e=Rc(12,n,t,2|i)).elementType=k,e.lanes=a,e;case I:return(e=Rc(13,n,t,i)).elementType=I,e.lanes=a,e;case T:return(e=Rc(19,n,t,i)).elementType=T,e.lanes=a,e;case D:return Mc(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:o=10;break e;case C:o=9;break e;case j:o=11;break e;case A:o=14;break e;case R:o=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Rc(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Lc(e,t,n,r){return(e=Rc(7,e,r,t)).lanes=n,e}function Mc(e,t,n,r){return(e=Rc(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,r,i,s,a,o,l){return e=new Vc(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Rc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ls(s),e}function zc(e){if(!e)return Ci;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Ri(n))return Oi(e,n,t)}return t}function $c(e,t,n,r,i,s,a,o,l){return(e=Bc(n,r,!0,e,0,s,0,o,l)).context=zc(null),n=e.current,(s=Fs(r=tc(),i=nc(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,i),e.current.lanes=i,vt(e,i,r),ic(e,r),e}function qc(e,t,n,r){var i=t.current,s=tc(),a=nc(i);return n=zc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fs(s,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Us(i,t,a))&&(rc(e,i,a,s),Vs(e,i,a)),a}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}El=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ii.current)wo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wo=!1,function(e,t,n){switch(t.tag){case 3:To(t),fs();break;case 5:Xs(t);break;case 1:Ri(t.type)&&Li(t);break;case 4:Qs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Si(_s,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Si(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fo(e,t,n):(Si(Zs,1&Zs.current),null!==(e=Ho(e,t,n))?e.sibling:null);Si(Zs,1&Zs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return $o(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Si(Zs,Zs.current),r)break;return null;case 22:case 23:return t.lanes=0,ko(e,t,n)}return Ho(e,t,n)}(e,t,n);wo=0!==(131072&e.flags)}else wo=!1,is&&0!==(1048576&t.flags)&&Zi(t,Wi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;qo(e,t),e=t.pendingProps;var i=Ai(t,ji.current);Is(t,n),i=ga(null,t,r,e,i,n);var a=va();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(r)?(a=!0,Li(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ls(t),i.updater=io,t.stateNode=i,i._reactInternals=t,lo(t,r,e,n),t=Io(null,t,r,!0,a,n)):(t.tag=0,is&&a&&es(t),xo(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(qo(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===j)return 11;if(e===A)return 14}return 2}(r),e=no(r,e),i){case 0:t=Co(null,t,r,e,n);break e;case 1:t=jo(null,t,r,e,n);break e;case 11:t=_o(null,t,r,e,n);break e;case 14:t=No(null,t,r,no(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Co(e,t,r,i=t.elementType===r?i:no(r,i),n);case 1:return r=t.type,i=t.pendingProps,jo(e,t,r,i=t.elementType===r?i:no(r,i),n);case 3:e:{if(To(t),null===e)throw Error(s(387));r=t.pendingProps,i=(a=t.memoizedState).element,Ms(e,t),zs(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ao(e,t,r,n,i=co(Error(s(423)),t));break e}if(r!==i){t=Ao(e,t,r,n,i=co(Error(s(424)),t));break e}for(rs=ci(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=xs(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=Ho(e,t,n);break e}xo(e,t,r,n)}t=t.child}return t;case 5:return Xs(t),null===e&&cs(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,ni(r,i)?o=null:null!==a&&ni(r,a)&&(t.flags|=32),So(e,t),xo(e,t,o,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Fo(e,t,n);case 4:return Qs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ws(t,null,r,n):xo(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,_o(e,t,r,i=t.elementType===r?i:no(r,i),n);case 7:return xo(e,t,t.pendingProps,n),t.child;case 8:case 12:return xo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Si(_s,r._currentValue),r._currentValue=o,null!==a)if(or(a.value,o)){if(a.children===i.children&&!Ii.current){t=Ho(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=Fs(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),js(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),js(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}xo(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Is(t,n),r=r(i=Ts(i)),t.flags|=1,xo(e,t,r,n),t.child;case 14:return i=no(r=t.type,t.pendingProps),No(e,t,r,i=no(r.type,i),n);case 15:return Eo(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:no(r,i),qo(e,t),t.tag=1,Ri(r)?(e=!0,Li(t)):e=!1,Is(t,n),ao(t,r,i),lo(t,r,i,n),Io(null,t,r,!0,e,n);case 19:return $o(e,t,n);case 22:return ko(e,t,n)}throw Error(s(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof i){var o=i;i=function(){var e=Hc(a);o.call(e)}}qc(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Hc(a);s.call(e)}}var a=$c(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=a,e[pi]=a.current,zr(8===e.nodeType?e.parentNode:e),dc(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var o=r;r=function(){var e=Hc(l);o.call(e)}}var l=Bc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[pi]=l.current,zr(8===e.nodeType?e.parentNode:e),dc(function(){qc(t,l,n,r)}),l}(n,t,e,i,r);return Hc(a)}Yc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));qc(e,t,null,null)},Yc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){qc(null,e,null,null)}),t[pi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Mt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),ic(t,Xe()),0===(6&Il)&&($l=Xe()+500,zi()))}break;case 13:dc(function(){var t=Ps(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}}),Kc(e,1)}},_t=function(e){if(13===e.tag){var t=Ps(e,134217728);if(null!==t)rc(t,e,134217728,tc());Kc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=nc(e),n=Ps(e,t);if(null!==n)rc(n,e,t,tc());Kc(e,t)}},Et=function(){return bt},kt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},_e=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=xi(r);if(!i)throw Error(s(90));K(r),J(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},je=uc,Ie=dc;var tu={usingClientEntryPoint:!1,Events:[bi,wi,xi,Se,Ce,uc]},nu={findFiberByHostInstance:yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{it=iu.inject(ru),st=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(s(299));var n=!1,r="",i=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,zr(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(s(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",o=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=$c(t,null,e,1,null!=n?n:null,i,0,a,o),e[pi]=t.current,zr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(s(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(s(40));return!!e._reactRootContainer&&(dc(function(){eu(null,null,e,!1,function(){e._reactRootContainer=null,e[pi]=null})}),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return eu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&r;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>a[e]=()=>r[e]);return a.default=()=>r,n.d(s,a),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r,i=n(43),s=n.t(i,2),a=n(391),o=n(950),l=n.t(o,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(r||(r={}));const u="popstate";function d(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function f(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,n,r){return void 0===n&&(n=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function m(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function g(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function v(e,t,n,i){void 0===i&&(i={});let{window:s=document.defaultView,v5Compat:a=!1}=i,o=s.history,l=r.Pop,h=null,g=v();function v(){return(o.state||{idx:null}).idx}function y(){l=r.Pop;let e=v(),t=null==e?null:e-g;g=e,h&&h({action:l,location:w.location,delta:t})}function b(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:m(e);return n=n.replace(/ $/,"%20"),d(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,o.replaceState(c({},o.state,{idx:g}),""));let w={get action(){return l},get location(){return e(s,o)},listen(e){if(h)throw new Error("A history only accepts one active listener");return s.addEventListener(u,y),h=e,()=>{s.removeEventListener(u,y),h=null}},createHref:e=>t(s,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=r.Push;let i=p(w.location,e,t);n&&n(i,e),g=v()+1;let c=f(i,g),u=w.createHref(i);try{o.pushState(c,"",u)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;s.location.assign(u)}a&&h&&h({action:l,location:w.location,delta:1})},replace:function(e,t){l=r.Replace;let i=p(w.location,e,t);n&&n(i,e),g=v();let s=f(i,g),c=w.createHref(i);o.replaceState(s,"",c),a&&h&&h({action:l,location:w.location,delta:0})},go:e=>o.go(e)};return w}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function b(e,t,n){return void 0===n&&(n="/"),w(e,t,n,!1)}function w(e,t,n,r){let i=P(("string"===typeof t?g(t):t).pathname||"/",n);if(null==i)return null;let s=x(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let a=null;for(let o=0;null==a&&o<s.length;++o){let e=D(i);a=A(s[o],e,r)}return a}function x(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,s)=>{let a={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};a.relativePath.startsWith("/")&&(d(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(r.length));let o=U([r,a.relativePath]),l=n.concat(a);e.children&&e.children.length>0&&(d(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),x(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:T(o,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of _(e.path))i(e,t,r);else i(e,t)}),t}function _(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return i?[s,""]:[s];let a=_(r.join("/")),o=[];return o.push(...a.map(e=>""===e?s:[s,e].join("/"))),i&&o.push(...a),o.map(t=>e.startsWith("/")&&""===t?"/":t)}const N=/^:[\w-]+$/,E=3,k=2,S=1,C=10,j=-2,I=e=>"*"===e;function T(e,t){let n=e.split("/"),r=n.length;return n.some(I)&&(r+=j),t&&(r+=k),n.filter(e=>!I(e)).reduce((e,t)=>e+(N.test(t)?E:""===t?S:C),r)}function A(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,i={},s="/",a=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===s?t:t.slice(s.length)||"/",u=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),a.push({params:i,pathname:U([s,u.pathname]),pathnameBase:V(U([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=U([s,u.pathnameBase]))}return a}function R(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=o[n]||"";a=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:a,pattern:e}}function D(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function P(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function O(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function L(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function M(e,t){let n=L(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function F(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=g(e):(i=c({},e),d(!i.pathname||!i.pathname.includes("?"),O("?","pathname","search",i)),d(!i.pathname||!i.pathname.includes("#"),O("#","pathname","hash",i)),d(!i.search||!i.search.includes("#"),O("#","search","hash",i)));let s,a=""===e||""===i.pathname,o=a?"/":i.pathname;if(null==o)s=n;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?g(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:B(r),hash:z(i)}}(i,s),u=o&&"/"!==o&&o.endsWith("/"),h=(a||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!u&&!h||(l.pathname+="/"),l}const U=e=>e.join("/").replace(/\/\/+/g,"/"),V=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),B=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",z=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function $(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const q=["post","put","patch","delete"],H=(new Set(q),["get",...q]);new Set(H),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},W.apply(this,arguments)}const K=i.createContext(null);const G=i.createContext(null);const Q=i.createContext(null);const Y=i.createContext(null);const X=i.createContext({outlet:null,matches:[],isDataRoute:!1});const J=i.createContext(null);function Z(){return null!=i.useContext(Y)}function ee(){return Z()||d(!1),i.useContext(Y).location}function te(e){i.useContext(Q).static||i.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=i.useContext(X);return e?function(){let{router:e}=fe(de.UseNavigateStable),t=me(he.UseNavigateStable),n=i.useRef(!1);return te(()=>{n.current=!0}),i.useCallback(function(r,i){void 0===i&&(i={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,W({fromRouteId:t},i)))},[e,t])}():function(){Z()||d(!1);let e=i.useContext(K),{basename:t,future:n,navigator:r}=i.useContext(Q),{matches:s}=i.useContext(X),{pathname:a}=ee(),o=JSON.stringify(M(s,n.v7_relativeSplatPath)),l=i.useRef(!1);return te(()=>{l.current=!0}),i.useCallback(function(n,i){if(void 0===i&&(i={}),!l.current)return;if("number"===typeof n)return void r.go(n);let s=F(n,JSON.parse(o),a,"path"===i.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:U([t,s.pathname])),(i.replace?r.replace:r.push)(s,i.state,i)},[t,r,o,a,e])}()}function re(){let{matches:e}=i.useContext(X),t=e[e.length-1];return t?t.params:{}}function ie(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=i.useContext(Q),{matches:s}=i.useContext(X),{pathname:a}=ee(),o=JSON.stringify(M(s,r.v7_relativeSplatPath));return i.useMemo(()=>F(e,JSON.parse(o),a,"path"===n),[e,o,a,n])}function se(e,t,n,s){Z()||d(!1);let{navigator:a}=i.useContext(Q),{matches:o}=i.useContext(X),l=o[o.length-1],c=l?l.params:{},u=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let h,f=ee();if(t){var p;let e="string"===typeof t?g(t):t;"/"===u||(null==(p=e.pathname)?void 0:p.startsWith(u))||d(!1),h=e}else h=f;let m=h.pathname||"/",v=m;if("/"!==u){let e=u.replace(/^\//,"").split("/");v="/"+m.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=b(e,{pathname:v});let w=ue(y&&y.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:U([u,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:U([u,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,n,s);return t&&w?i.createElement(Y.Provider,{value:{location:W({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:r.Pop}},w):w}function ae(){let e=function(){var e;let t=i.useContext(J),n=pe(he.UseRouteError),r=me(he.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=$(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r};return i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:s},n):null,null)}const oe=i.createElement(ae,null);class le extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?i.createElement(X.Provider,{value:this.props.routeContext},i.createElement(J.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ce(e){let{routeContext:t,match:n,children:r}=e,s=i.useContext(K);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(X.Provider,{value:t},r)}function ue(e,t,n,r){var s;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var a;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(a=r)&&a.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,l=null==(s=n)?void 0:s.errors;if(null!=l){let e=o.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||d(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let i=0;i<o.length;i++){let e=o[i];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=i),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){c=!0,o=u>=0?o.slice(0,u+1):[o[0]];break}}}return o.reduceRight((e,r,s)=>{let a,d=!1,h=null,f=null;n&&(a=l&&r.route.id?l[r.route.id]:void 0,h=r.route.errorElement||oe,c&&(u<0&&0===s?(!function(e,t){t||ge[e]||(ge[e]=!0)}("route-fallback",!1),d=!0,f=null):u===s&&(d=!0,f=r.route.hydrateFallbackElement||null)));let p=t.concat(o.slice(0,s+1)),m=()=>{let t;return t=a?h:d?f:r.route.Component?i.createElement(r.route.Component,null):r.route.element?r.route.element:e,i.createElement(ce,{match:r,routeContext:{outlet:e,matches:p,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===s)?i.createElement(le,{location:n.location,revalidation:n.revalidation,component:h,error:a,children:m(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):m()},null)}var de=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(de||{}),he=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(he||{});function fe(e){let t=i.useContext(K);return t||d(!1),t}function pe(e){let t=i.useContext(G);return t||d(!1),t}function me(e){let t=function(){let e=i.useContext(X);return e||d(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||d(!1),n.route.id}const ge={};function ve(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}s.startTransition;function ye(e){let{to:t,replace:n,state:r,relative:s}=e;Z()||d(!1);let{future:a,static:o}=i.useContext(Q),{matches:l}=i.useContext(X),{pathname:c}=ee(),u=ne(),h=F(t,M(l,a.v7_relativeSplatPath),c,"path"===s),f=JSON.stringify(h);return i.useEffect(()=>u(JSON.parse(f),{replace:n,state:r,relative:s}),[u,f,s,n,r]),null}function be(e){d(!1)}function we(e){let{basename:t="/",children:n=null,location:s,navigationType:a=r.Pop,navigator:o,static:l=!1,future:c}=e;Z()&&d(!1);let u=t.replace(/^\/*/,"/"),h=i.useMemo(()=>({basename:u,navigator:o,static:l,future:W({v7_relativeSplatPath:!1},c)}),[u,c,o,l]);"string"===typeof s&&(s=g(s));let{pathname:f="/",search:p="",hash:m="",state:v=null,key:y="default"}=s,b=i.useMemo(()=>{let e=P(f,u);return null==e?null:{location:{pathname:e,search:p,hash:m,state:v,key:y},navigationType:a}},[u,f,p,m,v,y,a]);return null==b?null:i.createElement(Q.Provider,{value:h},i.createElement(Y.Provider,{children:n,value:b}))}function xe(e){let{children:t,location:n}=e;return se(_e(t),n)}new Promise(()=>{});i.Component;function _e(e,t){void 0===t&&(t=[]);let n=[];return i.Children.forEach(e,(e,r)=>{if(!i.isValidElement(e))return;let s=[...t,r];if(e.type===i.Fragment)return void n.push.apply(n,_e(e.props.children,s));e.type!==be&&d(!1),e.props.index&&e.props.children&&d(!1);let a={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=_e(e.props.children,s)),n.push(a)}),n}function Ne(){return Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ne.apply(this,arguments)}function Ee(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const ke=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(Bw){}new Map;const Se=s.startTransition;l.flushSync,s.useId;function Ce(e){let{basename:t,children:n,future:r,window:s}=e,a=i.useRef();var o;null==a.current&&(a.current=(void 0===(o={window:s,v5Compat:!0})&&(o={}),v(function(e,t){let{pathname:n,search:r,hash:i}=e.location;return p("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:m(t)},null,o)));let l=a.current,[c,u]=i.useState({action:l.action,location:l.location}),{v7_startTransition:d}=r||{},h=i.useCallback(e=>{d&&Se?Se(()=>u(e)):u(e)},[u,d]);return i.useLayoutEffect(()=>l.listen(h),[l,h]),i.useEffect(()=>ve(r),[r]),i.createElement(we,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:r})}const je="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ie=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Te=i.forwardRef(function(e,t){let n,{onClick:r,relative:s,reloadDocument:a,replace:o,state:l,target:c,to:u,preventScrollReset:h,viewTransition:f}=e,p=Ee(e,ke),{basename:g}=i.useContext(Q),v=!1;if("string"===typeof u&&Ie.test(u)&&(n=u,je))try{let e=new URL(window.location.href),t=u.startsWith("//")?new URL(e.protocol+u):new URL(u),n=P(t.pathname,g);t.origin===e.origin&&null!=n?u=n+t.search+t.hash:v=!0}catch(Bw){}let y=function(e,t){let{relative:n}=void 0===t?{}:t;Z()||d(!1);let{basename:r,navigator:s}=i.useContext(Q),{hash:a,pathname:o,search:l}=ie(e,{relative:n}),c=o;return"/"!==r&&(c="/"===o?r:U([r,o])),s.createHref({pathname:c,search:l,hash:a})}(u,{relative:s}),b=function(e,t){let{target:n,replace:r,state:s,preventScrollReset:a,relative:o,viewTransition:l}=void 0===t?{}:t,c=ne(),u=ee(),d=ie(e,{relative:o});return i.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:m(u)===m(d);c(e,{replace:n,state:s,preventScrollReset:a,relative:o,viewTransition:l})}},[u,c,d,r,s,n,e,a,o,l])}(u,{replace:o,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:f});return i.createElement("a",Ne({},p,{href:n||y,onClick:v||a?r:function(e){r&&r(e),e.defaultPrevented||b(e)},ref:t,target:c}))});var Ae,Re;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ae||(Ae={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Re||(Re={}));const De=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Pe={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,a=s?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;o||(h=64,s||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(De(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const a=i<e.length?n[e.charAt(i)]:64;++i;const o=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==a||null==o)throw new Oe;const l=t<<2|s>>4;if(r.push(l),64!==a){const e=s<<4&240|a>>2;if(r.push(e),64!==o){const e=a<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Oe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Le=function(e){return function(e){const t=De(e);return Pe.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Me=function(e){try{return Pe.decodeString(e,!0)}catch(Bw){console.error("base64Decode failed: ",Bw)}return null};const Fe=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,Ue=()=>{try{return Fe()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyBSpwzSf8hXxb4rBk-u8JPyX7Ha4kGoS8o",REACT_APP_FIREBASE_AUTH_DOMAIN:"mountainmedicine-6e572.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"mountainmedicine-6e572",REACT_APP_FIREBASE_STORAGE_BUCKET:"mountainmedicine-6e572.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1081705872512",REACT_APP_FIREBASE_APP_ID:"1:1081705872512:web:0ddf126c4737e47fd9ba65",REACT_APP_USE_EMULATORS:"false"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(Bw){return}const t=e&&Me(e[1]);return t&&JSON.parse(t)})()}catch(Bw){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${Bw}`)}},Ve=e=>{var t,n;return null===(n=null===(t=Ue())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},Be=e=>{const t=Ve(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},ze=()=>{var e;return null===(e=Ue())||void 0===e?void 0:e.config},$e=e=>{var t;return null===(t=Ue())||void 0===t?void 0:t[`_${e}`]};class qe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function He(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Le(JSON.stringify({alg:"none",type:"JWT"})),Le(JSON.stringify(s)),""].join(".")}function We(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Ke(){return!function(){var e;const t=null===(e=Ue())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(Bw){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ge(){try{return"object"===typeof indexedDB}catch(Bw){return!1}}class Qe extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Qe.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ye.prototype.create)}}class Ye{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(Xe,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(r,t):"Error",s=`${this.serviceName}: ${i} (${n}).`;return new Qe(n,s,t)}}const Xe=/\{\$([^}]+)}/g;function Je(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(Ze(n)&&Ze(s)){if(!Je(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Ze(e){return null!==e&&"object"===typeof e}function et(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function tt(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function nt(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class rt{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=it),void 0===r.error&&(r.error=it),void 0===r.complete&&(r.complete=it);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(Bw){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(Bw){"undefined"!==typeof console&&console.error&&console.error(Bw)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function it(){}function st(e){return e&&e._delegate?e._delegate:e}class at{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ot="[DEFAULT]";class lt{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new qe;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(Bw){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(Bw){if(r)return null;throw Bw}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ot})}catch(Bw){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(Bw){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===ot?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot;return this.component?this.component.multipleInstances?e:ot:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ct{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new lt(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ut=[];var dt;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(dt||(dt={}));const ht={debug:dt.DEBUG,verbose:dt.VERBOSE,info:dt.INFO,warn:dt.WARN,error:dt.ERROR,silent:dt.SILENT},ft=dt.INFO,pt={[dt.DEBUG]:"log",[dt.VERBOSE]:"log",[dt.INFO]:"info",[dt.WARN]:"warn",[dt.ERROR]:"error"},mt=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=pt[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,s=new Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];console[r](`[${n}]  ${e.name}:`,...s)};class gt{constructor(e){this.name=e,this._logLevel=ft,this._logHandler=mt,this._userLogHandler=null,ut.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?ht[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,dt.DEBUG,...t),this._logHandler(this,dt.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,dt.VERBOSE,...t),this._logHandler(this,dt.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,dt.INFO,...t),this._logHandler(this,dt.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,dt.WARN,...t),this._logHandler(this,dt.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,dt.ERROR,...t),this._logHandler(this,dt.ERROR,...t)}}let vt,yt;const bt=new WeakMap,wt=new WeakMap,xt=new WeakMap,_t=new WeakMap,Nt=new WeakMap;let Et={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return wt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||xt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ct(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function kt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(yt||(yt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(jt(this),n),Ct(bt.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ct(e.apply(jt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(jt(this),t,...r);return xt.set(s,t.sort?t.sort():[t]),Ct(s)}}function St(e){return"function"===typeof e?kt(e):(e instanceof IDBTransaction&&function(e){if(wt.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});wt.set(e,t)}(e),t=e,(vt||(vt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,Et):e);var t}function Ct(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(Ct(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&bt.set(t,e)}).catch(()=>{}),Nt.set(t,e),t}(e);if(_t.has(e))return _t.get(e);const t=St(e);return t!==e&&(_t.set(e,t),Nt.set(t,e)),t}const jt=e=>Nt.get(e);const It=["get","getKey","getAll","getAllKeys","count"],Tt=["put","add","delete","clear"],At=new Map;function Rt(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(At.get(t))return At.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Tt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!It.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return r&&(s=s.index(o.shift())),(await Promise.all([s[n](...o),i&&t.done]))[0]};return At.set(t,s),s}Et=(e=>({...e,get:(t,n,r)=>Rt(t,n)||e.get(t,n,r),has:(t,n)=>!!Rt(t,n)||e.has(t,n)}))(Et);class Dt{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const Pt="@firebase/app",Ot="0.10.13",Lt=new gt("@firebase/app"),Mt="@firebase/app-compat",Ft="@firebase/analytics-compat",Ut="@firebase/analytics",Vt="@firebase/app-check-compat",Bt="@firebase/app-check",zt="@firebase/auth",$t="@firebase/auth-compat",qt="@firebase/database",Ht="@firebase/data-connect",Wt="@firebase/database-compat",Kt="@firebase/functions",Gt="@firebase/functions-compat",Qt="@firebase/installations",Yt="@firebase/installations-compat",Xt="@firebase/messaging",Jt="@firebase/messaging-compat",Zt="@firebase/performance",en="@firebase/performance-compat",tn="@firebase/remote-config",nn="@firebase/remote-config-compat",rn="@firebase/storage",sn="@firebase/storage-compat",an="@firebase/firestore",on="@firebase/vertexai-preview",ln="@firebase/firestore-compat",cn="firebase",un="[DEFAULT]",dn={[Pt]:"fire-core",[Mt]:"fire-core-compat",[Ut]:"fire-analytics",[Ft]:"fire-analytics-compat",[Bt]:"fire-app-check",[Vt]:"fire-app-check-compat",[zt]:"fire-auth",[$t]:"fire-auth-compat",[qt]:"fire-rtdb",[Ht]:"fire-data-connect",[Wt]:"fire-rtdb-compat",[Kt]:"fire-fn",[Gt]:"fire-fn-compat",[Qt]:"fire-iid",[Yt]:"fire-iid-compat",[Xt]:"fire-fcm",[Jt]:"fire-fcm-compat",[Zt]:"fire-perf",[en]:"fire-perf-compat",[tn]:"fire-rc",[nn]:"fire-rc-compat",[rn]:"fire-gcs",[sn]:"fire-gcs-compat",[an]:"fire-fst",[ln]:"fire-fst-compat",[on]:"fire-vertex","fire-js":"fire-js",[cn]:"fire-js-all"},hn=new Map,fn=new Map,pn=new Map;function mn(e,t){try{e.container.addComponent(t)}catch(Bw){Lt.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,Bw)}}function gn(e){const t=e.name;if(pn.has(t))return Lt.debug(`There were multiple attempts to register component ${t}.`),!1;pn.set(t,e);for(const n of hn.values())mn(n,e);for(const n of fn.values())mn(n,e);return!0}function vn(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function yn(e){return void 0!==e.settings}const bn=new Ye("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class wn{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new at("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bn.create("app-deleted",{appName:this._name})}}const xn="10.14.1";function _n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:un,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw bn.create("bad-app-name",{appName:String(i)});if(n||(n=ze()),!n)throw bn.create("no-options");const s=hn.get(i);if(s){if(Je(n,s.options)&&Je(r,s.config))return s;throw bn.create("duplicate-app",{appName:i})}const a=new ct(i);for(const l of pn.values())a.addComponent(l);const o=new wn(n,r,a);return hn.set(i,o),o}function Nn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:un;const t=hn.get(e);if(!t&&e===un&&ze())return _n();if(!t)throw bn.create("no-app",{appName:e});return t}function En(e,t,n){var r;let i=null!==(r=dn[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Lt.warn(e.join(" "))}gn(new at(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const kn="firebase-heartbeat-store";let Sn=null;function Cn(){return Sn||(Sn=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),o=Ct(a);return r&&a.addEventListener("upgradeneeded",e=>{r(Ct(a.result),e.oldVersion,e.newVersion,Ct(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(kn)}catch(Bw){console.warn(Bw)}}}).catch(e=>{throw bn.create("idb-open",{originalErrorMessage:e.message})})),Sn}async function jn(e,t){try{const n=(await Cn()).transaction(kn,"readwrite"),r=n.objectStore(kn);await r.put(t,In(e)),await n.done}catch(Bw){if(Bw instanceof Qe)Lt.warn(Bw.message);else{const t=bn.create("idb-set",{originalErrorMessage:null===Bw||void 0===Bw?void 0:Bw.message});Lt.warn(t.message)}}}function In(e){return`${e.name}!${e.options.appId}`}class Tn{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Rn(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=An();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}catch(Bw){Lt.warn(Bw)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=An(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),Dn(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Dn(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Le(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(Bw){return Lt.warn(Bw),""}}}function An(){return(new Date).toISOString().substring(0,10)}class Rn{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Ge()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Cn()).transaction(kn),n=await t.objectStore(kn).get(In(e));return await t.done,n}catch(Bw){if(Bw instanceof Qe)Lt.warn(Bw.message);else{const t=bn.create("idb-get",{originalErrorMessage:null===Bw||void 0===Bw?void 0:Bw.message});Lt.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return jn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return jn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Dn(e){return Le(JSON.stringify({version:2,heartbeats:e})).length}var Pn;Pn="",gn(new at("platform-logger",e=>new Dt(e),"PRIVATE")),gn(new at("heartbeat",e=>new Tn(e),"PRIVATE")),En(Pt,Ot,Pn),En(Pt,Ot,"esm2017"),En("fire-js","");En("firebase","10.14.1","app");function On(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Ln(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Mn=Ln,Fn=new Ye("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Un=new gt("@firebase/auth");function Vn(e){if(Un.logLevel<=dt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Un.error(`Auth (${xn}): ${e}`,...n)}}function Bn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Wn(e,...n)}function zn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Wn(e,...n)}function $n(e,t,n){const r=Object.assign(Object.assign({},Mn()),{[t]:n});return new Ye("auth","Firebase",r).create(t,{appName:e.name})}function qn(e){return $n(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hn(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Bn(e,"argument-error"),$n(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Wn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Fn.create(e,...n)}function Kn(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw Wn(t,...r)}}function Gn(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Vn(t),new Error(t)}function Qn(e,t){e||Gn(t)}function Yn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Xn(){return"http:"===Jn()||"https:"===Jn()}function Jn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Zn(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Xn()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class er{constructor(e,t){this.shortDelay=e,this.longDelay=t,Qn(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(We())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return Zn()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function tr(e,t){Qn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class nr{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Gn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Gn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Gn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const rr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},ir=new er(3e4,6e4);function sr(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function ar(e,t,n,r){return or(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const a=et(Object.assign({key:e.config.apiKey},s)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:o},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),nr.fetch()(cr(e,e.config.apiHost,n,a),l)})}async function or(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},rr),t);try{const t=new dr(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw hr(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw hr(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw hr(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw hr(e,"user-disabled",s);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw $n(e,o,a);Bn(e,o)}}catch(Bw){if(Bw instanceof Qe)throw Bw;Bn(e,"network-request-failed",{message:String(Bw)})}}async function lr(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await ar(e,t,n,r,i);return"mfaPendingCredential"in s&&Bn(e,"multi-factor-auth-required",{_serverResponse:s}),s}function cr(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?tr(e.config,i):`${e.config.apiScheme}://${i}`}function ur(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class dr{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(zn(this.auth,"network-request-failed")),ir.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function hr(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=zn(e,t,r);return i.customData._tokenResponse=n,i}function fr(e){return void 0!==e&&void 0!==e.enterprise}class pr{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return ur(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function mr(e,t){return ar(e,"GET","/v2/recaptchaConfig",sr(e,t))}async function gr(e,t){return ar(e,"POST","/v1/accounts:lookup",t)}function vr(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(Bw){}}function yr(e){return 1e3*Number(e)}function br(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Vn("JWT malformed, contained fewer than 3 sections"),null;try{const e=Me(n);return e?JSON.parse(e):(Vn("Failed to decode base64 JWT payload"),null)}catch(Bw){return Vn("Caught error parsing JWT payload as JSON",null===Bw||void 0===Bw?void 0:Bw.toString()),null}}function wr(e){const t=br(e);return Kn(t,"internal-error"),Kn("undefined"!==typeof t.exp,"internal-error"),Kn("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function xr(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(Bw){throw Bw instanceof Qe&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(Bw)&&e.auth.currentUser===e&&await e.auth.signOut(),Bw}}class _r{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(Bw){return void("auth/network-request-failed"===(null===Bw||void 0===Bw?void 0:Bw.code)&&this.schedule(!0))}this.schedule()}}class Nr{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=vr(this.lastLoginAt),this.creationTime=vr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Er(e){var t;const n=e.auth,r=await e.getIdToken(),i=await xr(e,gr(n,{idToken:r}));Kn(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?kr(s.providerUserInfo):[],o=(l=e.providerData,c=a,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&s.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!u&&d,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Nr(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function kr(e){return e.map(e=>{var{providerId:t}=e,n=On(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class Sr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Kn(e.idToken,"internal-error"),Kn("undefined"!==typeof e.idToken,"internal-error"),Kn("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):wr(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Kn(0!==e.length,"internal-error");const t=wr(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Kn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await or(e,{},async()=>{const n=et({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=cr(e,r,"/v1/token",`key=${i}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",nr.fetch()(s,{method:"POST",headers:a,body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Sr;return n&&(Kn("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Kn("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Kn("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Sr,this.toJSON())}_performRefresh(){return Gn("not implemented")}}function Cr(e,t){Kn("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class jr{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=On(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new _r(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Nr(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await xr(this,this.stsTokenManager.getToken(this.auth,e));return Kn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=st(e),r=await n.getIdToken(t),i=br(r);Kn(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,a=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:vr(yr(i.auth_time)),issuedAtTime:vr(yr(i.iat)),expirationTime:vr(yr(i.exp)),signInProvider:a||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=st(e);await Er(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Kn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new jr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Kn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Er(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(yn(this.auth.app))return Promise.reject(qn(this.auth));const e=await this.getIdToken();return await xr(this,async function(e,t){return ar(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,a,o,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(a=t.tenantId)&&void 0!==a?a:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:b,isAnonymous:w,providerData:x,stsTokenManager:_}=t;Kn(y&&_,e,"internal-error");const N=Sr.fromJSON(this.name,_);Kn("string"===typeof y,e,"internal-error"),Cr(u,e.name),Cr(d,e.name),Kn("boolean"===typeof b,e,"internal-error"),Kn("boolean"===typeof w,e,"internal-error"),Cr(h,e.name),Cr(f,e.name),Cr(p,e.name),Cr(m,e.name),Cr(g,e.name),Cr(v,e.name);const E=new jr({uid:y,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:N,createdAt:g,lastLoginAt:v});return x&&Array.isArray(x)&&(E.providerData=x.map(e=>Object.assign({},e))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Sr;r.updateFromServerResponse(t);const i=new jr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Er(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Kn(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?kr(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),a=new Sr;a.updateFromIdToken(n);const o=new jr({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Nr(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(o,l),o}}const Ir=new Map;function Tr(e){Qn(e instanceof Function,"Expected a class definition");let t=Ir.get(e);return t?(Qn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Ir.set(e,t),t)}class Ar{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ar.type="NONE";const Rr=Ar;function Dr(e,t,n){return`firebase:${e}:${t}:${n}`}class Pr{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Dr(this.userKey,r.apiKey,i),this.fullPersistenceKey=Dr("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?jr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Pr(Tr(Rr),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||Tr(Rr);const s=Dr(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const t=await c._get(s);if(t){const n=jr._fromJSON(e,t);c!==i&&(a=n),i=c;break}}catch(l){}const o=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&o.length?(i=o[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(l){}})),new Pr(i,e,n)):new Pr(i,e,n)}}function Or(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ur(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Lr(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Br(t))return"Blackberry";if(zr(t))return"Webos";if(Mr(t))return"Safari";if((t.includes("chrome/")||Fr(t))&&!t.includes("edge/"))return"Chrome";if(Vr(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Lr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We();return/firefox\//i.test(e)}function Mr(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:We()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Fr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We();return/crios\//i.test(e)}function Ur(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We();return/iemobile/i.test(e)}function Vr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We();return/android/i.test(e)}function Br(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We();return/blackberry/i.test(e)}function zr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We();return/webos/i.test(e)}function $r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function qr(){return function(){const e=We();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Hr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We();return $r(e)||Vr(e)||zr(e)||Br(e)||/windows phone/i.test(e)||Ur(e)}function Wr(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Or(We());break;case"Worker":t=`${Or(We())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${xn}/${r}`}class Kr{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(Bw){r(Bw)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(Bw){t.reverse();for(const r of t)try{r()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===Bw||void 0===Bw?void 0:Bw.message})}}}class Gr{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(i=o.containsUppercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsNumericCharacter)||void 0===s||s),o.isValid&&(o.isValid=null===(a=o.containsNonAlphanumericCharacter)||void 0===a||a),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Qr{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Xr(this),this.idTokenSubscription=new Xr(this),this.beforeStateQueue=new Kr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Fn,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Tr(t)),this._initializationPromise=this.queue(async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Pr.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(Bw){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await gr(this,{idToken:e}),n=await jr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(yn(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,a=await this.tryRedirectSignIn(e);n&&n!==s||!(null===a||void 0===a?void 0:a.user)||(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(Bw){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(Bw))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Kn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(Bw){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Er(e)}catch(Bw){if("auth/network-request-failed"!==(null===Bw||void 0===Bw?void 0:Bw.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(yn(this.app))return Promise.reject(qn(this));const t=e?st(e):null;return t&&Kn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Kn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return yn(this.app)?Promise.reject(qn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return yn(this.app)?Promise.reject(qn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Tr(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return ar(e,"GET","/v2/passwordPolicy",sr(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Gr(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ye("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return ar(e,"POST","/v2/accounts:revokeToken",sr(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Tr(e)||this._popupRedirectResolver;Kn(t,this,"argument-error"),this.redirectPersistenceManager=await Pr.create(this,[Tr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Kn(a,this,"internal-error"),a.then(()=>{s||i(this.currentUser)}),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Kn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Wr(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Un.logLevel<=dt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Un.warn(`Auth (${xn}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function Yr(e){return st(e)}class Xr{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new rt(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return Kn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Jr={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Zr(e){return Jr.loadJS(e)}function ei(e){return`__${e}${Math.floor(1e6*Math.random())}`}class ti{constructor(e){this.type="recaptcha-enterprise",this.auth=Yr(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;fr(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{mr(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new pr(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&fr(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Jr.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Zr(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function ni(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new ti(e);let s;try{s=await i.verify(n)}catch(o){s=await i.verify(n,!0)}const a=Object.assign({},t);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function ri(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await ni(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await ni(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}function ii(e,t,n){const r=Yr(e);Kn(r._canInitEmulator,r,"emulator-config-failed"),Kn(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=si(t),{host:a,port:o}=function(e){const t=si(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:ai(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:ai(t)}}}(t),l=null===o?"":`:${o}`;r.config.emulator={url:`${s}//${a}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function si(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ai(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class oi{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Gn("not implemented")}_getIdTokenResponse(e){return Gn("not implemented")}_linkToIdToken(e,t){return Gn("not implemented")}_getReauthenticationResolver(e){return Gn("not implemented")}}async function li(e,t){return ar(e,"POST","/v1/accounts:signUp",t)}async function ci(e,t){return lr(e,"POST","/v1/accounts:signInWithPassword",sr(e,t))}class ui extends oi{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new ui(e,t,"password")}static _fromEmailAndCode(e,t){return new ui(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return ri(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ci);case"emailLink":return async function(e,t){return lr(e,"POST","/v1/accounts:signInWithEmailLink",sr(e,t))}(e,{email:this._email,oobCode:this._password});default:Bn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return ri(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",li);case"emailLink":return async function(e,t){return lr(e,"POST","/v1/accounts:signInWithEmailLink",sr(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Bn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function di(e,t){return lr(e,"POST","/v1/accounts:signInWithIdp",sr(e,t))}class hi extends oi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new hi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Bn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=On(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new hi(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return di(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,di(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,di(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=et(t)}return e}}const fi={USER_NOT_FOUND:"user-not-found"};class pi extends oi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new pi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new pi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return lr(e,"POST","/v1/accounts:signInWithPhoneNumber",sr(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await lr(e,"POST","/v1/accounts:signInWithPhoneNumber",sr(e,t));if(n.temporaryProof)throw hr(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return lr(e,"POST","/v1/accounts:signInWithPhoneNumber",sr(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),fi)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new pi({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class mi{constructor(e){var t,n,r,i,s,a;const o=tt(nt(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);Kn(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=o.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=o.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(a=o.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=tt(nt(e)).link,n=t?tt(nt(t)).deep_link_id:null,r=tt(nt(e)).deep_link_id;return(r?tt(nt(r)).link:null)||r||n||t||e}(e);try{return new mi(t)}catch(n){return null}}}class gi{constructor(){this.providerId=gi.PROVIDER_ID}static credential(e,t){return ui._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=mi.parseLink(t);return Kn(n,"argument-error"),ui._fromEmailAndCode(e,n.code,n.tenantId)}}gi.PROVIDER_ID="password",gi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",gi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class vi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class yi extends vi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class bi extends yi{constructor(){super("facebook.com")}static credential(e){return hi._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return bi.credential(t.oauthAccessToken)}catch(n){return null}}}bi.FACEBOOK_SIGN_IN_METHOD="facebook.com",bi.PROVIDER_ID="facebook.com";class wi extends yi{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return hi._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return wi.credential(n,r)}catch(i){return null}}}wi.GOOGLE_SIGN_IN_METHOD="google.com",wi.PROVIDER_ID="google.com";class xi extends yi{constructor(){super("github.com")}static credential(e){return hi._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return xi.credential(t.oauthAccessToken)}catch(n){return null}}}xi.GITHUB_SIGN_IN_METHOD="github.com",xi.PROVIDER_ID="github.com";class _i extends yi{constructor(){super("twitter.com")}static credential(e,t){return hi._fromParams({providerId:_i.PROVIDER_ID,signInMethod:_i.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return _i.credentialFromTaggedObject(e)}static credentialFromError(e){return _i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return _i.credential(n,r)}catch(i){return null}}}async function Ni(e,t){return lr(e,"POST","/v1/accounts:signUp",sr(e,t))}_i.TWITTER_SIGN_IN_METHOD="twitter.com",_i.PROVIDER_ID="twitter.com";class Ei{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await jr._fromIdTokenResponse(e,n,r),s=ki(n);return new Ei({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=ki(n);return new Ei({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function ki(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Si extends Qe{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Si.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Si(e,t,n,r)}}function Ci(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw Si._fromErrorAndOperation(e,n,t,r);throw n})}async function ji(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await xr(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Ei._forOperation(e,"link",r)}async function Ii(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(yn(r.app))return Promise.reject(qn(r));const i="reauthenticate";try{const s=await xr(e,Ci(r,i,t,e),n);Kn(s.idToken,r,"internal-error");const a=br(s.idToken);Kn(a,r,"internal-error");const{sub:o}=a;return Kn(e.uid===o,r,"user-mismatch"),Ei._forOperation(e,i,s)}catch(Bw){throw"auth/user-not-found"===(null===Bw||void 0===Bw?void 0:Bw.code)&&Bn(r,"user-mismatch"),Bw}}async function Ti(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(yn(e.app))return Promise.reject(qn(e));const r="signIn",i=await Ci(e,r,t),s=await Ei._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function Ai(e,t){return Ti(Yr(e),t)}async function Ri(e){const t=Yr(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function Di(e,t,n){return yn(e.app)?Promise.reject(qn(e)):Ai(st(e),gi.credential(t,n)).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Ri(e),t})}new WeakMap;const Pi="__sak";class Oi{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Pi,"1"),this.storage.removeItem(Pi),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Li extends Oi{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Hr(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);qr()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Li.type="LOCAL";const Mi=Li;class Fi extends Oi{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Fi.type="SESSION";const Ui=Fi;class Vi{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Vi(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(s).map(async e=>e(t.origin,i)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Bi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Vi.receivers=[];class zi{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((a,o)=>{const l=Bi("",20);r.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(t.data.response);break;default:clearTimeout(c),clearTimeout(i),o(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function $i(){return window}function qi(){return"undefined"!==typeof $i().WorkerGlobalScope&&"function"===typeof $i().importScripts}const Hi="firebaseLocalStorageDb",Wi="firebaseLocalStorage",Ki="fbase_key";class Gi{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Qi(e,t){return e.transaction([Wi],t?"readwrite":"readonly").objectStore(Wi)}function Yi(){const e=indexedDB.open(Hi,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Wi,{keyPath:Ki})}catch(Bw){n(Bw)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Wi)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Hi);return new Gi(e).toPromise()}(),t(await Yi()))})})}async function Xi(e,t,n){const r=Qi(e,!0).put({[Ki]:t,value:n});return new Gi(r).toPromise()}function Ji(e,t){const n=Qi(e,!0).delete(t);return new Gi(n).toPromise()}class Zi{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Yi()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(Bw){if(t++>3)throw Bw;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return qi()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Vi._getInstance(qi()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new zi(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Yi();return await Xi(e,Pi,"1"),await Ji(e,Pi),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Xi(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Qi(e,!1).get(t),r=await new Gi(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Ji(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Qi(e,!1).getAll();return new Gi(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Zi.type="LOCAL";const es=Zi;ei("rcb"),new er(3e4,6e4);const ts="recaptcha";async function ns(e,t,n){var r;const i=await n.verify();try{let s;if(Kn("string"===typeof i,e,"argument-error"),Kn(n.type===ts,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Kn("enroll"===t.type,e,"internal-error");const n=await function(e,t){return ar(e,"POST","/v2/accounts/mfaEnrollment:start",sr(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{Kn("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Kn(n,e,"missing-multi-factor-info");const a=await function(e,t){return ar(e,"POST","/v2/accounts/mfaSignIn:start",sr(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return a.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return ar(e,"POST","/v1/accounts:sendVerificationCode",sr(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class rs{constructor(e){this.providerId=rs.PROVIDER_ID,this.auth=Yr(e)}verifyPhoneNumber(e,t){return ns(this.auth,e,st(t))}static credential(e,t){return pi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return rs.credentialFromTaggedObject(t)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?pi._fromTokenResponse(n,r):null}}function is(e,t){return t?Tr(t):(Kn(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}rs.PROVIDER_ID="phone",rs.PHONE_SIGN_IN_METHOD="phone";class ss extends oi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return di(e,this._buildIdpRequest())}_linkToIdToken(e,t){return di(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return di(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function as(e){return Ti(e.auth,new ss(e),e.bypassAuthState)}function os(e){const{auth:t,user:n}=e;return Kn(n,t,"internal-error"),Ii(n,new ss(e),e.bypassAuthState)}async function ls(e){const{auth:t,user:n}=e;return Kn(n,t,"internal-error"),ji(n,new ss(e),e.bypassAuthState)}class cs{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(Bw){this.reject(Bw)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:a}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(Bw){this.reject(Bw)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return as;case"linkViaPopup":case"linkViaRedirect":return ls;case"reauthViaPopup":case"reauthViaRedirect":return os;default:Bn(this.auth,"internal-error")}}resolve(e){Qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const us=new er(2e3,1e4);class ds extends cs{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,ds.currentPopupAction&&ds.currentPopupAction.cancel(),ds.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Kn(e,this.auth,"internal-error"),e}async onExecution(){Qn(1===this.filter.length,"Popup operations only handle one event");const e=Bi();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(zn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(zn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ds.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zn(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,us.get())};e()}}ds.currentPopupAction=null;const hs=new Map;class fs extends cs{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=hs.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=gs(t),r=ms(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(Bw){e=()=>Promise.reject(Bw)}hs.set(this.auth._key(),e)}return this.bypassAuthState||hs.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ps(e,t){hs.set(e._key(),t)}function ms(e){return Tr(e._redirectPersistence)}function gs(e){return Dr("pendingRedirect",e.config.apiKey,e.name)}async function vs(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(yn(e.app))return Promise.reject(qn(e));const r=Yr(e),i=is(r,t),s=new fs(r,i,n),a=await s.execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}class ys{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ws(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!ws(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(zn(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(bs(e))}saveEventToCache(e){this.cachedEventUids.add(bs(e)),this.lastProcessedEventTime=Date.now()}}function bs(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function ws(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const xs=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_s=/^https?/;async function Ns(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return ar(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(Es(r))return}catch(n){}Bn(e,"unauthorized-domain")}function Es(e){const t=Yn(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!_s.test(n))return!1;if(xs.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const ks=new er(3e4,6e4);function Ss(){const e=$i().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Cs(e){return new Promise((t,n)=>{var r,i,s;function a(){Ss(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Ss(),n(zn(e,"network-request-failed"))},timeout:ks.get()})}if(null===(i=null===(r=$i().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=$i().gapi)||void 0===s?void 0:s.load)){const t=ei("iframefcb");return $i()[t]=()=>{gapi.load?a():n(zn(e,"network-request-failed"))},Zr(`${Jr.gapiScript}?onload=${t}`).catch(e=>n(e))}a()}}).catch(e=>{throw js=null,e})}let js=null;const Is=new er(5e3,15e3),Ts={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},As=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Rs(e){const t=e.config;Kn(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?tr(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:xn},i=As.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${et(r).slice(1)}`}async function Ds(e){const t=await function(e){return js=js||Cs(e),js}(e),n=$i().gapi;return Kn(n,e,"internal-error"),t.open({where:document.body,url:Rs(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ts,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=zn(e,"network-request-failed"),s=$i().setTimeout(()=>{r(i)},Is.get());function a(){$i().clearTimeout(s),n(t)}t.ping(a).then(a,()=>{r(i)})}))}const Ps={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Os{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(Bw){}}}function Ls(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=Object.assign(Object.assign({},Ps),{width:r.toString(),height:i.toString(),top:s,left:a}),c=We().toLowerCase();n&&(o=Fr(c)?"_blank":n),Lr(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`},"");if(function(){var e;return $r(arguments.length>0&&void 0!==arguments[0]?arguments[0]:We())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new Os(null);const d=window.open(t||"",o,u);Kn(d,e,"popup-blocked");try{d.focus()}catch(Bw){}return new Os(d)}const Ms="__/auth/handler",Fs="emulator/auth/handler",Us=encodeURIComponent("fac");async function Vs(e,t,n,r,i,s){Kn(e.config.authDomain,e,"auth-domain-config-required"),Kn(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:xn,eventId:i};if(t instanceof vi){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))a[e]=t}if(t instanceof yi){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(a.scopes=e.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${Us}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Ms}`;return tr(t,Fs)}(e)}?${et(o).slice(1)}${c}`}const Bs="webStorageSupport";const zs=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ui,this._completeRedirectFn=vs,this._overrideRedirectResult=ps}async _openPopup(e,t,n,r){var i;Qn(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Ls(e,await Vs(e,t,n,Yn(),r),Bi())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){$i().location.href=e}(await Vs(e,t,n,Yn(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Qn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Ds(e),n=new ys(e);return t.register("authEvent",t=>{Kn(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Bs,{type:Bs},n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Bs];void 0!==i&&t(!!i),Bn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Ns(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Hr()||Mr()||$r()}};var $s="@firebase/auth",qs="1.7.9";class Hs{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Kn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Ws=$e("authIdTokenMaxAge")||300;let Ks=null;var Gs;Jr={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=zn("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Gs="Browser",gn(new at("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Kn(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:Gs,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Wr(Gs)},c=new Qr(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Tr);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),gn(new at("auth-internal",e=>(e=>new Hs(e))(Yr(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),En($s,qs,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Gs)),En($s,qs,"esm2017");var Qs,Ys,Xs="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Js={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^n&(i^s))+r[0]+3614090360&4294967295;a=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(a<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(t=n+((a=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=s+((a=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,a=0;a<t;){if(0==s)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(i[s++]=e.charCodeAt(a++),s==this.blockSize){n(this,i),s=0;break}}else for(;a<t;)if(i[s++]=e[a++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function s(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return h(a(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var o=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function f(e,t){return e.add(h(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(o,o);if(d(e))return t=g(h(e),t),new m(h(t.g),h(t.h));if(d(t))return t=g(e,h(t)),new m(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=v(n),r=v(r);var i=y(n,1),s=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var c=s.add(r);0>=c.l(e)&&(i=i.add(n),s=c),r=y(r,1),n=y(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(s=a(n)).j(t);d(c)||0<c.l(e);)c=(s=a(n-=r)).j(t);u(s)&&(s=l),i=i.add(s),e=f(e,c)}return new m(i,e)}function v(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,s=[],a=0;a<i;a++)s[a]=0<t?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=a(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,s=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,s=0;s<=t;s++){var a=i+(65535&this.i(s))+(65535&e.i(s)),o=(a>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=o>>>16,a&=65535,o&=65535,n[s]=o<<16|a}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return a(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var l=this.i(i)>>>16,f=65535&this.i(i),m=e.i(s)>>>16,g=65535&e.i(s);n[2*i+2*s]+=f*g,p(n,2*i+2*s),n[2*i+2*s+1]+=l*g,p(n,2*i+2*s+1),n[2*i+2*s+1]+=f*m,p(n,2*i+2*s+1),n[2*i+2*s+2]+=l*m,p(n,2*i+2*s+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Ys=Js.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=a,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=a(Math.pow(n,8)),i=o,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),n);8>l?(l=a(Math.pow(n,l)),i=i.j(l).add(a(c))):i=(i=i.j(r)).add(a(c))}return i},Qs=Js.Integer=r}).apply("undefined"!==typeof Xs?Xs:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Zs,ea,ta,na,ra,ia,sa,aa,oa="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},la={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof oa&&oa];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in i))break e;i=i[a]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,function(e,t){return t})}});var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function _(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function N(e){i.setTimeout(()=>{throw e},0)}function E(){var e=I;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var k=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new S,e=>e.reset());class S{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let C,j=!1,I=new class{constructor(){this.h=this.g=null}add(e,t){const n=k.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},T=()=>{const e=i.Promise.resolve(void 0);C=()=>{e.then(A)}};var A=()=>{for(var e;e=E();){try{e.h.call(e.g)}catch(n){N(n)}var t=k;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}j=!1};function R(){this.s=this.s,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.s=!1,R.prototype.ma=function(){this.s||(this.s=!0,this.N())},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function O(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:L[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&O.aa.h.call(this)}}d(O,D);var L={2:"touch",3:"pen",4:"mouse"};O.prototype.h=function(){O.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),F=0;function U(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++F,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function B(e){this.src=e,this.g={},this.h=0}function z(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(V(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function $(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}B.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var a=$(e,t,r,i);return-1<a?(t=e[a],n||(t.fa=!1)):((t=new U(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var q="closure_lm_"+(1e6*Math.random()|0),H={};function W(e,t,n,r,i){if(r&&r.once)return G(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)W(e,t[s],n,r,i);return null}return n=te(n),e&&e[M]?e.K(t,n,a(r)?!!r.capture:!!r,i):K(e,t,n,!1,r,i)}function K(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=a(i)?!!i.capture:!!i,l=Z(e);if(l||(e[q]=l=new B(e)),(n=l.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=J;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)P||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(X(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function G(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)G(e,t[s],n,r,i);return null}return n=te(n),e&&e[M]?e.L(t,n,a(r)?!!r.capture:!!r,i):K(e,t,n,!0,r,i)}function Q(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Q(e,t[s],n,r,i);else r=a(r)?!!r.capture:!!r,n=te(n),e&&e[M]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=$(s=e.g[t],n,r,i))&&(V(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=$(t,n,r,i)),(n=-1<e?t[e]:null)&&Y(n))}function Y(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[M])z(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(X(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(z(n,e),0==n.h&&(n.src=null,t[q]=null)):V(e)}}}function X(e){return e in H?H[e]:H[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new O(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&Y(e),e=n.call(r,t)}return e}function Z(e){return(e=e[q])instanceof B?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){R.call(this),this.i=new B(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var i=t;x(t=new D(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var a=t.g=n[s];i=ie(a,r,!0,t)&&i}if(i=ie(a=t.g=e,r,!0,t)&&i,i=ie(a,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ie(a=t.g=n[s],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var a=t[s];if(a&&!a.da&&a.capture==n){var o=a.listener,l=a.ha||a.src;a.fa&&z(e.i,a),i=!1!==o.call(l,r)&&i}}return i&&!r.defaultPrevented}function se(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function ae(e){e.g=se(()=>{e.g=null,e.i&&(e.i=!1,ae(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ne,R),ne.prototype[M]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)V(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class oe extends R{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ae(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){R.call(this),this.h=e,this.g={}}d(le,R);var ce=[];function ue(e){y(e.g,function(e,t){this.g.hasOwnProperty(t)&&Y(e)},e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=i.JSON.stringify,he=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){D.call(this,"d")}function be(){D.call(this,"c")}d(ye,D),d(be,D);var we={},xe=null;function _e(){return xe=xe||new ne}function Ne(e){D.call(this,we.La,e)}function Ee(e){const t=_e();re(t,new Ne(t))}function ke(e,t){D.call(this,we.STAT_EVENT,e),this.stat=t}function Se(e){const t=_e();re(t,new ke(t,e))}function Ce(e,t){D.call(this,we.Ma,e),this.size=t}function je(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){e()},t)}function Ie(){this.g=!0}function Te(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}return de(n)}catch(o){return t}}(e,n)+(r?" "+r:"")})}we.La="serverreachability",d(Ne,D),we.STAT_EVENT="statevent",d(ke,D),we.Ma="timingevent",d(Ce,D),Ie.prototype.xa=function(){this.g=!1},Ie.prototype.info=function(){};var Ae,Re={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},De={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Pe(){}function Oe(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Le}function Le(){this.i=null,this.g="",this.h=!1}d(Pe,pe),Pe.prototype.g=function(){return new XMLHttpRequest},Pe.prototype.i=function(){return{}},Ae=new Pe;var Me={},Fe={};function Ue(e,t,n){e.L=1,e.v=dt(at(t)),e.m=n,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),$e(e),e.A=at(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),kt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Le,e.g=fn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ce[0]=i.toString()),i=ce);for(var s=0;s<i.length;s++){var a=W(n,i[s],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ee(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");a=2<=d.length&&"type"==d[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Be(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function ze(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Fe:(n=Number(t.substring(n,r)),isNaN(n)?Me:(r+=1)+n>t.length?Fe:(t=t.slice(r,r+n),e.C=r+n,t))}function $e(e){e.S=Date.now()+e.I,qe(e,e.I)}function qe(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=je(c(e.ba,e),t)}function He(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function We(e){0==e.j.G||e.J||ln(e.j,e)}function Ke(e){He(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ge(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;on(n),Yt(n)}rn(n),Se(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=je(c(n.Za,n),6e3));if(1>=Je(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((e.K||n.g==e)&&on(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=e;if((r=n).qa=hn(r,r.J?r.ia:null,r.W),a.K){tt(r.h,a);var o=a,l=r.L;l&&(o.I=l),o.B&&(He(o),$e(o)),r.g=a}else nn(r);0<n.i.length&&Jt(n)}else"stop"!=c[0]&&"close"!=c[0]||un(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?un(n,7):Qt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ee()}catch(u){}}Oe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Ht(e)?t.j():this.Y(e)},Oe.prototype.Y=function(e){try{if(e==this.g)e:{const h=Ht(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Wt(this.g)))){this.J||4!=h||7==t||Ee(),He(this);var n=this.g.Z();this.X=n;t:if(Be(this)){var r=Wt(this.g);e="";var s=r.length,a=4==Ht(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),We(this);var o="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(a&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+a})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Se(12),Ke(this),We(this);break e}Te(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ge(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=ze(this,o),e==Fe){4==h&&(this.s=4,Se(14),n=!1),Te(this.i,this.l,null,"[Incomplete Response]");break}if(e==Me){this.s=4,Se(15),Te(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Te(this.i,this.l,e,null),Ge(this,e)}if(Be(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Se(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),sn(d),d.M=!0,Se(11))}}else Te(this.i,this.l,o,"[Invalid Chunked Response]"),Ke(this),We(this)}else Te(this.i,this.l,o,null),Ge(this,o);4==h&&Ke(this),this.o&&!this.J&&(4==h?ln(this.j,this):(this.o=!1,$e(this)))}else(function(e){const t={};e=(e.g&&2<=Ht(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=_(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Se(12)):(this.s=0,Se(13)),Ke(this),We(this)}}}catch(ca){}},Oe.prototype.cancel=function(){this.J=!0,Ke(this)},Oe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Ee(),Se(17)),Ke(this),this.s=2,We(this)):qe(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Ye(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}Ye.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new xt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,ot(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),lt(this,t[4]),this.l=ht(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new xt(null,this.h))}function at(e){return new st(e)}function ot(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof xt?(e.i=t,function(e,t){t&&!e.j&&(_t(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Nt(this,t),kt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,bt)),e.i=new xt(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function dt(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?yt:vt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,wt)),e.join("")};var mt,gt=/[#\/\?@]/g,vt=/[#\?:]/g,yt=/[#\?]/g,bt=/[#\?@]/g,wt=/#/g;function xt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function _t(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Nt(e,t){_t(e),t=St(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Et(e,t){return _t(e),t=St(e,t),e.g.has(t)}function kt(e,t,n){Nt(e,t),0<n.length&&(e.i=null,e.g.set(St(e,t),h(n)),e.h+=n.length)}function St(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ct(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function jt(){this.g=new fe}function It(e,t,n){const r=n||"";try{rt(e,function(e,n){let i=e;a(e)&&(i=de(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(Bw){throw t.push(r+"type="+encodeURIComponent("_badmap")),Bw}}function Tt(e){this.l=e.Ub||null,this.j=e.eb||!1}function At(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Rt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Dt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Pt(e)}function Pt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ot(e){let t="";return y(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Lt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Ot(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Mt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=xt.prototype).add=function(e,t){_t(this),this.i=null,e=St(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){_t(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){_t(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){_t(this);let t=[];if("string"===typeof e)Et(this,e)&&(t=t.concat(this.g.get(St(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return _t(this),this.i=null,Et(this,e=St(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),a=this.V(r);for(r=0;r<a.length;r++){var i=s;""!==a[r]&&(i+="="+encodeURIComponent(String(a[r]))),e.push(i)}}return this.i=e.join("&")},d(Tt,pe),Tt.prototype.g=function(){return new At(this.l,this.j)},Tt.prototype.i=(mt={},function(){return mt}),d(At,ne),(e=At.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Pt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Dt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Pt(this)),this.g&&(this.readyState=3,Pt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Dt(this):Pt(this),3==this.readyState&&Rt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Dt(this))},e.Qa=function(e){this.g&&(this.response=e,Dt(this))},e.ga=function(){this.g&&Dt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(At.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Mt,ne);var Ft=/^https?$/i,Ut=["POST","PUT"];function Vt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Bt(e),$t(e)}function Bt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function zt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=Ht(e)||2!=e.Z()))if(e.u&&4==Ht(e))se(e.Ea,0,e);else if(re(e,"readystatechange"),4==Ht(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var a=String(e.D).match(it)[1]||null;!a&&i.self&&i.self.location&&(a=i.self.location.protocol.slice(0,-1)),s=!Ft.test(a?a.toLowerCase():"")}n=s}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var o=2<Ht(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Bt(e)}}finally{$t(e)}}}function $t(e,t){if(e.g){qt(e);const n=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{n.onreadystatechange=r}catch(Bw){}}}function qt(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function Ht(e){return e.g?e.g.readyState:0}function Wt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(ha){return null}}function Kt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Gt(e){this.Aa=0,this.i=[],this.j=new Ie,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kt("baseRetryDelayMs",5e3,e),this.cb=Kt("retryDelaySeedMs",1e4,e),this.Wa=Kt("forwardChannelMaxRetries",2,e),this.wa=Kt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ye(e&&e.concurrentRequestLimit),this.Da=new jt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Xt(e),3==e.G){var t=e.U++,n=at(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),en(e,n),(t=new Oe(e,e.j,t)).L=2,t.v=dt(at(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=fn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),$e(t)}dn(e)}function Yt(e){e.g&&(sn(e),e.g.cancel(),e.g=null)}function Xt(e){Yt(e),e.u&&(i.clearTimeout(e.u),e.u=null),on(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function Jt(e){if(!Xe(e.h)&&!e.s){e.s=!0;var t=e.Ga;C||T(),j||(C(),j=!0),I.add(t,e),e.B=0}}function Zt(e,t){var n;n=t?t.l:e.U++;const r=at(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),en(e,r),e.m&&e.o&&Lt(r,e.m,e.o),n=new Oe(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ue(n,r,t)}function en(e,t){e.H&&y(e.H,function(e,n){ut(t,n,e)}),e.l&&rt({},function(e,n){ut(t,n,e)})}function tn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let a=0;a<n;a++){let n=i[a].g;const o=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),s=!1;else try{It(o,e,"req"+n+"_")}catch(ca){r&&r(o)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;C||T(),j||(C(),j=!0),I.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=je(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function sn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function an(e){e.g=new Oe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=at(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Lt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=dt(at(t)),n.m=null,n.P=!0,Ve(n,e)}function on(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){on(e),sn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=_e(),new Ce(r,n)),Jt(e)}else nn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=je(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==r&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:un(e,5);break;case 4:un(e,10);break;case 3:un(e,6);break;default:un(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function un(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new st(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||ot(r,"https"),dt(r),t?function(e,t){const n=new Ie;if(i.Image){const r=new Image;r.onload=u(Ct,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Ct,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Ct,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Ct,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ie;const n=new AbortController,r=setTimeout(()=>{n.abort(),Ct(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Ct(0,0,!0,t):Ct(0,0,!1,t)}).catch(()=>{clearTimeout(r),Ct(0,0,!1,t)})}(r.toString(),n)}else Se(2);e.G=0,e.l&&e.l.sa(t),dn(e),Xt(e)}function dn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function hn(e,t,n){var r=n instanceof st?at(n):new st(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var a=new st(null);r&&ot(a,r),t&&(a.g=t),s&&lt(a,s),n&&(a.l=n),r=a}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),en(e,r),r}function fn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Mt(new Tt({eb:n})):new Mt(e.pa)).Ha(e.J),t}function pn(){}function mn(){}function gn(e,t){ne.call(this),this.g=new Gt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new bn(this)}function vn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function yn(){be.call(this),this.status=1}function bn(e){this.g=e}(e=Mt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ae.g(),this.v=this.o?me(this.o):me(Ae),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void Vt(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Ut,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qt(this),this.u=!0,this.g.send(e),this.u=!1}catch(a){Vt(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),$t(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$t(this,!0)),Mt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?zt(this):this.bb())},e.bb=function(){zt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Ht(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Gt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Se(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=hn(this,null,this.W),Jt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Oe(this,this.j,e);let s=this.o;if(this.S&&(s?(s=b(s),x(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,i,t),ut(n=at(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),en(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Ot(s)))+"&"+t:this.m&&Lt(n,this.m,s)),et(this.h,i),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),i.T=!0,Ue(i,n,null)):Ue(i,n,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Xe(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,an(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=je(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Se(10),Yt(this),an(this))},e.Za=function(){null!=this.C&&(this.C=null,Yt(this),rn(this),Se(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Se(2)):(this.j.info("Failed to ping google.com"),Se(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=pn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},mn.prototype.g=function(e,t){return new gn(e,t)},d(gn,ne),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Qt(this.g)},gn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=de(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Jt(t)},gn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,gn.aa.N.call(this)},d(vn,ye),d(yn,be),d(bn,pn),bn.prototype.ua=function(){re(this.g,"a")},bn.prototype.ta=function(e){re(this.g,new vn(e))},bn.prototype.sa=function(e){re(this.g,new yn)},bn.prototype.ra=function(){re(this.g,"b")},mn.prototype.createWebChannel=mn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,aa=la.createWebChannelTransport=function(){return new mn},sa=la.getStatEventTarget=function(){return _e()},ia=la.Event=we,ra=la.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,na=la.ErrorCode=Re,De.COMPLETE="complete",ta=la.EventType=De,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,ea=la.WebChannel=ge,la.FetchXmlHttpFactory=Tt,Mt.prototype.listenOnce=Mt.prototype.L,Mt.prototype.getLastError=Mt.prototype.Ka,Mt.prototype.getLastErrorCode=Mt.prototype.Ba,Mt.prototype.getStatus=Mt.prototype.Z,Mt.prototype.getResponseJson=Mt.prototype.Oa,Mt.prototype.getResponseText=Mt.prototype.oa,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Ha,Zs=la.XhrIo=Mt}).apply("undefined"!==typeof oa?oa:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const ca="@firebase/firestore";class ua{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ua.UNAUTHENTICATED=new ua(null),ua.GOOGLE_CREDENTIALS=new ua("google-credentials-uid"),ua.FIRST_PARTY=new ua("first-party-uid"),ua.MOCK_USER=new ua("mock-user");let da="10.14.0";const ha=new gt("@firebase/firestore");function fa(){return ha.logLevel}function pa(e){if(ha.logLevel<=dt.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(va);ha.debug(`Firestore (${da}): ${e}`,...i)}}function ma(e){if(ha.logLevel<=dt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(va);ha.error(`Firestore (${da}): ${e}`,...i)}}function ga(e){if(ha.logLevel<=dt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(va);ha.warn(`Firestore (${da}): ${e}`,...i)}}function va(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function ya(){const e=`FIRESTORE (${da}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw ma(e),new Error(e)}function ba(e,t){e||ya()}function wa(e,t){return e}const xa={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _a extends Qe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Na{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Ea{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ka{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ua.UNAUTHENTICATED))}shutdown(){}}class Sa{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Ca{constructor(e){this.t=e,this.currentUser=ua.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ba(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Na;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Na,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},a=e=>{pa("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(pa("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Na)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(pa("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(ba("string"==typeof t.accessToken),new Ea(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ba(null===e||"string"==typeof e),new ua(e)}}class ja{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=ua.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Ia{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new ja(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ua.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ta{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Aa{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ba(void 0===this.o);const n=e=>{null!=e.error&&pa("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,pa("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{pa("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):pa("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(ba("string"==typeof e.token),this.R=e.token,new Ta(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Ra(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Da{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=Ra(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function Pa(e,t){return e<t?-1:e>t?1:0}function Oa(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}class La{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new _a(xa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new _a(xa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new _a(xa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _a(xa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return La.fromMillis(Date.now())}static fromDate(e){return La.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new La(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Pa(this.nanoseconds,e.nanoseconds):Pa(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ma{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ma(e)}static min(){return new Ma(new La(0,0))}static max(){return new Ma(new La(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Fa{constructor(e,t,n){void 0===t?t=0:t>e.length&&ya(),void 0===n?n=e.length-t:n>e.length-t&&ya(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Fa.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Fa?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ua extends Fa{construct(e,t,n){return new Ua(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new _a(xa.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(e=>e.length>0))}return new Ua(e)}static emptyPath(){return new Ua([])}}const Va=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ba extends Fa{construct(e,t,n){return new Ba(e,t,n)}static isValidIdentifier(e){return Va.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ba.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ba(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new _a(xa.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new _a(xa.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new _a(xa.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new _a(xa.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ba(t)}static emptyPath(){return new Ba([])}}class za{constructor(e){this.path=e}static fromPath(e){return new za(Ua.fromString(e))}static fromName(e){return new za(Ua.fromString(e).popFirst(5))}static empty(){return new za(Ua.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ua.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ua.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new za(new Ua(e.slice()))}}class $a{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}$a.UNKNOWN_ID=-1;function qa(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Ma.fromTimestamp(1e9===r?new La(n+1,0):new La(n,r));return new Wa(i,za.empty(),t)}function Ha(e){return new Wa(e.readTime,e.key,-1)}class Wa{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Wa(Ma.min(),za.empty(),-1)}static max(){return new Wa(Ma.max(),za.empty(),-1)}}function Ka(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=za.comparator(e.documentKey,t.documentKey),0!==n?n:Pa(e.largestBatchId,t.largestBatchId))}const Ga="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Qa{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Ya(e){if(e.code!==xa.FAILED_PRECONDITION||e.message!==Ga)throw e;pa("LocalStore","Unexpectedly lost primary lease")}class Xa{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ya(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Xa((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Xa?t:Xa.resolve(t)}catch(e){return Xa.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Xa.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Xa.reject(t)}static resolve(e){return new Xa((t,n)=>{t(e)})}static reject(e){return new Xa((t,n)=>{n(e)})}static waitFor(e){return new Xa((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=Xa.resolve(!1);for(const n of e)t=t.next(e=>e?Xa.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Xa((n,r)=>{const i=e.length,s=new Array(i);let a=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next(e=>{s[l]=e,++a,a===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new Xa((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function Ja(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Za(e){return"IndexedDbTransactionError"===e.name}class eo{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function to(e){return null==e}function no(e){return 0===e&&1/e==-1/0}function ro(e){return"number"==typeof e&&Number.isInteger(e)&&!no(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}eo.oe=-1;const io=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],so=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ao=so,oo=[...ao,"indexConfiguration","indexState","indexEntries"];function lo(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function co(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function uo(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class ho{constructor(e,t){this.comparator=e,this.root=t||po.EMPTY}insert(e,t){return new ho(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,po.BLACK,null,null))}remove(e){return new ho(this.comparator,this.root.remove(e,this.comparator).copy(null,null,po.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fo(this.root,e,this.comparator,!1)}getReverseIterator(){return new fo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fo(this.root,e,this.comparator,!0)}}class fo{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class po{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:po.RED,this.left=null!=r?r:po.EMPTY,this.right=null!=i?i:po.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new po(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return po.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return po.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,po.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,po.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ya();if(this.right.isRed())throw ya();const e=this.left.check();if(e!==this.right.check())throw ya();return e+(this.isRed()?0:1)}}po.EMPTY=null,po.RED=!0,po.BLACK=!1,po.EMPTY=new class{constructor(){this.size=0}get key(){throw ya()}get value(){throw ya()}get color(){throw ya()}get left(){throw ya()}get right(){throw ya()}copy(e,t,n,r,i){return this}insert(e,t,n){return new po(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class mo{constructor(e){this.comparator=e,this.data=new ho(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new go(this.data.getIterator())}getIteratorFrom(e){return new go(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof mo))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new mo(this.comparator);return t.data=e,t}}class go{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class vo{constructor(e){this.fields=e,e.sort(Ba.comparator)}static empty(){return new vo([])}unionWith(e){let t=new mo(Ba.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new vo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Oa(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class yo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class bo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new yo("Invalid base64 string: "+e):e}}(e);return new bo(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new bo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pa(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}bo.EMPTY_BYTE_STRING=new bo("");const wo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xo(e){if(ba(!!e),"string"==typeof e){let t=0;const n=wo.exec(e);if(ba(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:_o(e.seconds),nanos:_o(e.nanos)}}function _o(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function No(e){return"string"==typeof e?bo.fromBase64String(e):bo.fromUint8Array(e)}function Eo(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ko(e){const t=e.mapValue.fields.__previous_value__;return Eo(t)?ko(t):t}function So(e){const t=xo(e.mapValue.fields.__local_write_time__.timestampValue);return new La(t.seconds,t.nanos)}class Co{constructor(e,t,n,r,i,s,a,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l}}class jo{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new jo("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof jo&&e.projectId===this.projectId&&e.database===this.database}}const Io={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function To(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Eo(e)?4:Wo(e)?9007199254740991:qo(e)?10:11:ya()}function Ao(e,t){if(e===t)return!0;const n=To(e);if(n!==To(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return So(e).isEqual(So(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=xo(e.timestampValue),r=xo(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return No(e.bytesValue).isEqual(No(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return _o(e.geoPointValue.latitude)===_o(t.geoPointValue.latitude)&&_o(e.geoPointValue.longitude)===_o(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return _o(e.integerValue)===_o(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=_o(e.doubleValue),r=_o(t.doubleValue);return n===r?no(n)===no(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Oa(e.arrayValue.values||[],t.arrayValue.values||[],Ao);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(lo(n)!==lo(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ao(n[i],r[i])))return!1;return!0}(e,t);default:return ya()}}function Ro(e,t){return void 0!==(e.values||[]).find(e=>Ao(e,t))}function Do(e,t){if(e===t)return 0;const n=To(e),r=To(t);if(n!==r)return Pa(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Pa(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=_o(e.integerValue||e.doubleValue),r=_o(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Po(e.timestampValue,t.timestampValue);case 4:return Po(So(e),So(t));case 5:return Pa(e.stringValue,t.stringValue);case 6:return function(e,t){const n=No(e),r=No(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=Pa(n[i],r[i]);if(0!==e)return e}return Pa(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Pa(_o(e.latitude),_o(t.latitude));return 0!==n?n:Pa(_o(e.longitude),_o(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Oo(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const a=e.fields||{},o=t.fields||{},l=null===(n=a.value)||void 0===n?void 0:n.arrayValue,c=null===(r=o.value)||void 0===r?void 0:r.arrayValue,u=Pa((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:Oo(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Io.mapValue&&t===Io.mapValue)return 0;if(e===Io.mapValue)return 1;if(t===Io.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let a=0;a<r.length&&a<s.length;++a){const e=Pa(r[a],s[a]);if(0!==e)return e;const t=Do(n[r[a]],i[s[a]]);if(0!==t)return t}return Pa(r.length,s.length)}(e.mapValue,t.mapValue);default:throw ya()}}function Po(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Pa(e,t);const n=xo(e),r=xo(t),i=Pa(n.seconds,r.seconds);return 0!==i?i:Pa(n.nanos,r.nanos)}function Oo(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=Do(n[i],r[i]);if(e)return e}return Pa(n.length,r.length)}function Lo(e){return Mo(e)}function Mo(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=xo(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return No(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return za.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Mo(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Mo(e.fields[i])}`;return n+"}"}(e.mapValue):ya()}function Fo(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Uo(e){return!!e&&"integerValue"in e}function Vo(e){return!!e&&"arrayValue"in e}function Bo(e){return!!e&&"nullValue"in e}function zo(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function $o(e){return!!e&&"mapValue"in e}function qo(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ho(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return co(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Ho(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ho(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Wo(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Ko{constructor(e){this.value=e}static empty(){return new Ko({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!$o(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ho(t)}setAll(e){let t=Ba.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Ho(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());$o(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ao(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];$o(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){co(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Ko(Ho(this.value))}}function Go(e){const t=[];return co(e.fields,(e,n)=>{const r=new Ba([e]);if($o(n)){const e=Go(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new vo(t)}class Qo{constructor(e,t,n,r,i,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new Qo(e,0,Ma.min(),Ma.min(),Ma.min(),Ko.empty(),0)}static newFoundDocument(e,t,n,r){return new Qo(e,1,t,Ma.min(),n,r,0)}static newNoDocument(e,t){return new Qo(e,2,t,Ma.min(),Ma.min(),Ko.empty(),0)}static newUnknownDocument(e,t){return new Qo(e,3,t,Ma.min(),Ma.min(),Ko.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ma.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ko.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ko.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ma.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Qo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Yo{constructor(e,t){this.position=e,this.inclusive=t}}function Xo(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],a=e.position[i];if(r=s.field.isKeyField()?za.comparator(za.fromName(a.referenceValue),n.key):Do(a,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Jo(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ao(e.position[n],t.position[n]))return!1;return!0}class Zo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function el(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class tl{}class nl extends tl{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new ul(e,t,n):"array-contains"===t?new pl(e,n):"in"===t?new ml(e,n):"not-in"===t?new gl(e,n):"array-contains-any"===t?new vl(e,n):new nl(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new dl(e,n):new hl(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Do(t,this.value)):null!==t&&To(this.value)===To(t)&&this.matchesComparison(Do(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ya()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rl extends tl{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new rl(e,t)}matches(e){return il(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function il(e){return"and"===e.op}function sl(e){return al(e)&&il(e)}function al(e){for(const t of e.filters)if(t instanceof rl)return!1;return!0}function ol(e){if(e instanceof nl)return e.field.canonicalString()+e.op.toString()+Lo(e.value);if(sl(e))return e.filters.map(e=>ol(e)).join(",");{const t=e.filters.map(e=>ol(e)).join(",");return`${e.op}(${t})`}}function ll(e,t){return e instanceof nl?function(e,t){return t instanceof nl&&e.op===t.op&&e.field.isEqual(t.field)&&Ao(e.value,t.value)}(e,t):e instanceof rl?function(e,t){return t instanceof rl&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&ll(n,t.filters[r]),!0)}(e,t):void ya()}function cl(e){return e instanceof nl?function(e){return`${e.field.canonicalString()} ${e.op} ${Lo(e.value)}`}(e):e instanceof rl?function(e){return e.op.toString()+" {"+e.getFilters().map(cl).join(" ,")+"}"}(e):"Filter"}class ul extends nl{constructor(e,t,n){super(e,t,n),this.key=za.fromName(n.referenceValue)}matches(e){const t=za.comparator(e.key,this.key);return this.matchesComparison(t)}}class dl extends nl{constructor(e,t){super(e,"in",t),this.keys=fl("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class hl extends nl{constructor(e,t){super(e,"not-in",t),this.keys=fl("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function fl(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>za.fromName(e.referenceValue))}class pl extends nl{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Vo(t)&&Ro(t.arrayValue,this.value)}}class ml extends nl{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ro(this.value.arrayValue,t)}}class gl extends nl{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ro(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Ro(this.value.arrayValue,t)}}class vl extends nl{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Vo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Ro(this.value.arrayValue,e))}}class yl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=a,this.ue=null}}function bl(e){return new yl(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function wl(e){const t=wa(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>ol(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),to(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Lo(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Lo(e)).join(",")),t.ue=e}return t.ue}function xl(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!el(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!ll(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Jo(e.startAt,t.startAt)&&Jo(e.endAt,t.endAt)}function _l(e){return za.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Nl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function El(e,t,n,r,i,s,a,o){return new Nl(e,t,n,r,i,s,a,o)}function kl(e){return new Nl(e)}function Sl(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Cl(e){return null!==e.collectionGroup}function jl(e){const t=wa(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new mo(Ba.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new Zo(r,n))}),e.has(Ba.keyField().canonicalString())||t.ce.push(new Zo(Ba.keyField(),n))}return t.ce}function Il(e){const t=wa(e);return t.le||(t.le=Tl(t,jl(e))),t.le}function Tl(e,t){if("F"===e.limitType)return bl(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Zo(e.field,t)});const n=e.endAt?new Yo(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Yo(e.startAt.position,e.startAt.inclusive):null;return bl(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Al(e,t){const n=e.filters.concat([t]);return new Nl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Rl(e,t,n){return new Nl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Dl(e,t){return xl(Il(e),Il(t))&&e.limitType===t.limitType}function Pl(e){return`${wl(Il(e))}|lt:${e.limitType}`}function Ol(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>cl(e)).join(", ")}]`),to(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Lo(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Lo(e)).join(",")),`Target(${t})`}(Il(e))}; limitType=${e.limitType})`}function Ll(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):za.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of jl(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Xo(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,jl(e),t))&&!(e.endAt&&!function(e,t,n){const r=Xo(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,jl(e),t))}(e,t)}function Ml(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Fl(e){return(t,n)=>{let r=!1;for(const i of jl(e)){const e=Ul(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Ul(e,t,n){const r=e.field.isKeyField()?za.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Do(r,i):ya()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return ya()}}class Vl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){co(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return uo(this.inner)}size(){return this.innerSize}}const Bl=new ho(za.comparator);function zl(){return Bl}const $l=new ho(za.comparator);function ql(){let e=$l;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function Hl(e){let t=$l;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Wl(){return Gl()}function Kl(){return Gl()}function Gl(){return new Vl(e=>e.toString(),(e,t)=>e.isEqual(t))}const Ql=new ho(za.comparator),Yl=new mo(za.comparator);function Xl(){let e=Yl;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const Jl=new mo(Pa);function Zl(){return Jl}function ec(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:no(t)?"-0":t}}function tc(e){return{integerValue:""+e}}function nc(e,t){return ro(t)?tc(t):ec(e,t)}class rc{constructor(){this._=void 0}}function ic(e,t,n){return e instanceof oc?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Eo(t)&&(t=ko(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof lc?cc(e,t):e instanceof uc?dc(e,t):function(e,t){const n=ac(e,t),r=fc(n)+fc(e.Pe);return Uo(n)&&Uo(e.Pe)?tc(r):ec(e.serializer,r)}(e,t)}function sc(e,t,n){return e instanceof lc?cc(e,t):e instanceof uc?dc(e,t):n}function ac(e,t){return e instanceof hc?function(e){return Uo(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class oc extends rc{}class lc extends rc{constructor(e){super(),this.elements=e}}function cc(e,t){const n=pc(t);for(const r of e.elements)n.some(e=>Ao(e,r))||n.push(r);return{arrayValue:{values:n}}}class uc extends rc{constructor(e){super(),this.elements=e}}function dc(e,t){let n=pc(t);for(const r of e.elements)n=n.filter(e=>!Ao(e,r));return{arrayValue:{values:n}}}class hc extends rc{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function fc(e){return _o(e.integerValue||e.doubleValue)}function pc(e){return Vo(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class mc{constructor(e,t){this.field=e,this.transform=t}}class gc{constructor(e,t){this.version=e,this.transformResults=t}}class vc{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new vc}static exists(e){return new vc(void 0,e)}static updateTime(e){return new vc(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yc(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class bc{}function wc(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Tc(e.key,vc.none()):new kc(e.key,e.data,vc.none());{const n=e.data,r=Ko.empty();let i=new mo(Ba.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Sc(e.key,r,new vo(i.toArray()),vc.none())}}function xc(e,t,n){e instanceof kc?function(e,t,n){const r=e.value.clone(),i=jc(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Sc?function(e,t,n){if(!yc(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=jc(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Cc(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function _c(e,t,n,r){return e instanceof kc?function(e,t,n,r){if(!yc(e.precondition,t))return n;const i=e.value.clone(),s=Ic(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Sc?function(e,t,n,r){if(!yc(e.precondition,t))return n;const i=Ic(e.fieldTransforms,r,t),s=t.data;return s.setAll(Cc(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return yc(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Nc(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=ac(r.transform,e||null);null!=i&&(null===n&&(n=Ko.empty()),n.set(r.field,i))}return n||null}function Ec(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Oa(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof lc&&t instanceof lc||e instanceof uc&&t instanceof uc?Oa(e.elements,t.elements,Ao):e instanceof hc&&t instanceof hc?Ao(e.Pe,t.Pe):e instanceof oc&&t instanceof oc}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class kc extends bc{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Sc extends bc{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Cc(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function jc(e,t,n){const r=new Map;ba(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],a=s.transform,o=t.data.field(s.field);r.set(s.field,sc(a,o,n[i]))}return r}function Ic(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,ic(e,s,t))}return r}class Tc extends bc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ac extends bc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Rc{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&xc(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=_c(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=_c(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Kl();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let a=this.applyToLocalView(s,i.mutatedFields);a=t.has(r.key)?null:a;const o=wc(s,a);null!==o&&n.set(r.key,o),s.isValidDocument()||s.convertToNoDocument(Ma.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Xl())}isEqual(e){return this.batchId===e.batchId&&Oa(this.mutations,e.mutations,(e,t)=>Ec(e,t))&&Oa(this.baseMutations,e.baseMutations,(e,t)=>Ec(e,t))}}class Dc{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){ba(e.mutations.length===n.length);let r=Ql;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new Dc(e,t,n,r)}}class Pc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Oc{constructor(e,t){this.count=e,this.unchangedNames=t}}var Lc,Mc;function Fc(e){switch(e){default:return ya();case xa.CANCELLED:case xa.UNKNOWN:case xa.DEADLINE_EXCEEDED:case xa.RESOURCE_EXHAUSTED:case xa.INTERNAL:case xa.UNAVAILABLE:case xa.UNAUTHENTICATED:return!1;case xa.INVALID_ARGUMENT:case xa.NOT_FOUND:case xa.ALREADY_EXISTS:case xa.PERMISSION_DENIED:case xa.FAILED_PRECONDITION:case xa.ABORTED:case xa.OUT_OF_RANGE:case xa.UNIMPLEMENTED:case xa.DATA_LOSS:return!0}}function Uc(e){if(void 0===e)return ma("GRPC error has no .code"),xa.UNKNOWN;switch(e){case Lc.OK:return xa.OK;case Lc.CANCELLED:return xa.CANCELLED;case Lc.UNKNOWN:return xa.UNKNOWN;case Lc.DEADLINE_EXCEEDED:return xa.DEADLINE_EXCEEDED;case Lc.RESOURCE_EXHAUSTED:return xa.RESOURCE_EXHAUSTED;case Lc.INTERNAL:return xa.INTERNAL;case Lc.UNAVAILABLE:return xa.UNAVAILABLE;case Lc.UNAUTHENTICATED:return xa.UNAUTHENTICATED;case Lc.INVALID_ARGUMENT:return xa.INVALID_ARGUMENT;case Lc.NOT_FOUND:return xa.NOT_FOUND;case Lc.ALREADY_EXISTS:return xa.ALREADY_EXISTS;case Lc.PERMISSION_DENIED:return xa.PERMISSION_DENIED;case Lc.FAILED_PRECONDITION:return xa.FAILED_PRECONDITION;case Lc.ABORTED:return xa.ABORTED;case Lc.OUT_OF_RANGE:return xa.OUT_OF_RANGE;case Lc.UNIMPLEMENTED:return xa.UNIMPLEMENTED;case Lc.DATA_LOSS:return xa.DATA_LOSS;default:return ya()}}(Mc=Lc||(Lc={}))[Mc.OK=0]="OK",Mc[Mc.CANCELLED=1]="CANCELLED",Mc[Mc.UNKNOWN=2]="UNKNOWN",Mc[Mc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mc[Mc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mc[Mc.NOT_FOUND=5]="NOT_FOUND",Mc[Mc.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mc[Mc.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mc[Mc.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mc[Mc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mc[Mc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mc[Mc.ABORTED=10]="ABORTED",Mc[Mc.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mc[Mc.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mc[Mc.INTERNAL=13]="INTERNAL",Mc[Mc.UNAVAILABLE=14]="UNAVAILABLE",Mc[Mc.DATA_LOSS=15]="DATA_LOSS";let Vc=null;function Bc(){return new TextEncoder}const zc=new Qs([4294967295,4294967295],0);function $c(e){const t=Bc().encode(e),n=new Ys;return n.update(t),new Uint8Array(n.digest())}function qc(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Qs([n,r],0),new Qs([i,s],0)]}class Hc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Wc(`Invalid padding: ${t}`);if(n<0)throw new Wc(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Wc(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Wc(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Qs.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(Qs.fromNumber(n)));return 1===r.compare(zc)&&(r=new Qs([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=$c(e),[n,r]=qc(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Hc(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.Ie)return;const t=$c(e),[n,r]=qc(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Wc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Kc{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Gc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Kc(Ma.min(),r,new ho(Pa),zl(),Xl())}}class Gc{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Gc(n,t,Xl(),Xl(),Xl())}}class Qc{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class Yc{constructor(e,t){this.targetId=e,this.me=t}}class Xc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bo.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Jc{constructor(){this.fe=0,this.ge=tu(),this.pe=bo.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Xl(),t=Xl(),n=Xl();return this.ge.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:ya()}}),new Gc(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=tu()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ba(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Zc{constructor(e){this.Le=e,this.Be=new Map,this.ke=zl(),this.qe=eu(),this.Qe=new ho(Pa)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:ya()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((e,n)=>{this.ze(n)&&t(n)})}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(_l(i))if(0===n){const e=new za(i.path);this.Ue(t,e,Qo.newNoDocument(e,Ma.min()))}else ba(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==Vc||Vc.et(function(e,t,n,r,i){var s,a,o,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(s=null==h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(o=null===(a=null==h?void 0:h.bits)||void 0===a?void 0:a.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,a;try{s=No(n).toUint8Array()}catch(e){if(e instanceof yo)return ga("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{a=new Hc(s,r,i)}catch(e){return ga(e instanceof Wc?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===a.Ie?null:a}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Le.tt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.Ue(t,n,null),r++)}),r}rt(e){const t=new Map;this.Be.forEach((n,r)=>{const i=this.Je(r);if(i){if(n.current&&_l(i.target)){const t=new za(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,Qo.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}});let n=Xl();this.qe.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.ke.forEach((t,n)=>n.setReadTime(e));const r=new Kc(e,t,this.Qe,this.ke,n);return this.ke=zl(),this.qe=eu(),this.Qe=new ho(Pa),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Jc,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new mo(Pa),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||pa("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Jc),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function eu(){return new ho(za.comparator)}function tu(){return new ho(za.comparator)}const nu={asc:"ASCENDING",desc:"DESCENDING"},ru={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iu={and:"AND",or:"OR"};class su{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function au(e,t){return e.useProto3Json||to(t)?t:{value:t}}function ou(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function lu(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function cu(e,t){return ou(e,t.toTimestamp())}function uu(e){return ba(!!e),Ma.fromTimestamp(function(e){const t=xo(e);return new La(t.seconds,t.nanos)}(e))}function du(e,t){return hu(e,t).canonicalString()}function hu(e,t){const n=function(e){return new Ua(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function fu(e){const t=Ua.fromString(e);return ba(Du(t)),t}function pu(e,t){return du(e.databaseId,t.path)}function mu(e,t){const n=fu(t);if(n.get(1)!==e.databaseId.projectId)throw new _a(xa.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new _a(xa.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new za(bu(n))}function gu(e,t){return du(e.databaseId,t)}function vu(e){const t=fu(e);return 4===t.length?Ua.emptyPath():bu(t)}function yu(e){return new Ua(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function bu(e){return ba(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function wu(e,t,n){return{name:pu(e,t),fields:n.value.mapValue.fields}}function xu(e,t){let n;if(t instanceof kc)n={update:wu(e,t.key,t.value)};else if(t instanceof Tc)n={delete:pu(e,t.key)};else if(t instanceof Sc)n={update:wu(e,t.key,t.data),updateMask:Ru(t.fieldMask)};else{if(!(t instanceof Ac))return ya();n={verify:pu(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof oc)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof lc)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof uc)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof hc)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw ya()}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:cu(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:ya()}(e,t.precondition)),n}function _u(e,t){return{documents:[gu(e,t.path)]}}function Nu(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=gu(e,i);const s=function(e){if(0!==e.length)return Au(rl.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const a=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Iu(e.field),direction:Su(e.dir)}}(e))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const o=au(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function Eu(e){let t=vu(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ba(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=ku(e);return t instanceof rl&&sl(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=function(e){return e.map(e=>function(e){return new Zo(Tu(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,to(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Yo(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Yo(n,t)}(n.endAt)),El(t,i,a,s,o,"F",l,c)}function ku(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Tu(e.unaryFilter.field);return nl.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Tu(e.unaryFilter.field);return nl.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Tu(e.unaryFilter.field);return nl.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Tu(e.unaryFilter.field);return nl.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ya()}}(e):void 0!==e.fieldFilter?function(e){return nl.create(Tu(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ya()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return rl.create(e.compositeFilter.filters.map(e=>ku(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return ya()}}(e.compositeFilter.op))}(e):ya()}function Su(e){return nu[e]}function Cu(e){return ru[e]}function ju(e){return iu[e]}function Iu(e){return{fieldPath:e.canonicalString()}}function Tu(e){return Ba.fromServerFormat(e.fieldPath)}function Au(e){return e instanceof nl?function(e){if("=="===e.op){if(zo(e.value))return{unaryFilter:{field:Iu(e.field),op:"IS_NAN"}};if(Bo(e.value))return{unaryFilter:{field:Iu(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(zo(e.value))return{unaryFilter:{field:Iu(e.field),op:"IS_NOT_NAN"}};if(Bo(e.value))return{unaryFilter:{field:Iu(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Iu(e.field),op:Cu(e.op),value:e.value}}}(e):e instanceof rl?function(e){const t=e.getFilters().map(e=>Au(e));return 1===t.length?t[0]:{compositeFilter:{op:ju(e.op),filters:t}}}(e):ya()}function Ru(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Du(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Pu{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ma.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ma.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:bo.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new Pu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Pu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Pu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Pu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Ou{constructor(e){this.ct=e}}function Lu(e){const t=Eu({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Rl(t,t.limit,"L"):t}class Mu{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(_o(e.integerValue));else if("doubleValue"in e){const n=_o(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),no(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=xo(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(No(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?Wo(e)?this.dt(t,Number.MAX_SAFE_INTEGER):qo(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):ya()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const i=e.fields||{};this.dt(t,53);const s="value",a=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At(_o(a)),this.Vt(s,t),this.Tt(i[s],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),za.fromName(e).path.forEach(e=>{this.dt(t,60),this.Dt(e,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}Mu.vt=new Mu;class Fu{constructor(){this.un=new Uu}addToCollectionParentIndex(e,t){return this.un.add(t),Xa.resolve()}getCollectionParents(e,t){return Xa.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Xa.resolve()}deleteFieldIndex(e,t){return Xa.resolve()}deleteAllFieldIndexes(e){return Xa.resolve()}createTargetIndexes(e,t){return Xa.resolve()}getDocumentsMatchingTarget(e,t){return Xa.resolve(null)}getIndexType(e,t){return Xa.resolve(0)}getFieldIndexes(e,t){return Xa.resolve([])}getNextCollectionGroupToUpdate(e){return Xa.resolve(null)}getMinOffset(e,t){return Xa.resolve(Wa.min())}getMinOffsetFromCollectionGroup(e,t){return Xa.resolve(Wa.min())}updateCollectionGroup(e,t,n){return Xa.resolve()}updateIndexEntries(e,t){return Xa.resolve()}}class Uu{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new mo(Ua.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new mo(Ua.comparator)).toArray()}}new Uint8Array(0);class Vu{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Vu(e,Vu.DEFAULT_COLLECTION_PERCENTILE,Vu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Vu.DEFAULT_COLLECTION_PERCENTILE=10,Vu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vu.DEFAULT=new Vu(41943040,Vu.DEFAULT_COLLECTION_PERCENTILE,Vu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vu.DISABLED=new Vu(-1,0,0);class Bu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Bu(0)}static kn(){return new Bu(-1)}}class zu{constructor(){this.changes=new Vl(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Qo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Xa.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class $u{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class qu{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&_c(n.mutation,e,vo.empty(),La.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Xl()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xl();const r=Wl();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=ql();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Wl();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Xl()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=zl();const s=Gl(),a=Gl();return t.forEach((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof Sc)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),_c(a.mutation,t,a.mutation.getFieldMask(),La.now())):s.set(t.key,vo.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return a.set(e,new $u(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),a))}recalculateAndSaveOverlays(e,t){const n=Gl();let r=new ho((e,t)=>e-t),i=Xl();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let a=n.get(e)||vo.empty();a=i.applyToLocalView(s,a),n.set(e,a);const o=(r.get(i.batchId)||Xl()).add(e);r=r.insert(i.batchId,o)})}).next(()=>{const s=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),o=r.key,l=r.value,c=Kl();l.forEach(e=>{if(!i.has(e)){const r=wc(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return Xa.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return za.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Cl(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Xa.resolve(Wl());let a=-1,o=i;return s.next(t=>Xa.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),i.get(t)?Xa.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,Xl())).next(e=>({batchId:a,changes:Hl(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new za(t)).next(e=>{let t=ql();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=ql();return this.indexManager.getCollectionParents(e,i).next(a=>Xa.forEach(a,a=>{const o=function(e,t){return new Nl(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Qo.newInvalidDocument(r)))});let n=ql();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&_c(s.mutation,r,vo.empty(),La.now()),Ll(t,r)&&(n=n.insert(e,r))}),n})}}class Hu{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Xa.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:uu(e.createTime)}}(t)),Xa.resolve()}getNamedQuery(e,t){return Xa.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:Lu(e.bundledQuery),readTime:uu(e.readTime)}}(t)),Xa.resolve()}}class Wu{constructor(){this.overlays=new ho(za.comparator),this.Ir=new Map}getOverlay(e,t){return Xa.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Wl();return Xa.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.ht(e,t,r)}),Xa.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.Ir.delete(n)),Xa.resolve()}getOverlaysForCollection(e,t,n){const r=Wl(),i=t.length+1,s=new za(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Xa.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new ho((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Wl(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=Wl(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=r)););return Xa.resolve(a)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Pc(t,n));let i=this.Ir.get(t);void 0===i&&(i=Xl(),this.Ir.set(t,i)),this.Ir.set(t,i.add(n.key))}}class Ku{constructor(){this.sessionToken=bo.EMPTY_BYTE_STRING}getSessionToken(e){return Xa.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Xa.resolve()}}class Gu{constructor(){this.Tr=new mo(Qu.Er),this.dr=new mo(Qu.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new Qu(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Vr(new Qu(e,t))}mr(e,t){e.forEach(e=>this.removeReference(e,t))}gr(e){const t=new za(new Ua([])),n=new Qu(t,e),r=new Qu(t,e+1),i=[];return this.dr.forEachInRange([n,r],e=>{this.Vr(e),i.push(e.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new za(new Ua([])),n=new Qu(t,e),r=new Qu(t,e+1);let i=Xl();return this.dr.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new Qu(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Qu{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return za.comparator(e.key,t.key)||Pa(e.wr,t.wr)}static Ar(e,t){return Pa(e.wr,t.wr)||za.comparator(e.key,t.key)}}class Yu{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new mo(Qu.Er)}checkEmpty(e){return Xa.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Rc(i,t,n,r);this.mutationQueue.push(s);for(const a of r)this.br=this.br.add(new Qu(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Xa.resolve(s)}lookupMutationBatch(e,t){return Xa.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),i=r<0?0:r;return Xa.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Xa.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return Xa.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Qu(t,0),r=new Qu(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,r],e=>{const t=this.Dr(e.wr);i.push(t)}),Xa.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new mo(Pa);return t.forEach(e=>{const t=new Qu(e,0),r=new Qu(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],e=>{n=n.add(e.wr)})}),Xa.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;za.isDocumentKey(i)||(i=i.child(""));const s=new Qu(new za(i),0);let a=new mo(Pa);return this.br.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.wr)),!0)},s),Xa.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(e=>{const n=this.Dr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){ba(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return Xa.forEach(t.mutations,r=>{const i=new Qu(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){const n=new Qu(t,0),r=this.br.firstAfterOrEqual(n);return Xa.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Xa.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Xu{constructor(e){this.Mr=e,this.docs=new ho(za.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Xa.resolve(n?n.document.mutableCopy():Qo.newInvalidDocument(t))}getEntries(e,t){let n=zl();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Qo.newInvalidDocument(e))}),Xa.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=zl();const s=t.path,a=new za(s.child("")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Ka(Ha(a),n)<=0||(r.has(a.key)||Ll(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return Xa.resolve(i)}getAllFromCollectionGroup(e,t,n,r){ya()}Or(e,t){return Xa.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Ju(this)}getSize(e){return Xa.resolve(this.size)}}class Ju extends zu{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)}),Xa.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class Zu{constructor(e){this.persistence=e,this.Nr=new Vl(e=>wl(e),xl),this.lastRemoteSnapshotVersion=Ma.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Gu,this.targetCount=0,this.kr=Bu.Bn()}forEachTarget(e,t){return this.Nr.forEach((e,n)=>t(n)),Xa.resolve()}getLastRemoteSnapshotVersion(e){return Xa.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Xa.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Xa.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),Xa.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Bu(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Xa.resolve()}updateTargetData(e,t){return this.Kn(t),Xa.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Xa.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Nr.forEach((s,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.Nr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),Xa.waitFor(i).next(()=>r)}getTargetCount(e){return Xa.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return Xa.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),Xa.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),Xa.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Xa.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return Xa.resolve(n)}containsKey(e,t){return Xa.resolve(this.Br.containsKey(t))}}class ed{constructor(e,t){this.qr={},this.overlays={},this.Qr=new eo(0),this.Kr=!1,this.Kr=!0,this.$r=new Ku,this.referenceDelegate=e(this),this.Ur=new Zu(this),this.indexManager=new Fu,this.remoteDocumentCache=function(e){return new Xu(e)}(e=>this.referenceDelegate.Wr(e)),this.serializer=new Ou(t),this.Gr=new Hu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Wu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new Yu(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){pa("MemoryPersistence","Starting transaction:",e);const r=new td(this.Qr.next());return this.referenceDelegate.zr(),n(r).next(e=>this.referenceDelegate.jr(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Hr(e,t){return Xa.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}}class td extends Qa{constructor(e){super(),this.currentSequenceNumber=e}}class nd{constructor(e){this.persistence=e,this.Jr=new Gu,this.Yr=null}static Zr(e){return new nd(e)}get Xr(){if(this.Yr)return this.Yr;throw ya()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),Xa.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),Xa.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Xa.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(e=>this.Xr.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Xr.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Xa.forEach(this.Xr,n=>{const r=za.fromPath(n);return this.ei(e,r).next(e=>{e||t.removeEntry(r,Ma.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return Xa.or([()=>Xa.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class rd{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=Xl(),r=Xl();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new rd(e,t.fromCache,n,r)}}class id{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class sd{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=Ke()?8:Ja(We())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Yi(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.Zi(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new id;return this.Xi(e,t,n).next(r=>{if(i.result=r,this.zi)return this.es(e,t,n,r.size)})}).next(()=>i.result)}es(e,t,n,r){return n.documentReadCount<this.ji?(fa()<=dt.DEBUG&&pa("QueryEngine","SDK will not create cache indexes for query:",Ol(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Xa.resolve()):(fa()<=dt.DEBUG&&pa("QueryEngine","Query:",Ol(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?(fa()<=dt.DEBUG&&pa("QueryEngine","The SDK decides to create cache indexes for query:",Ol(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Il(t))):Xa.resolve())}Yi(e,t){if(Sl(t))return Xa.resolve(null);let n=Il(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Rl(t,null,"F"),n=Il(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=Xl(...r);return this.Ji.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.ts(t,r);return this.ns(t,s,i,n.readTime)?this.Yi(e,Rl(t,null,"F")):this.rs(e,s,t,n)}))})))}Zi(e,t,n,r){return Sl(t)||r.isEqual(Ma.min())?Xa.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const s=this.ts(t,i);return this.ns(t,s,n,r)?Xa.resolve(null):(fa()<=dt.DEBUG&&pa("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ol(t)),this.rs(e,s,t,qa(r,-1)).next(e=>e))})}ts(e,t){let n=new mo(Fl(e));return t.forEach((t,r)=>{Ll(e,r)&&(n=n.add(r))}),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,n){return fa()<=dt.DEBUG&&pa("QueryEngine","Using full collection scan to execute query:",Ol(t)),this.Ji.getDocumentsMatchingQuery(e,t,Wa.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class ad{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new ho(Pa),this._s=new Vl(e=>wl(e),xl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qu(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function od(e,t,n,r){return new ad(e,t,n,r)}async function ld(e,t){const n=wa(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.ls(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let a=Xl();for(const e of r){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next(e=>({hs:e,removedBatchIds:i,addedBatchIds:s}))})})}function cd(e){const t=wa(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function ud(e,t,n){let r=Xl(),i=Xl();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=zl();return n.forEach((n,s)=>{const a=e.get(n);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(Ma.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):pa("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),{Ps:r,Is:i}})}function dd(e,t){const n=wa(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function hd(e,t){const n=wa(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Ur.getTargetData(e,t).next(i=>i?(r=i,Xa.resolve(r)):n.Ur.allocateTargetId(e).next(i=>(r=new Pu(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e})}async function fd(e,t,n){const r=wa(e),i=r.os.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!Za(e))throw e;pa("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.os=r.os.remove(t),r._s.delete(i.target)}function pd(e,t,n){const r=wa(e);let i=Ma.min(),s=Xl();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=wa(e),i=r._s.get(n);return void 0!==i?Xa.resolve(r.os.get(i)):r.Ur.getTargetData(t,n)}(r,e,Il(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.ss.getDocumentsMatchingQuery(e,t,n?i:Ma.min(),n?s:Xl())).next(e=>(md(r,Ml(t),e),{documents:e,Ts:s})))}function md(e,t,n){let r=e.us.get(t)||Ma.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.us.set(t,r)}class gd{constructor(){this.activeTargetIds=Zl()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vd{constructor(){this.so=new gd,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new gd,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class yd{_o(e){}shutdown(){}}class bd{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){pa("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){pa("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let wd=null;function xd(){return null===wd?wd=268435456+Math.round(2147483648*Math.random()):wd++,"0x"+wd.toString(16)}const _d={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Nd{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Ed="WebChannelConnection";class kd extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo=`projects/${n}/databases/${r}`,this.Co="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get Fo(){return!1}Mo(e,t,n,r,i){const s=xd(),a=this.xo(e,t.toUriEncodedString());pa("RestConnection",`Sending RPC '${e}' ${s}:`,a,n);const o={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(o,r,i),this.No(e,a,o,n).then(t=>(pa("RestConnection",`Received RPC '${e}' ${s}: `,t),t),t=>{throw ga("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",a,"request:",n),t})}Lo(e,t,n,r,i,s){return this.Mo(e,t,n,r,i)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+da,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}xo(e,t){const n=_d[e];return`${this.Do}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const i=xd();return new Promise((s,a)=>{const o=new Zs;o.setWithCredentials(!0),o.listenOnce(ta.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case na.NO_ERROR:const t=o.getResponseJson();pa(Ed,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case na.TIMEOUT:pa(Ed,`RPC '${e}' ${i} timed out`),a(new _a(xa.DEADLINE_EXCEEDED,"Request time out"));break;case na.HTTP_ERROR:const n=o.getStatus();if(pa(Ed,`RPC '${e}' ${i} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(xa).indexOf(t)>=0?t:xa.UNKNOWN}(t.status);a(new _a(e,t.message))}else a(new _a(xa.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new _a(xa.UNAVAILABLE,"Connection failed."));break;default:ya()}}finally{pa(Ed,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(r);pa(Ed,`RPC '${e}' ${i} sending request:`,r),o.send(t,"POST",l,n,15)})}Bo(e,t,n){const r=xd(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=aa(),a=sa(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Oo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=i.join("");pa(Ed,`Creating RPC '${e}' stream ${r}: ${c}`,o);const u=s.createWebChannel(c,o);let d=!1,h=!1;const f=new Nd({Io:t=>{h?pa(Ed,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(pa(Ed,`Opening RPC '${e}' stream ${r} transport.`),u.open(),d=!0),pa(Ed,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},To:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,ea.EventType.OPEN,()=>{h||(pa(Ed,`RPC '${e}' stream ${r} transport opened.`),f.yo())}),p(u,ea.EventType.CLOSE,()=>{h||(h=!0,pa(Ed,`RPC '${e}' stream ${r} transport closed`),f.So())}),p(u,ea.EventType.ERROR,t=>{h||(h=!0,ga(Ed,`RPC '${e}' stream ${r} transport errored:`,t),f.So(new _a(xa.UNAVAILABLE,"The operation could not be completed")))}),p(u,ea.EventType.MESSAGE,t=>{var n;if(!h){const i=t.data[0];ba(!!i);const s=i,a=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(a){pa(Ed,`RPC '${e}' stream ${r} received error:`,a);const t=a.status;let n=function(e){const t=Lc[e];if(void 0!==t)return Uc(t)}(t),i=a.message;void 0===n&&(n=xa.INTERNAL,i="Unknown error status: "+t+" with message "+a.message),h=!0,f.So(new _a(n,i)),u.close()}else pa(Ed,`RPC '${e}' stream ${r} received:`,i),f.bo(i)}}),p(a,ia.STAT_EVENT,t=>{t.stat===ra.PROXY?pa(Ed,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===ra.NOPROXY&&pa(Ed,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.wo()},0),f}}function Sd(){return"undefined"!=typeof document?document:null}function Cd(e){return new su(e,!0)}class jd{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&pa("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class Id{constructor(e,t,n,r,i,s,a,o){this.ui=e,this.Ho=n,this.Jo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new jd(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===xa.RESOURCE_EXHAUSTED?(ma(t.toString()),ma("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===xa.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.Yo===t&&this.P_(n,r)},t=>{e(()=>{const e=new _a(xa.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)})})}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(e=>{n(()=>this.I_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.e_?this.E_(e):this.onNext(e))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return pa("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(pa("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Td extends Id{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:ya()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(ba(void 0===t||"string"==typeof t),bo.fromBase64String(t||"")):(ba(void 0===t||t instanceof Buffer||t instanceof Uint8Array),bo.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(e){const t=void 0===e.code?xa.UNKNOWN:Uc(e.code);return new _a(t,e.message||"")}(a);n=new Xc(r,i,s,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=mu(e,r.document.name),s=uu(r.document.updateTime),a=r.document.createTime?uu(r.document.createTime):Ma.min(),o=new Ko({mapValue:{fields:r.document.fields}}),l=Qo.newFoundDocument(i,s,a,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Qc(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=mu(e,r.document),s=r.readTime?uu(r.readTime):Ma.min(),a=Qo.newNoDocument(i,s),o=r.removedTargetIds||[];n=new Qc([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=mu(e,r.document),s=r.removedTargetIds||[];n=new Qc([],s,i,null)}else{if(!("filter"in t))return ya();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Oc(r,i),a=e.targetId;n=new Yc(a,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Ma.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Ma.min():t.readTime?uu(t.readTime):Ma.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=yu(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=_l(r)?{documents:_u(e,r)}:{query:Nu(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=lu(e,t.resumeToken);const r=au(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Ma.min())>0){n.readTime=ou(e,t.snapshotVersion.toTimestamp());const r=au(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ya()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=yu(this.serializer),t.removeTarget=e,this.a_(t)}}class Ad extends Id{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ba(!!e.streamToken),this.lastStreamToken=e.streamToken,ba(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){ba(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(ba(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?uu(e.updateTime):uu(t);return n.isEqual(Ma.min())&&(n=uu(t)),new gc(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=uu(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=yu(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>xu(this.serializer,e))};this.a_(t)}}class Rd extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new _a(xa.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,a]=i;return this.connection.Mo(e,hu(t,n),r,s,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===xa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new _a(xa.UNKNOWN,e.toString())})}Lo(e,t,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[a,o]=s;return this.connection.Lo(e,hu(t,n),r,a,o,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===xa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new _a(xa.UNKNOWN,e.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Dd{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ma(t),this.D_=!1):pa("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class Pd{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(e=>{n.enqueueAndForget(async()=>{$d(this)&&(pa("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=wa(e);t.L_.add(4),await Ld(t),t.q_.set("Unknown"),t.L_.delete(4),await Od(t)}(this))})}),this.q_=new Dd(n,r)}}async function Od(e){if($d(e))for(const t of e.B_)await t(!0)}async function Ld(e){for(const t of e.B_)await t(!1)}function Md(e,t){const n=wa(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),zd(n)?Bd(n):lh(n).r_()&&Ud(n,t))}function Fd(e,t){const n=wa(e),r=lh(n);n.N_.delete(t),r.r_()&&Vd(n,t),0===n.N_.size&&(r.r_()?r.o_():$d(n)&&n.q_.set("Unknown"))}function Ud(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ma.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}lh(e).A_(t)}function Vd(e,t){e.Q_.xe(t),lh(e).R_(t)}function Bd(e){e.Q_=new Zc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),lh(e).start(),e.q_.v_()}function zd(e){return $d(e)&&!lh(e).n_()&&e.N_.size>0}function $d(e){return 0===wa(e).L_.size}function qd(e){e.Q_=void 0}async function Hd(e){e.q_.set("Online")}async function Wd(e){e.N_.forEach((t,n)=>{Ud(e,t)})}async function Kd(e,t){qd(e),zd(e)?(e.q_.M_(t),Bd(e)):e.q_.set("Unknown")}async function Gd(e,t,n){if(e.q_.set("Online"),t instanceof Xc&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(n){pa("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Qd(e,n)}else if(t instanceof Qc?e.Q_.Ke(t):t instanceof Yc?e.Q_.He(t):e.Q_.We(t),!n.isEqual(Ma.min()))try{const t=await cd(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.N_.get(r);i&&e.N_.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(bo.EMPTY_BYTE_STRING,r.snapshotVersion)),Vd(e,t);const i=new Pu(r.target,t,n,r.sequenceNumber);Ud(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){pa("RemoteStore","Failed to raise snapshot:",t),await Qd(e,t)}}async function Qd(e,t,n){if(!Za(t))throw t;e.L_.add(1),await Ld(e),e.q_.set("Offline"),n||(n=()=>cd(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{pa("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await Od(e)})}function Yd(e,t){return t().catch(n=>Qd(e,n,t))}async function Xd(e){const t=wa(e),n=ch(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;Jd(t);)try{const e=await dd(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,Zd(t,e)}catch(e){await Qd(t,e)}eh(t)&&th(t)}function Jd(e){return $d(e)&&e.O_.length<10}function Zd(e,t){e.O_.push(t);const n=ch(e);n.r_()&&n.V_&&n.m_(t.mutations)}function eh(e){return $d(e)&&!ch(e).n_()&&e.O_.length>0}function th(e){ch(e).start()}async function nh(e){ch(e).p_()}async function rh(e){const t=ch(e);for(const n of e.O_)t.m_(n.mutations)}async function ih(e,t,n){const r=e.O_.shift(),i=Dc.from(r,t,n);await Yd(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Xd(e)}async function sh(e,t){t&&ch(e).V_&&await async function(e,t){if(function(e){return Fc(e)&&e!==xa.ABORTED}(t.code)){const n=e.O_.shift();ch(e).s_(),await Yd(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Xd(e)}}(e,t),eh(e)&&th(e)}async function ah(e,t){const n=wa(e);n.asyncQueue.verifyOperationInProgress(),pa("RemoteStore","RemoteStore received new credentials");const r=$d(n);n.L_.add(3),await Ld(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await Od(n)}async function oh(e,t){const n=wa(e);t?(n.L_.delete(2),await Od(n)):t||(n.L_.add(2),await Ld(n),n.q_.set("Unknown"))}function lh(e){return e.K_||(e.K_=function(e,t,n){const r=wa(e);return r.w_(),new Td(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:Hd.bind(null,e),Ro:Wd.bind(null,e),mo:Kd.bind(null,e),d_:Gd.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),zd(e)?Bd(e):e.q_.set("Unknown")):(await e.K_.stop(),qd(e))})),e.K_}function ch(e){return e.U_||(e.U_=function(e,t,n){const r=wa(e);return r.w_(),new Ad(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:nh.bind(null,e),mo:sh.bind(null,e),f_:rh.bind(null,e),g_:ih.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await Xd(e)):(await e.U_.stop(),e.O_.length>0&&(pa("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))})),e.U_}class uh{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Na,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,a=new uh(e,t,s,r,i);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new _a(xa.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dh(e,t){if(ma("AsyncQueue",`${t}: ${e}`),Za(e))return new _a(xa.UNAVAILABLE,`${t}: ${e}`);throw e}class hh{constructor(e){this.comparator=e?(t,n)=>e(t,n)||za.comparator(t.key,n.key):(e,t)=>za.comparator(e.key,t.key),this.keyedMap=ql(),this.sortedSet=new ho(this.comparator)}static emptySet(e){return new hh(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof hh))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new hh;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class fh{constructor(){this.W_=new ho(za.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):ya():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}}class ph{constructor(e,t,n,r,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new ph(e,t,hh.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Dl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class mh{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class gh{constructor(){this.queries=vh(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=wa(e),r=n.queries;n.queries=vh(),r.forEach((e,n)=>{for(const r of n.j_)r.onError(t)})}(this,new _a(xa.ABORTED,"Firestore shutting down"))}}function vh(){return new Vl(e=>Pl(e),Dl)}async function yh(e,t){const n=wa(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.H_()&&t.J_()&&(r=2):(s=new mh,r=t.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=dh(e,`Initialization of query '${Ol(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.j_.push(t),t.Z_(n.onlineState),s.z_&&t.X_(s.z_)&&_h(n)}async function bh(e,t){const n=wa(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.j_.indexOf(t);e>=0&&(s.j_.splice(e,1),0===s.j_.length?i=t.J_()?0:1:!s.H_()&&t.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function wh(e,t){const n=wa(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(i)&&(r=!0);t.z_=i}}r&&_h(n)}function xh(e,t,n){const r=wa(e),i=r.queries.get(t);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(t)}function _h(e){e.Y_.forEach(e=>{e.next()})}var Nh,Eh;(Eh=Nh||(Nh={})).ea="default",Eh.Cache="cache";class kh{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new ph(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=ph.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Nh.Cache}}class Sh{constructor(e){this.key=e}}class Ch{constructor(e){this.key=e}}class jh{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Xl(),this.mutatedKeys=Xl(),this.Aa=Fl(e),this.Ra=new hh(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new fh,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=Ll(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.ga(c,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.Aa(u,o)>0||l&&this.Aa(u,l)<0)&&(a=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(o||l)&&(a=!0)),f&&(u?(s=s.add(u),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ra:s,fa:n,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ya()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc)),this.pa(n),r=null!=r&&r;const a=t&&!r?this.ya():[],o=0===this.da.size&&this.current&&!r?1:0,l=o!==this.Ea;return this.Ea=o,0!==s.length||l?{snapshot:new ph(this.query,e.Ra,i,s,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new fh,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Xl(),this.Ra.forEach(e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))});const t=[];return e.forEach(e=>{this.da.has(e)||t.push(new Ch(e))}),this.da.forEach(n=>{e.has(n)||t.push(new Sh(n))}),t}ba(e){this.Ta=e.Ts,this.da=Xl();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ph.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class Ih{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Th{constructor(e){this.key=e,this.va=!1}}class Ah{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new Vl(e=>Pl(e),Dl),this.Ma=new Map,this.xa=new Set,this.Oa=new ho(za.comparator),this.Na=new Map,this.La=new Gu,this.Ba={},this.ka=new Map,this.qa=Bu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function Rh(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Zh(e);let i;const s=r.Fa.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Ph(r,t,n,!0),i}async function Dh(e,t){const n=Zh(e);await Ph(n,t,!0,!1)}async function Ph(e,t,n,r){const i=await hd(e.localStore,Il(t)),s=i.targetId,a=e.sharedClientState.addLocalQueryTarget(s,n);let o;return r&&(o=await Oh(e,t,s,"current"===a,i.resumeToken)),e.isPrimaryClient&&n&&Md(e.remoteStore,i),o}async function Oh(e,t,n,r,i){e.Ka=(t,n,r)=>async function(e,t,n,r){let i=t.view.ma(n);i.ns&&(i=await pd(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ma(n,i)}));const s=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return Kh(e,t.targetId,o.wa),o.snapshot}(e,t,n,r);const s=await pd(e.localStore,t,!0),a=new jh(t,s.Ts),o=a.ma(s.documents),l=Gc.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=a.applyChanges(o,e.isPrimaryClient,l);Kh(e,n,c.wa);const u=new Ih(t,n,a);return e.Fa.set(t,u),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function Lh(e,t,n){const r=wa(e),i=r.Fa.get(t),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(e=>!Dl(e,t))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await fd(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Fd(r.remoteStore,i.targetId),Hh(r,i.targetId)}).catch(Ya)):(Hh(r,i.targetId),await fd(r.localStore,i.targetId,!0))}async function Mh(e,t){const n=wa(e),r=n.Fa.get(t),i=n.Ma.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Fd(n.remoteStore,r.targetId))}async function Fh(e,t){const n=wa(e);try{const e=await function(e,t){const n=wa(e),r=t.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];t.targetChanges.forEach((s,o)=>{const l=i.get(o);if(!l)return;a.push(n.Ur.removeMatchingKeys(e,s.removedDocuments,o).next(()=>n.Ur.addMatchingKeys(e,s.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(bo.EMPTY_BYTE_STRING,Ma.min()).withLastLimboFreeSnapshotVersion(Ma.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&a.push(n.Ur.updateTargetData(e,c))});let o=zl(),l=Xl();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(ud(e,s,t.documentUpdates).next(e=>{o=e.Ps,l=e.Is})),!r.isEqual(Ma.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next(t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r));a.push(t)}return Xa.waitFor(a).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.os=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Na.get(t);r&&(ba(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?ba(r.va):e.removedDocuments.size>0&&(ba(r.va),r.va=!1))}),await Yh(n,e,t)}catch(e){await Ya(e)}}function Uh(e,t,n){const r=wa(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach((n,r)=>{const i=r.view.Z_(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=wa(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.j_)i.Z_(t)&&(r=!0)}),r&&_h(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Vh(e,t,n){const r=wa(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Na.get(t),s=i&&i.key;if(s){let e=new ho(za.comparator);e=e.insert(s,Qo.newNoDocument(s,Ma.min()));const n=Xl().add(s),i=new Kc(Ma.min(),new Map,new ho(Pa),e,n);await Fh(r,i),r.Oa=r.Oa.remove(s),r.Na.delete(t),Qh(r)}else await fd(r.localStore,t,!1).then(()=>Hh(r,t,n)).catch(Ya)}async function Bh(e,t){const n=wa(e),r=t.batch.batchId;try{const e=await function(e,t){const n=wa(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let a=Xa.resolve();return s.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);ba(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Xl();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);qh(n,r,null),$h(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Yh(n,e)}catch(e){await Ya(e)}}async function zh(e,t,n){const r=wa(e);try{const e=await function(e,t){const n=wa(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(ba(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);qh(r,t,n),$h(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Yh(r,e)}catch(n){await Ya(n)}}function $h(e,t){(e.ka.get(t)||[]).forEach(e=>{e.resolve()}),e.ka.delete(t)}function qh(e,t,n){const r=wa(e);let i=r.Ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function Hh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(t=>{e.La.containsKey(t)||Wh(e,t)})}function Wh(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(Fd(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),Qh(e))}function Kh(e,t,n){for(const r of n)r instanceof Sh?(e.La.addReference(r.key,t),Gh(e,r)):r instanceof Ch?(pa("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||Wh(e,r.key)):ya()}function Gh(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||(pa("SyncEngine","New document in limbo: "+n),e.xa.add(r),Qh(e))}function Qh(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new za(Ua.fromString(t)),r=e.qa.next();e.Na.set(r,new Th(n)),e.Oa=e.Oa.insert(n,r),Md(e.remoteStore,new Pu(Il(kl(n.path)),r,"TargetPurposeLimboResolution",eo.oe))}}async function Yh(e,t,n){const r=wa(e),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((e,o)=>{a.push(r.Ka(o,t,n).then(e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);const t=rd.Wi(o.targetId,e);s.push(t)}}))}),await Promise.all(a),r.Ca.d_(i),await async function(e,t){const n=wa(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Xa.forEach(t,t=>Xa.forEach(t.$i,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Xa.forEach(t.Ui,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!Za(e))throw e;pa("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.os.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,i)}}}(r.localStore,s))}async function Xh(e,t){const n=wa(e);if(!n.currentUser.isEqual(t)){pa("SyncEngine","User change. New user:",t.toKey());const e=await ld(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach(e=>{e.forEach(e=>{e.reject(new _a(xa.CANCELLED,t))})}),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Yh(n,e.hs)}}function Jh(e,t){const n=wa(e),r=n.Na.get(t);if(r&&r.va)return Xl().add(r.key);{let e=Xl();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}function Zh(e){const t=wa(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Fh.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Jh.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Vh.bind(null,t),t.Ca.d_=wh.bind(null,t.eventManager),t.Ca.$a=xh.bind(null,t.eventManager),t}function ef(e){const t=wa(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Bh.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=zh.bind(null,t),t}class tf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return od(this.persistence,new sd,e.initialUser,this.serializer)}Ga(e){return new ed(nd.Zr,this.serializer)}Wa(e){return new vd}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}tf.provider={build:()=>new tf};class nf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Uh(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Xh.bind(null,this.syncEngine),await oh(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new gh}createDatastore(e){const t=Cd(e.databaseInfo.databaseId),n=function(e){return new kd(e)}(e.databaseInfo);return function(e,t,n,r){return new Rd(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Pd(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>Uh(this.syncEngine,e,0),bd.D()?new bd:new yd)}createSyncEngine(e,t){return function(e,t,n,r,i,s,a){const o=new Ah(e,t,n,r,i,s);return a&&(o.Qa=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=wa(e);pa("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await Ld(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}nf.provider={build:()=>new nf};class rf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ma("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class sf{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=ua.UNAUTHENTICATED,this.clientId=Da.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{pa("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(pa("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Na;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=dh(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function af(e,t){e.asyncQueue.verifyOperationInProgress(),pa("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await ld(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function of(e,t){e.asyncQueue.verifyOperationInProgress();const n=await lf(e);pa("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>ah(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>ah(t.remoteStore,n)),e._onlineComponents=t}async function lf(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){pa("FirestoreClient","Using user provided OfflineComponentProvider");try{await af(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===xa.FAILED_PRECONDITION||e.code===xa.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;ga("Error using user provided cache. Falling back to memory cache: "+n),await af(e,new tf)}}else pa("FirestoreClient","Using default OfflineComponentProvider"),await af(e,new tf);return e._offlineComponents}async function cf(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(pa("FirestoreClient","Using user provided OnlineComponentProvider"),await of(e,e._uninitializedComponentsProvider._online)):(pa("FirestoreClient","Using default OnlineComponentProvider"),await of(e,new nf))),e._onlineComponents}function uf(e){return cf(e).then(e=>e.syncEngine)}async function df(e){const t=await cf(e),n=t.eventManager;return n.onListen=Rh.bind(null,t.syncEngine),n.onUnlisten=Lh.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Dh.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Mh.bind(null,t.syncEngine),n}function hf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Na;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new rf({next:o=>{s.Za(),t.enqueueAndForget(()=>bh(e,a));const l=o.docs.has(n);!l&&o.fromCache?i.reject(new _a(xa.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?i.reject(new _a(xa.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:e=>i.reject(e)}),a=new kh(kl(n.path),s,{includeMetadataChanges:!0,_a:!0});return yh(e,a)}(await df(e),e.asyncQueue,t,n,r)),r.promise}function ff(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Na;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new rf({next:n=>{s.Za(),t.enqueueAndForget(()=>bh(e,a)),n.fromCache&&"server"===r.source?i.reject(new _a(xa.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),a=new kh(n,s,{includeMetadataChanges:!0,_a:!0});return yh(e,a)}(await df(e),e.asyncQueue,t,n,r)),r.promise}function pf(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const mf=new Map;function gf(e,t,n){if(!n)throw new _a(xa.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function vf(e){if(!za.isDocumentKey(e))throw new _a(xa.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function yf(e){if(za.isDocumentKey(e))throw new _a(xa.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function bf(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":ya()}function wf(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new _a(xa.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bf(e);throw new _a(xa.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function xf(e,t){if(t<=0)throw new _a(xa.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class _f{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new _a(xa.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new _a(xa.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new _a(xa.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pf(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new _a(xa.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new _a(xa.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new _a(xa.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Nf{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _f({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new _a(xa.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new _a(xa.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _f(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new ka;switch(e.type){case"firstParty":return new Ia(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new _a(xa.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=mf.get(e);t&&(pa("ComponentProvider","Removing Datastore"),mf.delete(e),t.terminate())}(this),Promise.resolve()}}class Ef{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ef(this.firestore,e,this._query)}}class kf{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Sf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kf(this.firestore,e,this._key)}}class Sf extends Ef{constructor(e,t,n){super(e,t,kl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kf(this.firestore,null,new za(e))}withConverter(e){return new Sf(this.firestore,e,this._path)}}function Cf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=st(e),gf("collection","path",t),e instanceof Nf){const n=Ua.fromString(t,...r);return yf(n),new Sf(e,null,n)}{if(!(e instanceof kf||e instanceof Sf))throw new _a(xa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ua.fromString(t,...r));return yf(n),new Sf(e.firestore,null,n)}}function jf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=st(e),1===arguments.length&&(t=Da.newId()),gf("doc","path",t),e instanceof Nf){const n=Ua.fromString(t,...r);return vf(n),new kf(e,null,new za(n))}{if(!(e instanceof kf||e instanceof Sf))throw new _a(xa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ua.fromString(t,...r));return vf(n),new kf(e.firestore,e instanceof Sf?e.converter:null,new za(n))}}class If{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new jd(this,"async_queue_retry"),this.Vu=()=>{const e=Sd();e&&pa("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=Sd();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Sd();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Na;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(Bw){if(!Za(Bw))throw Bw;pa("AsyncQueue","Operation failed with retryable error: "+Bw)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw ma("INTERNAL UNHANDLED ERROR: ",t),e}).then(e=>(this.du=!1,e))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=uh.createAndSchedule(this,e,t,n,e=>this.yu(e));return this.Tu.push(r),r}fu(){this.Eu&&ya()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function Tf(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Af extends Nf{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new If,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new If(e),this._firestoreClient=void 0,await e}}}function Rf(e){if(e._terminated)throw new _a(xa.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Df(e),e._firestoreClient}function Df(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new Co(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,pf(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new sf(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class Pf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pf(bo.fromBase64String(e))}catch(e){throw new _a(xa.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Pf(bo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Of{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new _a(xa.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ba(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Lf{constructor(e){this._methodName=e}}class Mf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new _a(xa.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new _a(xa.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Pa(this._lat,e._lat)||Pa(this._long,e._long)}}class Ff{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Uf=/^__.*__$/;class Vf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Sc(e,this.data,this.fieldMask,t,this.fieldTransforms):new kc(e,this.data,t,this.fieldTransforms)}}class Bf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Sc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function zf(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ya()}}class $f{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new $f(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return sp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(zf(this.Cu)&&Uf.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class qf{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Cd(e)}Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new $f({Cu:e,methodName:t,qu:n,path:Ba.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hf(e){const t=e._freezeSettings(),n=Cd(e._databaseId);return new qf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Wf(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=e.Qu(s.merge||s.mergeFields?2:0,t,n,i);tp("Data must be an object, but it was:",a,r);const o=Zf(r,a);let l,c;if(s.merge)l=new vo(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=np(t,r,n);if(!a.contains(i))throw new _a(xa.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);ap(e,i)||e.push(i)}l=new vo(e),c=a.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=a.fieldTransforms;return new Vf(new Ko(o),l,c)}class Kf extends Lf{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Kf}}class Gf extends Lf{_toFieldTransform(e){return new mc(e.path,new oc)}isEqual(e){return e instanceof Gf}}function Qf(e,t,n,r){const i=e.Qu(1,t,n);tp("Data must be an object, but it was:",i,r);const s=[],a=Ko.empty();co(r,(e,r)=>{const o=ip(t,e,n);r=st(r);const l=i.Nu(o);if(r instanceof Kf)s.push(o);else{const e=Jf(r,l);null!=e&&(s.push(o),a.set(o,e))}});const o=new vo(s);return new Bf(a,o,i.fieldTransforms)}function Yf(e,t,n,r,i,s){const a=e.Qu(1,t,n),o=[np(t,r,n)],l=[i];if(s.length%2!=0)throw new _a(xa.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)o.push(np(t,s[h])),l.push(s[h+1]);const c=[],u=Ko.empty();for(let h=o.length-1;h>=0;--h)if(!ap(c,o[h])){const e=o[h];let t=l[h];t=st(t);const n=a.Nu(e);if(t instanceof Kf)c.push(e);else{const r=Jf(t,n);null!=r&&(c.push(e),u.set(e,r))}}const d=new vo(c);return new Bf(u,d,a.fieldTransforms)}function Xf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Jf(n,e.Qu(r?4:3,t))}function Jf(e,t){if(ep(e=st(e)))return tp("Unsupported field value:",t,e),Zf(e,t);if(e instanceof Lf)return function(e,t){if(!zf(t.Cu))throw t.Bu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Bu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Jf(i,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=st(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return nc(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=La.fromDate(e);return{timestampValue:ou(t.serializer,n)}}if(e instanceof La){const n=new La(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ou(t.serializer,n)}}if(e instanceof Mf)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Pf)return{bytesValue:lu(t.serializer,e._byteString)};if(e instanceof kf){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:du(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Ff)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return ec(t.serializer,e)})}}}}}}(e,t);throw t.Bu(`Unsupported field value: ${bf(e)}`)}(e,t)}function Zf(e,t){const n={};return uo(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):co(e,(e,r)=>{const i=Jf(r,t.Mu(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function ep(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof La||e instanceof Mf||e instanceof Pf||e instanceof kf||e instanceof Lf||e instanceof Ff)}function tp(e,t,n){if(!ep(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=bf(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}}function np(e,t,n){if((t=st(t))instanceof Of)return t._internalPath;if("string"==typeof t)return ip(e,t);throw sp("Field path arguments must be of type string or ",e,!1,void 0,n)}const rp=new RegExp("[~\\*/\\[\\]]");function ip(e,t,n){if(t.search(rp)>=0)throw sp(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Of(...t.split("."))._internalPath}catch(r){throw sp(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function sp(e,t,n,r,i){const s=r&&!r.isEmpty(),a=void 0!==i;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new _a(xa.INVALID_ARGUMENT,o+e+l)}function ap(e,t){return e.some(e=>e.isEqual(t))}class op{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new kf(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new lp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(cp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class lp extends op{data(){return super.data()}}function cp(e,t){return"string"==typeof t?ip(e,t):t instanceof Of?t._internalPath:t._delegate._internalPath}function up(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new _a(xa.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dp{}class hp extends dp{}function fp(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof dp&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof gp).length,n=e.filter(e=>e instanceof pp).length;if(t>1||t>0&&n>0)throw new _a(xa.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)e=a._apply(e);return e}class pp extends hp{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new pp(e,t,n)}_apply(e){const t=this._parse(e);return _p(e._query,t),new Ef(e.firestore,e.converter,Al(e._query,t))}_parse(e){const t=Hf(e.firestore),n=function(e,t,n,r,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new _a(xa.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){xp(a,s);const t=[];for(const n of a)t.push(wp(r,e,n));o={arrayValue:{values:t}}}else o=wp(r,e,a)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||xp(a,s),o=Xf(n,t,a,"in"===s||"not-in"===s);return nl.create(i,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function mp(e,t,n){const r=t,i=cp("where",e);return pp._create(i,r,n)}class gp extends dp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new gp(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:rl.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)_p(n,i),n=Al(n,i)}(e._query,t),new Ef(e.firestore,e.converter,Al(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class vp extends hp{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new vp(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new _a(xa.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new _a(xa.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zo(t,n)}(e._query,this._field,this._direction);return new Ef(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Nl(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function yp(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=cp("orderBy",e);return vp._create(n,t)}class bp extends hp{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new bp(e,t,n)}_apply(e){return new Ef(e.firestore,e.converter,Rl(e._query,this._limit,this._limitType))}}function wp(e,t,n){if("string"==typeof(n=st(n))){if(""===n)throw new _a(xa.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Cl(t)&&-1!==n.indexOf("/"))throw new _a(xa.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Ua.fromString(n));if(!za.isDocumentKey(r))throw new _a(xa.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Fo(e,new za(r))}if(n instanceof kf)return Fo(e,n._key);throw new _a(xa.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bf(n)}.`)}function xp(e,t){if(!Array.isArray(e)||0===e.length)throw new _a(xa.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function _p(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new _a(xa.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new _a(xa.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Np{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(To(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _o(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(No(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ya()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return co(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>_o(e.doubleValue));return new Ff(i)}convertGeoPoint(e){return new Mf(_o(e.latitude),_o(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ko(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(So(e));default:return null}}convertTimestamp(e){const t=xo(e);return new La(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ua.fromString(e);ba(Du(n));const r=new jo(n.get(1),n.get(3)),i=new za(n.popFirst(5));return r.isEqual(t)||ma(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Ep(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class kp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Sp extends op{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Cp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(cp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Cp extends Sp{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class jp{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new kp(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Cp(this._firestore,this._userDataWriter,n.key,n,new kp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new _a(xa.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Cp(e._firestore,e._userDataWriter,n.doc.key,n.doc,new kp(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Cp(e._firestore,e._userDataWriter,t.doc.key,t.doc,new kp(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Ip(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Ip(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ya()}}function Tp(e){e=wf(e,kf);const t=wf(e.firestore,Af);return hf(Rf(t),e._key).then(n=>Up(t,e,n))}class Ap extends Np{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new kf(this.firestore,null,t)}}function Rp(e){e=wf(e,Ef);const t=wf(e.firestore,Af),n=Rf(t),r=new Ap(t);return up(e._query),ff(n,e._query).then(n=>new jp(t,r,e,n))}function Dp(e,t,n){e=wf(e,kf);const r=wf(e.firestore,Af),i=Ep(e.converter,t,n);return Fp(r,[Wf(Hf(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,vc.none())])}function Pp(e,t,n){e=wf(e,kf);const r=wf(e.firestore,Af),i=Hf(r);let s;for(var a=arguments.length,o=new Array(a>3?a-3:0),l=3;l<a;l++)o[l-3]=arguments[l];return s="string"==typeof(t=st(t))||t instanceof Of?Yf(i,"updateDoc",e._key,t,n,o):Qf(i,"updateDoc",e._key,t),Fp(r,[s.toMutation(e._key,vc.exists(!0))])}function Op(e){return Fp(wf(e.firestore,Af),[new Tc(e._key,vc.none())])}function Lp(e,t){const n=wf(e.firestore,Af),r=jf(e),i=Ep(e.converter,t);return Fp(n,[Wf(Hf(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,vc.exists(!1))]).then(()=>r)}function Mp(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,a;e=st(e);let o={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||Tf(n[l])||(o=n[l],l++);const c={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Tf(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(a=e.complete)||void 0===a?void 0:a.bind(e)}let u,d,h;if(e instanceof kf)d=wf(e.firestore,Af),h=kl(e._key.path),u={next:t=>{n[l]&&n[l](Up(d,e,t))},error:n[l+1],complete:n[l+2]};else{const t=wf(e,Ef);d=wf(t.firestore,Af),h=t._query;const r=new Ap(d);u={next:e=>{n[l]&&n[l](new jp(d,r,t,e))},error:n[l+1],complete:n[l+2]},up(e._query)}return function(e,t,n,r){const i=new rf(r),s=new kh(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>yh(await df(e),s)),()=>{i.Za(),e.asyncQueue.enqueueAndForget(async()=>bh(await df(e),s))}}(Rf(d),h,c,u)}function Fp(e,t){return function(e,t){const n=new Na;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=ef(e);try{const e=await function(e,t){const n=wa(e),r=La.now(),i=t.reduce((e,t)=>e.add(t.key),Xl());let s,a;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=zl(),l=Xl();return n.cs.getEntries(e,i).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(i=>{s=i;const a=[];for(const e of t){const t=Nc(e,s.get(e.key).overlayedDocument);null!=t&&a.push(new Sc(e.key,t,Go(t.value.mapValue),vc.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)}).next(t=>{a=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:a.batchId,changes:Hl(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new ho(Pa)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await Yh(r,e.changes),await Xd(r.remoteStore)}catch(e){const t=dh(e,"Failed to persist write");n.reject(t)}}(await uf(e),t,n)),n.promise}(Rf(e),t)}function Up(e,t,n){const r=n.docs.get(t._key),i=new Ap(e);return new Sp(e,i,t._key,r,new kp(n.hasPendingWrites,n.fromCache),t.converter)}function Vp(){return new Gf("serverTimestamp")}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){da=e}(xn),gn(new at("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),a=new Af(new Ca(e.getProvider("auth-internal")),new Aa(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new _a(xa.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jo(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),En(ca,"4.7.3",e),En(ca,"4.7.3","esm2017")}();const Bp="firebasestorage.googleapis.com",zp="storageBucket";class $p extends Qe{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(Wp(e),`Firebase Storage: ${t} (${Wp(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,$p.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Wp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var qp,Hp;function Wp(e){return"storage/"+e}function Kp(){return new $p(qp.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Gp(){return new $p(qp.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Qp(){return new $p(qp.CANCELED,"User canceled the upload/download.")}function Yp(){return new $p(qp.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Xp(e){return new $p(qp.INVALID_ARGUMENT,e)}function Jp(){return new $p(qp.APP_DELETED,"The Firebase app was deleted.")}function Zp(e,t){return new $p(qp.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function em(e){throw new $p(qp.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(qp||(qp={}));class tm{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=tm.makeFromUrl(e,t)}catch(Bw){return new tm(e,"")}if(""===n.path)return n;throw r=e,new $p(qp.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const a=t.replace(/[.]/g,"\\."),o=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${a}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${t===Bp?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let l=0;l<o.length;l++){const t=o[l],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let i=r[t.indices.path];i||(i=""),n=new tm(e,i),t.postModify(n);break}}if(null==n)throw function(e){return new $p(qp.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class nm{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function rm(e){return"string"===typeof e||e instanceof String}function im(e){return sm()&&e instanceof Blob}function sm(){return"undefined"!==typeof Blob}function am(e,t,n,r){if(r<t)throw Xp(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw Xp(`Invalid value for '${e}'. Expected ${n} or less.`)}function om(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function lm(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function cm(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Hp||(Hp={}));class um{constructor(e,t,n,r,i,s,a,o,l,c,u){let d=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=a,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new dm(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===Hp.NO_ERROR,i=n.getStatus();if(!t||cm(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Hp.ABORT;return void e(!1,new dm(!1,null,t))}const s=-1!==this.successCodes_.indexOf(i);e(!0,new dm(s,n))})},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(Bw){r(Bw)}else if(null!==i){const e=Kp();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?Jp():Qp())}else{r(Gp())}};this.canceled_?t(0,new dm(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=null,a=!1,o=0;function l(){return 2===o}let c=!1;function u(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function d(t){i=setTimeout(()=>{i=null,e(f,l())},t)}function h(){s&&clearTimeout(s)}function f(e){if(c)return void h();for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return h(),void u.call(null,e,...n);if(l()||a)return h(),void u.call(null,e,...n);let s;r<64&&(r*=2),1===o?(o=2,s=0):s=1e3*(r+Math.random()),d(s)}let p=!1;function m(e){p||(p=!0,h(),c||(null!==i?(e||(o=2),clearTimeout(i),d(0)):e||(o=1)))}return d(0),s=setTimeout(()=>{a=!0,m(!0)},n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class dm{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function hm(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function fm(){const e=hm();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){const t=new e;for(let e=0;e<n.length;e++)t.append(n[e]);return t.getBlob()}if(sm())return new Blob(n);throw new $p(qp.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function pm(e){if("undefined"===typeof atob)throw t="base-64",new $p(qp.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`);var t;return atob(e)}const mm="raw",gm="base64",vm="base64url",ym="data_url";class bm{constructor(e,t){this.data=e,this.contentType=t||null}}function wm(e,t){switch(e){case mm:return new bm(xm(t));case gm:case vm:return new bm(_m(e,t));case ym:return new bm(function(e){const t=new Nm(e);return t.base64?_m(gm,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(Bw){throw Zp(ym,"Malformed data URL.")}return xm(t)}(t.rest)}(t),new Nm(t).contentType)}throw Kp()}function xm(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r)){if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function _m(e,t){switch(e){case gm:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw Zp(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case vm:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw Zp(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=pm(t)}catch(Bw){if(Bw.message.includes("polyfill"))throw Bw;throw Zp(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class Nm{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw Zp(ym,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class Em{constructor(e,t){let n=0,r="";im(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(im(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new Em(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new Em(n,!0)}}static getBlob(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(sm()){const e=t.map(e=>e instanceof Em?e.data_:e);return new Em(fm.apply(null,e))}{const e=t.map(e=>rm(e)?wm(mm,e).data:e.data_);let n=0;e.forEach(e=>{n+=e.byteLength});const r=new Uint8Array(n);let i=0;return e.forEach(e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]}),new Em(r,!0)}}uploadData(){return this.data_}}function km(e){let t;try{t=JSON.parse(e)}catch(Bw){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function Sm(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function Cm(e,t){return t}class jm{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||Cm}}let Im=null;function Tm(){if(Im)return Im;const e=[];e.push(new jm("bucket")),e.push(new jm("generation")),e.push(new jm("metageneration")),e.push(new jm("name","fullPath",!0));const t=new jm("name");t.xform=function(e,t){return function(e){return!rm(e)||e.length<2?e:Sm(e)}(t)},e.push(t);const n=new jm("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new jm("timeCreated")),e.push(new jm("updated")),e.push(new jm("md5Hash",null,!0)),e.push(new jm("cacheControl",null,!0)),e.push(new jm("contentDisposition",null,!0)),e.push(new jm("contentEncoding",null,!0)),e.push(new jm("contentLanguage",null,!0)),e.push(new jm("contentType",null,!0)),e.push(new jm("metadata","customMetadata",!0)),Im=e,Im}function Am(e,t,n){const r={type:"file"},i=n.length;for(let s=0;s<i;s++){const e=n[s];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new tm(n,r);return t._makeStorageReference(i)}})}(r,e),r}function Rm(e,t,n){const r=km(t);if(null===r)return null;return Am(e,r,n)}function Dm(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}class Pm{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Om(e){if(!e)throw Kp()}function Lm(e,t){return function(n,r){const i=Rm(e,r,t);return Om(null!==i),i}}function Mm(e,t){return function(n,r){const i=Rm(e,r,t);return Om(null!==i),function(e,t,n,r){const i=km(t);if(null===i)return null;if(!rm(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const a=encodeURIComponent;return s.split(",").map(t=>{const i=e.bucket,s=e.fullPath;return om("/b/"+a(i)+"/o/"+a(s),n,r)+lm({alt:"media",token:t})})[0]}(i,r,e.host,e._protocol)}}function Fm(e){return function(t,n){let r;var i,s;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new $p(qp.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new $p(qp.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,r=new $p(qp.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new $p(qp.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function Um(e){const t=Fm(e);return function(n,r){let i=t(n,r);var s;return 404===n.getStatus()&&(s=e.path,i=new $p(qp.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function Vm(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function Bm(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};const o=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+o;const l=Vm(t,r,i),c="--"+o+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Dm(l,n)+"\r\n--"+o+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",u="\r\n--"+o+"--",d=Em.getBlob(c,r,u);if(null===d)throw Yp();const h={name:l.fullPath},f=om(s,e.host,e._protocol),p=e.maxUploadRetryTime,m=new Pm(f,"POST",Lm(e,n),p);return m.urlParams=h,m.headers=a,m.body=d.uploadData(),m.errorHandler=Fm(t),m}class zm{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Hp.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Hp.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Hp.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r){if(this.sent_)throw em("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw em("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw em("cannot .getStatus() before sending");try{return this.xhr_.status}catch(Bw){return-1}}getResponse(){if(!this.sent_)throw em("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw em("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class $m extends zm{initXhr(){this.xhr_.responseType="text"}}function qm(){return new $m}class Hm{constructor(e,t){this._service=e,this._location=t instanceof tm?t:tm.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Hm(e,t)}get root(){const e=new tm(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Sm(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new tm(this._location.bucket,e);return new Hm(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new $p(qp.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Wm(e,t,n){e._throwIfRoot("uploadBytes");const r=Bm(e.storage,e._location,Tm(),new Em(t,!0),n);return e.storage.makeRequestWithTokens(r,qm).then(t=>({metadata:t,ref:e}))}function Km(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=om(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new Pm(r,"GET",Mm(e,n),i);return s.errorHandler=Um(t),s}(e.storage,e._location,Tm());return e.storage.makeRequestWithTokens(t,qm).then(e=>{if(null===e)throw new $p(qp.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function Gm(e,t){const n=function(e,t){const n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new tm(e._location.bucket,n);return new Hm(e.storage,r)}function Qm(e,t){if(e instanceof Jm){const n=e;if(null==n._bucket)throw new $p(qp.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+zp+"' property when initializing the app?");const r=new Hm(n,n._bucket);return null!=t?Qm(r,t):r}return void 0!==t?Gm(e,t):e}function Ym(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Jm)return new Hm(e,t);throw Xp("To use ref(service, url), the first argument must be a Storage instance.")}return Qm(e,t)}function Xm(e,t){const n=null===t||void 0===t?void 0:t[zp];return null==n?null:tm.makeFromBucketSpec(n,e)}class Jm{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=Bp,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?tm.makeFromBucketSpec(r,this._host):Xm(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=tm.makeFromBucketSpec(this._url,e):this._bucket=Xm(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){am("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){am("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Hm(this,e)}_makeRequest(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new nm(Jp());{const s=function(e,t,n,r,i,s){let a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const o=lm(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new um(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,a)}(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const Zm="@firebase/storage",eg="0.13.2",tg="storage";function ng(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new Jm(r,i,s,n,xn)}gn(new at(tg,ng,"PUBLIC").setMultipleInstances(!0)),En(Zm,eg,""),En(Zm,eg,"esm2017");function rg(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function ig(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"===typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>ig(e));if("function"===typeof e||"object"===typeof e)return rg(e,e=>ig(e));throw new Error("Data cannot be encoded in JSON: "+e)}function sg(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>sg(e)):"function"===typeof e||"object"===typeof e?rg(e,e=>sg(e)):e}const ag="functions",og={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class lg extends Qe{constructor(e,t,n){super(`${ag}/${e}`,t||""),this.details=n}}class cg{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(e=>this.auth=e,()=>{}),this.messaging||t.get().then(e=>this.messaging=e,()=>{}),this.appCheck||n.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null===e||void 0===e?void 0:e.accessToken}catch(Bw){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(Bw){return}}async getAppCheckToken(e){if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}const ug="us-central1";class dg{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ug,s=arguments.length>5?arguments[5]:void 0;this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new cg(t,n,r),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{const e=new URL(i);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=ug}catch(Bw){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){return`${this.emulatorOrigin}/${t}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function hg(e,t,n){return r=>function(e,t,n,r){const i=e._url(t);return pg(e,i,n,r)}(e,t,r,n||{})}async function fg(e,t,n,r){let i;n["Content-Type"]="application/json";try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(Bw){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(Bw){}return{status:i.status,json:s}}async function pg(e,t,n,r){const i={data:n=ig(n)},s={},a=await e.contextProvider.getContext(r.limitedUseAppCheckTokens);a.authToken&&(s.Authorization="Bearer "+a.authToken),a.messagingToken&&(s["Firebase-Instance-ID-Token"]=a.messagingToken),null!==a.appCheckToken&&(s["X-Firebase-AppCheck"]=a.appCheckToken);const o=function(e){let t=null;return{promise:new Promise((n,r)=>{t=setTimeout(()=>{r(new lg("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}(r.timeout||7e4),l=await Promise.race([fg(t,i,s,e.fetchImpl),o.promise,e.cancelAllRequests]);if(o.cancel(),!l)throw new lg("cancelled","Firebase Functions instance was deleted.");const c=function(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r;try{const e=t&&t.error;if(e){const t=e.status;if("string"===typeof t){if(!og[t])return new lg("internal","internal");r=og[t],i=t}const s=e.message;"string"===typeof s&&(i=s),n=e.details,void 0!==n&&(n=sg(n))}}catch(Bw){}return"ok"===r?null:new lg(r,i,n)}(l.status,l.json);if(c)throw c;if(!l.json)throw new lg("internal","Response is not valid JSON object.");let u=l.json.data;if("undefined"===typeof u&&(u=l.json.result),"undefined"===typeof u)throw new lg("internal","Response is missing data field.");return{data:sg(u)}}const mg="@firebase/functions",gg="0.11.8";function vg(e,t,n){return hg(st(e),t,n)}!function(e,t){gn(new at(ag,(t,n)=>{let{instanceIdentifier:r}=n;const i=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),a=t.getProvider("messaging-internal"),o=t.getProvider("app-check-internal");return new dg(i,s,a,o,r,e)},"PUBLIC").setMultipleInstances(!0)),En(mg,gg,t),En(mg,gg,"esm2017")}(fetch.bind(self));const yg=_n({apiKey:"AIzaSyBSpwzSf8hXxb4rBk-u8JPyX7Ha4kGoS8o",authDomain:"mountainmedicine-6e572.firebaseapp.com",projectId:"mountainmedicine-6e572",storageBucket:"mountainmedicine-6e572.firebasestorage.app",messagingSenderId:"1081705872512",appId:"1:1081705872512:web:0ddf126c4737e47fd9ba65"}),bg=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nn();const t=vn(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=vn(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Je(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;Bn(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:zs,persistence:[es,Mi,Ui]}),r=$e("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Ws)return;const r=null===t||void 0===t?void 0:t.token;Ks!==r&&(Ks=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){st(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){st(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var i;const s=Ve("auth");return s&&ii(n,`http://${s}`),n}(yg),wg=function(e,t){const n="string"==typeof e?e:t||"(default)",r=vn("object"==typeof e?e:Nn(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=Be("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=wf(e,Nf))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==a&&ga("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=ua.MOCK_USER;else{t=He(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new _a(xa.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ua(s)}e._authCredentials=new Sa(new Ea(t,n))}}(r,...e)}return r}(yg),xg=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nn(),t=arguments.length>1?arguments[1]:void 0;e=st(e);const n=vn(e,tg).getImmediate({identifier:t}),r=Be("storage");return r&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"===typeof i?i:He(i,e.app.options.projectId))}(e,t,n,r)}(n,...r),n}(yg),_g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nn(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ug;const n=vn(st(e),ag).getImmediate({identifier:t}),r=Be("functions");return r&&function(e,t,n){!function(e,t,n){e.emulatorOrigin=`http://${t}:${n}`}(st(e),t,n)}(n,...r),n}(yg);(function(e,t){return st(e).setPersistence(t)})(bg,Mi).catch(e=>{console.error("Error setting auth persistence:",e)}),window.location.hostname;var Ng=n(579);const Eg=(0,i.createContext)();function kg(){const e=(0,i.useContext)(Eg);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function Sg(e){let{children:t}=e;const[n,r]=(0,i.useState)(null),[s,a]=(0,i.useState)(null),[o,l]=(0,i.useState)(!0);(0,i.useEffect)(()=>{console.log("Setting up auth listener...");const e=function(e,t,n,r){return st(e).onAuthStateChanged(t,n,r)}(bg,async e=>{console.log("Auth state changed:",e?"User logged in":"No user"),e?(r(e),await async function(e){try{const t=await Tp(jf(wg,"users",e));if(t.exists()){const e=t.data();return a(e.role||"viewer"),e}return null}catch(t){return console.error("Error loading user data:",t),null}}(e.uid)):(r(null),a(null)),l(!1)});return e},[]);const c={currentUser:n,userRole:s,signup:async function(e,t,n){const{user:r}=await async function(e,t,n){if(yn(e.app))return Promise.reject(qn(e));const r=Yr(e),i=ri(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ni),s=await i.catch(t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Ri(e),t}),a=await Ei._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(a.user),a}(bg,e,t);return await Dp(jf(wg,"users",r.uid),{id:r.uid,email:r.email,name:n,role:"user",created_at:new Date,last_login:new Date}),r},login:async function(e,t){const{user:n}=await Di(bg,e,t);return await Dp(jf(wg,"users",n.uid),{last_login:new Date},{merge:!0}),n},logout:async function(){await function(e){return st(e).signOut()}(bg),r(null),a(null)},hasRole:function(e){const t={admin:4,manager:3,user:2,viewer:1};return(t[s]||0)>=(t[e]||0)},loading:o};return(0,Ng.jsx)(Eg.Provider,{value:c,children:t})}const Cg=(0,i.createContext)();function jg(){const e=(0,i.useContext)(Cg);if(!e)throw new Error("useApp must be used within AppProvider");return e}function Ig(e){let{children:t}=e;const{currentUser:n}=kg(),[r,s]=(0,i.useState)([]),[a,o]=(0,i.useState)([]),[l,c]=(0,i.useState)([]),[u,d]=(0,i.useState)(!0);(0,i.useEffect)(()=>{if(!n)return void s([]);const e=Mp(fp(Cf(wg,"events"),mp("deleted","==",!1)),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));t.sort((e,t)=>{var n,r,i,s;const a=(null===(n=e.start_date)||void 0===n||null===(r=n.toDate)||void 0===r?void 0:r.call(n))||new Date(e.start_date);return((null===(i=t.start_date)||void 0===i||null===(s=i.toDate)||void 0===s?void 0:s.call(i))||new Date(t.start_date))-a}),s(t),d(!1)});return()=>e()},[n]),(0,i.useEffect)(()=>{if(!n)return void o([]);const e=Mp(Cf(wg,"recipes"),e=>{console.log("Recipes snapshot received:",e.size,"documents");const t=e.docs.map(e=>({id:e.id,...e.data()}));t.sort((e,t)=>(e.name||"").localeCompare(t.name||"")),o(t)},e=>{console.error("Error loading recipes:",e)});return()=>e()},[n]),(0,i.useEffect)(()=>{if(!n)return void c([]);const e=Mp(Cf(wg,"menus"),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));c(t)});return()=>e()},[n]);const h={events:r,recipes:a,menus:l,loading:u};return(0,Ng.jsx)(Cg.Provider,{value:h,children:t})}function Tg(){return(0,Ng.jsx)("div",{className:"loading-container",children:(0,Ng.jsxs)("div",{className:"loading-content",children:[(0,Ng.jsx)("div",{className:"loading-spinner"}),(0,Ng.jsx)("h2",{children:"Mountain Medicine Catering"}),(0,Ng.jsx)("p",{children:"Loading..."})]})})}function Ag(e){let{children:t,requiredRole:n=null}=e;const{currentUser:r,hasRole:i,loading:s}=kg();return s?(0,Ng.jsx)(Tg,{}):r?n&&!i(n)?(0,Ng.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column"},children:[(0,Ng.jsx)("h2",{children:"Access Denied"}),(0,Ng.jsxs)("p",{children:["You need ",n," permissions to access this page."]})]}):t:(0,Ng.jsx)(ye,{to:"/login"})}function Rg(e){let{children:t}=e;const{currentUser:n,logout:r,userRole:s}=kg(),a=ne(),[o,l]=(0,i.useState)(!0);return(0,Ng.jsxs)("div",{className:"layout",children:[(0,Ng.jsxs)("header",{className:"header",children:[(0,Ng.jsxs)("div",{className:"header-left",children:[(0,Ng.jsx)("button",{className:"sidebar-toggle",onClick:()=>l(!o),children:"\u2630"}),(0,Ng.jsx)("img",{src:"/mountain_logo_longer.png",alt:"Mountain Medicine",className:"header-logo"})]}),(0,Ng.jsx)("div",{className:"header-center"}),(0,Ng.jsxs)("div",{className:"header-right",children:[(0,Ng.jsxs)("span",{className:"user-info",children:[null===n||void 0===n?void 0:n.email," (",s,")"]}),(0,Ng.jsx)("button",{className:"logout-btn",onClick:async()=>{try{await r(),a("/login")}catch(e){console.error("Logout error:",e)}},children:"Logout"})]})]}),(0,Ng.jsxs)("div",{className:"layout-body",children:[(0,Ng.jsx)("aside",{className:"sidebar "+(o?"open":"closed"),children:(0,Ng.jsx)("nav",{className:"sidebar-nav",children:[{path:"/",label:"Dashboard",icon:"\ud83c\udfe0"},{path:"/events",label:"Events",icon:"\ud83d\udcc5"},{path:"/recipes",label:"Recipes",icon:"\ud83d\udcd6"},{path:"/menus",label:"Menus",icon:"\ud83c\udf7d\ufe0f"},{path:"/ingredients",label:"Ingredients",icon:"\ud83e\udd55"},{path:"/chat",label:"AI Assistant",icon:"\ud83d\udcac"}].map(e=>(0,Ng.jsxs)(Te,{to:e.path,className:"nav-item",children:[(0,Ng.jsx)("span",{className:"nav-icon",children:e.icon}),o&&(0,Ng.jsx)("span",{className:"nav-label",children:e.label})]},e.path))})}),(0,Ng.jsx)("main",{className:"main-content",children:t})]})]})}function Dg(){const[e,t]=(0,i.useState)({}),[n,r]=(0,i.useState)("");(0,i.useEffect)(()=>{t({apiKey:"\u2713 Set",authDomain:"mountainmedicine-6e572.firebaseapp.com",projectId:"mountainmedicine-6e572"});const e=bg.onAuthStateChanged(e=>{r(e?`Logged in as: ${e.email}`:"Not logged in")});return()=>e()},[]);return(0,Ng.jsxs)("div",{style:{padding:"20px",fontFamily:"monospace"},children:[(0,Ng.jsx)("h3",{children:"Firebase Auth Debug"}),(0,Ng.jsxs)("div",{children:[(0,Ng.jsx)("h4",{children:"Configuration:"}),(0,Ng.jsx)("pre",{children:JSON.stringify(e,null,2)}),(0,Ng.jsx)("h4",{children:"Auth State:"}),(0,Ng.jsx)("p",{children:n}),(0,Ng.jsx)("h4",{children:"Current Origin:"}),(0,Ng.jsx)("p",{children:window.location.origin}),(0,Ng.jsx)("button",{onClick:()=>{const e=new wi;console.log("Auth domain:","mountainmedicine-6e572.firebaseapp.com"),console.log("Current URL:",window.location.origin),console.log("Provider:",e)},style:{marginTop:"10px"},children:"Test Google Auth Config"}),(0,Ng.jsx)("p",{style:{marginTop:"10px",fontSize:"12px"},children:"Check browser console for details when clicking the button"})]})]})}function Pg(){const[e,t]=(0,i.useState)(""),[n,r]=(0,i.useState)(""),[s,a]=(0,i.useState)(""),[o,l]=(0,i.useState)(!1),[c,u]=(0,i.useState)(!1),d=ne();return(0,Ng.jsxs)("div",{className:"login-container",children:[(0,Ng.jsxs)("div",{className:"login-card",children:[(0,Ng.jsxs)("div",{className:"login-header",children:[(0,Ng.jsx)("img",{src:"/mountain_logo.png",alt:"Mountain Medicine",className:"login-logo"}),(0,Ng.jsx)("h1",{children:"Mountain Medicine Catering"}),(0,Ng.jsx)("p",{children:"Sign in to your account"})]}),s&&(0,Ng.jsx)("div",{className:"error-message",children:s}),c?(0,Ng.jsxs)(Ng.Fragment,{children:[(0,Ng.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{a(""),l(!0),await Di(bg,e,n),d("/")}catch(s){a("Failed to log in: "+s.message)}finally{l(!1)}},className:"login-form",children:[(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"email",children:"Email"}),(0,Ng.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),required:!0,placeholder:"Enter your email"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"password",children:"Password"}),(0,Ng.jsx)("input",{id:"password",type:"password",value:n,onChange:e=>r(e.target.value),required:!0,placeholder:"Enter your password"})]}),(0,Ng.jsx)("button",{type:"submit",className:"login-button",disabled:o,children:o?"Signing in...":"Sign In"})]}),(0,Ng.jsx)("button",{onClick:()=>u(!1),className:"back-button",children:"\u2190 Back to sign in options"})]}):(0,Ng.jsxs)(Ng.Fragment,{children:[(0,Ng.jsxs)("button",{onClick:async()=>{try{a(""),l(!0);const e=new wi;await async function(e,t,n){if(yn(e.app))return Promise.reject(zn(e,"operation-not-supported-in-this-environment"));const r=Yr(e);Hn(e,t,vi);const i=is(r,n);return new ds(r,"signInViaPopup",t,i).executeNotNull()}(bg,e),d("/")}catch(s){a("Failed to sign in with Google: "+s.message)}finally{l(!1)}},className:"google-signin-button",disabled:o,children:[(0,Ng.jsxs)("svg",{className:"google-icon",viewBox:"0 0 24 24",children:[(0,Ng.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,Ng.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,Ng.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,Ng.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),o?"Signing in...":"Sign in with Google"]}),(0,Ng.jsx)("div",{className:"divider",children:(0,Ng.jsx)("span",{children:"or"})}),(0,Ng.jsx)("button",{onClick:()=>u(!0),className:"email-signin-button",children:"Sign in with Email"})]})]}),(0,Ng.jsx)(Dg,{})]})}function Og(){var e;const t=ne(),{currentUser:n}=kg(),{events:r,recipes:i,menus:s}=jg(),a=r.filter(e=>{var t;return new Date(1e3*(null===(t=e.start_date)||void 0===t?void 0:t.seconds)||e.start_date)>new Date&&"completed"!==e.status}).slice(0,5);return(0,Ng.jsxs)("div",{className:"dashboard",children:[(0,Ng.jsxs)("div",{className:"dashboard-header",children:[(0,Ng.jsxs)("h1",{children:["Welcome back, ",null===n||void 0===n||null===(e=n.email)||void 0===e?void 0:e.split("@")[0],"!"]}),(0,Ng.jsx)("p",{className:"dashboard-subtitle",children:"Your catering command center"})]}),(0,Ng.jsxs)("div",{className:"stats-grid",children:[(0,Ng.jsxs)("div",{className:"stat-card",children:[(0,Ng.jsx)("div",{className:"stat-icon",children:"\ud83d\udcc5"}),(0,Ng.jsxs)("div",{className:"stat-content",children:[(0,Ng.jsx)("div",{className:"stat-value",children:r.length}),(0,Ng.jsx)("div",{className:"stat-label",children:"Total Events"})]})]}),(0,Ng.jsxs)("div",{className:"stat-card",children:[(0,Ng.jsx)("div",{className:"stat-icon",children:"\ud83d\udcd6"}),(0,Ng.jsxs)("div",{className:"stat-content",children:[(0,Ng.jsx)("div",{className:"stat-value",children:i.length}),(0,Ng.jsx)("div",{className:"stat-label",children:"Recipes"})]})]}),(0,Ng.jsxs)("div",{className:"stat-card",children:[(0,Ng.jsx)("div",{className:"stat-icon",children:"\ud83c\udf7d\ufe0f"}),(0,Ng.jsxs)("div",{className:"stat-content",children:[(0,Ng.jsx)("div",{className:"stat-value",children:s.length}),(0,Ng.jsx)("div",{className:"stat-label",children:"Menus"})]})]})]}),(0,Ng.jsxs)("div",{className:"quick-actions",children:[(0,Ng.jsx)("h2",{children:"Quick Actions"}),(0,Ng.jsxs)("div",{className:"action-buttons",children:[(0,Ng.jsxs)("button",{className:"action-btn",onClick:()=>t("/events/new"),children:[(0,Ng.jsx)("span",{className:"action-icon",children:"\ud83d\udcc5"}),(0,Ng.jsx)("span",{children:"Create Event"})]}),(0,Ng.jsxs)("button",{className:"action-btn",onClick:()=>t("/recipes/new"),children:[(0,Ng.jsx)("span",{className:"action-icon",children:"\ud83d\udcdd"}),(0,Ng.jsx)("span",{children:"Add Recipe"})]}),(0,Ng.jsxs)("button",{className:"action-btn",onClick:()=>t("/menus/new"),children:[(0,Ng.jsx)("span",{className:"action-icon",children:"\ud83c\udf7d\ufe0f"}),(0,Ng.jsx)("span",{children:"Create Menu"})]}),(0,Ng.jsxs)("button",{className:"action-btn",onClick:()=>t("/shopping-list"),children:[(0,Ng.jsx)("span",{className:"action-icon",children:"\ud83d\udccb"}),(0,Ng.jsx)("span",{children:"Shopping List"})]}),(0,Ng.jsxs)("button",{className:"action-btn",onClick:()=>t("/export"),children:[(0,Ng.jsx)("span",{className:"action-icon",children:"\ud83d\udcc4"}),(0,Ng.jsx)("span",{children:"Export PDF"})]})]})]}),(0,Ng.jsxs)("div",{className:"upcoming-events",children:[(0,Ng.jsx)("h2",{children:"Upcoming Events"}),a.length>0?(0,Ng.jsx)("div",{className:"events-list",children:a.map(e=>{var t;const n=new Date(1e3*(null===(t=e.start_date)||void 0===t?void 0:t.seconds)||e.start_date),r=Math.ceil((n-new Date)/864e5);return(0,Ng.jsxs)("div",{className:"event-card",children:[(0,Ng.jsxs)("div",{className:"event-info",children:[(0,Ng.jsx)("h3",{children:e.name}),(0,Ng.jsx)("p",{children:e.location}),(0,Ng.jsxs)("p",{className:"event-date",children:[n.toLocaleDateString()," \u2022 ",e.guest_count," guests"]})]}),(0,Ng.jsxs)("div",{className:"event-countdown",children:[(0,Ng.jsx)("div",{className:"countdown-number",children:r}),(0,Ng.jsx)("div",{className:"countdown-label",children:"days"})]})]},e.id)})}):(0,Ng.jsx)("p",{className:"empty-state",children:"No upcoming events"})]})]})}async function Lg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{const i=`ver_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,s={...t,id:i,parent_id:e,timestamp:Vp(),edit_note:n,is_special_version:r,special_version:r?t.special_version:""};return await Lp(Cf(wg,"recipes",e,"versions"),s),i}catch(i){throw console.error("Error saving recipe version:",i),i}}async function Mg(e){try{const t=fp(Cf(wg,"recipes",e,"versions"),mp("is_special_version","==",!0),yp("timestamp","desc"));return(await Rp(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(t){return console.error("Error fetching special versions:",t),[]}}async function Fg(e){try{const t=fp(Cf(wg,"recipes",e,"versions"),mp("is_special_version","==",!1),yp("timestamp","desc"));return(await Rp(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(t){return console.error("Error fetching version history:",t),[]}}async function Ug(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return Lg(e,{...t,special_version:n,name:`${t.name} (${n})`},r,!0)}function Vg(){const e=ne(),{recipes:t}=jg(),{hasRole:n}=kg(),[r,s]=(0,i.useState)(""),[a,o]=(0,i.useState)([]),[l,c]=(0,i.useState)([]),[u,d]=(0,i.useState)("name"),[h,f]=(0,i.useState)([]),[p,m]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{try{const e=await async function(){try{const e=await Rp(Cf(wg,"recipes")),t=[];for(const n of e.docs){const e={id:n.id,...n.data(),versions:[]},r=await Mg(n.id);e.versions=r,t.push(e)}return t}catch(e){return console.error("Error fetching recipes with versions:",e),[]}}();f(e)}catch(e){console.error("Error loading recipe versions:",e)}finally{m(!1)}})()},[t]);const{allTags:g,allAllergens:v}=(0,i.useMemo)(()=>{const e=new Set,n=new Set;return t.forEach(t=>{var r,i;null===(r=t.tags)||void 0===r||r.forEach(t=>e.add(t)),null===(i=t.allergens)||void 0===i||i.forEach(e=>n.add(e))}),{allTags:Array.from(e).sort(),allAllergens:Array.from(n).sort()}},[t]),y=(0,i.useMemo)(()=>{let e=t.filter(e=>{if(r){var t,n;const i=r.toLowerCase(),s=null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(i),a=null===(n=e.ingredients)||void 0===n?void 0:n.some(e=>e.toLowerCase().includes(i));if(!s&&!a)return!1}var i,s;if(a.length>0&&(null===(i=e.tags)||void 0===i||!i.some(e=>a.includes(e))))return!1;if(l.length>0&&(null!==(s=e.allergens)&&void 0!==s&&s.some(e=>l.includes(e))))return!1;return!0});return e.sort((e,t)=>{var n,r,i,s;switch(u){case"name":return(e.name||"").localeCompare(t.name||"");case"serves":return(t.serves||0)-(e.serves||0);case"created_at":const a=(null===(n=e.created_at)||void 0===n||null===(r=n.toDate)||void 0===r?void 0:r.call(n))||new Date(e.created_at||0);return((null===(i=t.created_at)||void 0===i||null===(s=i.toDate)||void 0===s?void 0:s.call(i))||new Date(t.created_at||0))-a;default:return 0}}),e},[t,r,a,l,u]),b=()=>{e("/recipes/new")};return(0,Ng.jsxs)("div",{className:"recipe-list",children:[(0,Ng.jsxs)("div",{className:"recipe-list-header",children:[(0,Ng.jsx)("h1",{children:"Recipe Manager"}),n("user")&&(0,Ng.jsxs)("div",{className:"header-actions",children:[(0,Ng.jsxs)("button",{className:"btn btn-secondary",onClick:()=>e("/recipes/import"),children:[(0,Ng.jsx)("span",{className:"btn-icon",children:"\ud83d\udce5"}),"Import"]}),(0,Ng.jsxs)("button",{className:"btn btn-primary",onClick:b,children:[(0,Ng.jsx)("span",{className:"btn-icon",children:"\u2795"}),"Add Recipe"]})]})]}),(0,Ng.jsxs)("div",{className:"recipe-filters",children:[(0,Ng.jsxs)("div",{className:"search-bar",children:[(0,Ng.jsx)("span",{className:"search-icon",children:"\ud83d\udd0d"}),(0,Ng.jsx)("input",{type:"text",placeholder:"Search recipes or ingredients...",value:r,onChange:e=>s(e.target.value),className:"search-input"}),r&&(0,Ng.jsx)("button",{className:"clear-search",onClick:()=>s(""),children:"\u2715"})]}),(0,Ng.jsxs)("div",{className:"filter-row",children:[(0,Ng.jsxs)("div",{className:"filter-group",children:[(0,Ng.jsx)("label",{children:"Sort by:"}),(0,Ng.jsxs)("select",{value:u,onChange:e=>d(e.target.value),className:"sort-select",children:[(0,Ng.jsx)("option",{value:"name",children:"Name"}),(0,Ng.jsx)("option",{value:"serves",children:"Serving Size"}),(0,Ng.jsx)("option",{value:"created_at",children:"Date Added"})]})]}),(0,Ng.jsxs)("div",{className:"filter-group",children:[(0,Ng.jsx)("label",{children:"Filter by Tags:"}),(0,Ng.jsx)("div",{className:"tag-filters",children:g.map(e=>(0,Ng.jsx)("button",{className:"tag-filter "+(a.includes(e)?"active":""),onClick:()=>(e=>{o(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e),children:e},e))})]}),(0,Ng.jsxs)("div",{className:"filter-group",children:[(0,Ng.jsx)("label",{children:"Exclude Allergens:"}),(0,Ng.jsx)("div",{className:"allergen-filters",children:v.map(e=>(0,Ng.jsxs)("button",{className:"allergen-filter "+(l.includes(e)?"active":""),onClick:()=>(e=>{c(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e),children:["\ud83d\udeab ",e]},e))})]})]}),(a.length>0||l.length>0)&&(0,Ng.jsx)("button",{className:"clear-filters",onClick:()=>{o([]),c([])},children:"Clear all filters"})]}),(0,Ng.jsxs)("div",{className:"results-summary",children:["Showing ",y.length," of ",t.length," recipes"]}),(0,Ng.jsx)("div",{className:"recipe-grid",children:y.map(t=>{const n=h.find(e=>e.id===t.id)||t;return(0,Ng.jsx)(Bg,{recipe:n,onClick:()=>{return n=t.id,void e(`/recipes/${n}`);var n}},t.id)})}),0===y.length&&(0,Ng.jsxs)("div",{className:"empty-state",children:[(0,Ng.jsx)("p",{children:"No recipes found matching your criteria."}),n("user")&&(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:b,children:"Create Your First Recipe"})]})]})}function Bg(e){let{recipe:t,onClick:n}=e;const r=t.versions&&t.versions.length>0;return(0,Ng.jsxs)("div",{className:"recipe-card",onClick:n,children:[t.image_url&&(0,Ng.jsx)("div",{className:"recipe-image",children:(0,Ng.jsx)("img",{src:t.image_url,alt:t.name,onError:e=>{e.target.src="/api/placeholder/300/200"}})}),(0,Ng.jsxs)("div",{className:"recipe-content",children:[(0,Ng.jsx)("h3",{className:"recipe-name",children:t.name||"Unnamed Recipe"}),t.special_version&&(0,Ng.jsx)("span",{className:"version-indicator",children:t.special_version}),r&&(0,Ng.jsxs)("div",{className:"available-versions",children:[(0,Ng.jsx)("span",{className:"versions-label",children:"Available versions:"}),t.versions.map((e,t)=>(0,Ng.jsx)("span",{className:"version-badge",children:e.special_version},e.id))]}),(0,Ng.jsxs)("div",{className:"recipe-meta",children:[(0,Ng.jsxs)("span",{className:"recipe-serves",children:[(0,Ng.jsx)("span",{className:"icon",children:"\ud83c\udf7d\ufe0f"}),"Serves ",t.serves||"?"]}),t.prep_time&&(0,Ng.jsxs)("span",{className:"recipe-time",children:[(0,Ng.jsx)("span",{className:"icon",children:"\u23f1\ufe0f"}),t.prep_time," min"]})]}),t.tags&&t.tags.length>0&&(0,Ng.jsxs)("div",{className:"recipe-tags",children:[t.tags.slice(0,3).map(e=>(0,Ng.jsx)("span",{className:"recipe-tag",children:e},e)),t.tags.length>3&&(0,Ng.jsxs)("span",{className:"recipe-tag",children:["+",t.tags.length-3]})]}),t.allergens&&t.allergens.length>0&&(0,Ng.jsx)("div",{className:"recipe-allergens",children:t.allergens.map(e=>(0,Ng.jsxs)("span",{className:"recipe-allergen",children:["\u26a0\ufe0f ",e]},e))})]})]})}"undefined"===typeof BigInt&&(BigInt=function(e){if(isNaN(e))throw new Error("");return e});const zg=BigInt(0),$g=BigInt(1),qg=BigInt(2),Hg=BigInt(5),Wg=BigInt(10),Kg={s:$g,n:zg,d:$g};function Gg(e,t){try{e=BigInt(e)}catch(Bw){throw rv()}return e*t}function Qg(e){return"bigint"===typeof e?e:Math.floor(e)}function Yg(e,t){if(t===zg)throw nv();const n=Object.create(tv.prototype);n.s=e<zg?-$g:$g;const r=ev(e=e<zg?-e:e,t);return n.n=e/r,n.d=t/r,n}function Xg(e){const t={};let n=e,r=qg,i=Hg-$g;for(;i<=n;){for(;n%r===zg;)n/=r,t[r]=(t[r]||zg)+$g;i+=$g+qg*r++}return n!==e?n>1&&(t[n]=(t[n]||zg)+$g):t[e]=(t[e]||zg)+$g,t}const Jg=function(e,t){let n=zg,r=$g,i=$g;if(void 0===e||null===e);else if(void 0!==t){if("bigint"===typeof e)n=e;else{if(isNaN(e))throw rv();if(e%1!==0)throw iv();n=BigInt(e)}if("bigint"===typeof t)r=t;else{if(isNaN(t))throw rv();if(t%1!==0)throw iv();r=BigInt(t)}i=n*r}else if("object"===typeof e){if("d"in e&&"n"in e)n=BigInt(e.n),r=BigInt(e.d),"s"in e&&(n*=BigInt(e.s));else if(0 in e)n=BigInt(e[0]),1 in e&&(r=BigInt(e[1]));else{if("bigint"!==typeof e)throw rv();n=e}i=n*r}else if("number"===typeof e){if(isNaN(e))throw rv();if(e<0&&(i=-$g,e=-e),e%1===0)n=BigInt(e);else{let t=1,i=0,s=1,a=1,o=1,l=1e7;for(e>=1&&(t=10**Math.floor(1+Math.log10(e)),e/=t);s<=l&&o<=l;){let t=(i+a)/(s+o);if(e===t){s+o<=l?(n=i+a,r=s+o):o>s?(n=a,r=o):(n=i,r=s);break}e>t?(i+=a,s+=o):(a+=i,o+=s),s>l?(n=a,r=o):(n=i,r=s)}n=BigInt(n)*BigInt(t),r=BigInt(r)}}else if("string"===typeof e){let t=0,s=zg,a=zg,o=zg,l=$g,c=$g,u=e.replace(/_/g,"").match(/\d+|./g);if(null===u)throw rv();if("-"===u[t]?(i=-$g,t++):"+"===u[t]&&t++,u.length===t+1?a=Gg(u[t++],i):"."===u[t+1]||"."===u[t]?("."!==u[t]&&(s=Gg(u[t++],i)),t++,(t+1===u.length||"("===u[t+1]&&")"===u[t+3]||"'"===u[t+1]&&"'"===u[t+3])&&(a=Gg(u[t],i),l=Wg**BigInt(u[t].length),t++),("("===u[t]&&")"===u[t+2]||"'"===u[t]&&"'"===u[t+2])&&(o=Gg(u[t+1],i),c=Wg**BigInt(u[t+1].length)-$g,t+=3)):"/"===u[t+1]||":"===u[t+1]?(a=Gg(u[t],i),l=Gg(u[t+2],$g),t+=3):"/"===u[t+3]&&" "===u[t+1]&&(s=Gg(u[t],i),a=Gg(u[t+2],i),l=Gg(u[t+4],$g),t+=5),!(u.length<=t))throw rv();r=l*c,i=n=o+r*s+c*a}else{if("bigint"!==typeof e)throw rv();n=e,i=e,r=$g}if(r===zg)throw nv();Kg.s=i<zg?-$g:$g,Kg.n=n<zg?-n:n,Kg.d=r<zg?-r:r};function Zg(e,t,n){let r=$g,i=function(e,t,n){let r=$g;for(;t>zg;e=e*e%n,t>>=$g)t&$g&&(r=r*e%n);return r}(Wg,n,t);for(let s=0;s<300;s++){if(r===i)return BigInt(s);r=r*Wg%t,i=i*Wg%t}return 0}function ev(e,t){if(!e)return t;if(!t)return e;for(;;){if(!(e%=t))return t;if(!(t%=e))return e}}function tv(e,t){if(Jg(e,t),!(this instanceof tv))return Yg(Kg.s*Kg.n,Kg.d);e=ev(Kg.d,Kg.n),this.s=Kg.s,this.n=Kg.n/e,this.d=Kg.d/e}var nv=function(){return new Error("Division by Zero")},rv=function(){return new Error("Invalid argument")},iv=function(){return new Error("Parameters must be integer")};tv.prototype={s:$g,n:zg,d:$g,abs:function(){return Yg(this.n,this.d)},neg:function(){return Yg(-this.s*this.n,this.d)},add:function(e,t){return Jg(e,t),Yg(this.s*this.n*Kg.d+Kg.s*this.d*Kg.n,this.d*Kg.d)},sub:function(e,t){return Jg(e,t),Yg(this.s*this.n*Kg.d-Kg.s*this.d*Kg.n,this.d*Kg.d)},mul:function(e,t){return Jg(e,t),Yg(this.s*Kg.s*this.n*Kg.n,this.d*Kg.d)},div:function(e,t){return Jg(e,t),Yg(this.s*Kg.s*this.n*Kg.d,this.d*Kg.n)},clone:function(){return Yg(this.s*this.n,this.d)},mod:function(e,t){if(void 0===e)return Yg(this.s*this.n%this.d,$g);if(Jg(e,t),zg===Kg.n*this.d)throw nv();return Yg(this.s*(Kg.d*this.n)%(Kg.n*this.d),Kg.d*this.d)},gcd:function(e,t){return Jg(e,t),Yg(ev(Kg.n,this.n)*ev(Kg.d,this.d),Kg.d*this.d)},lcm:function(e,t){return Jg(e,t),Kg.n===zg&&this.n===zg?Yg(zg,$g):Yg(Kg.n*this.n,ev(Kg.n,this.n)*ev(Kg.d,this.d))},inverse:function(){return Yg(this.s*this.d,this.n)},pow:function(e,t){if(Jg(e,t),Kg.d===$g)return Kg.s<zg?Yg((this.s*this.d)**Kg.n,this.n**Kg.n):Yg((this.s*this.n)**Kg.n,this.d**Kg.n);if(this.s<zg)return null;let n=Xg(this.n),r=Xg(this.d),i=$g,s=$g;for(let a in n)if("1"!==a){if("0"===a){i=zg;break}if(n[a]*=Kg.n,n[a]%Kg.d!==zg)return null;n[a]/=Kg.d,i*=BigInt(a)**n[a]}for(let a in r)if("1"!==a){if(r[a]*=Kg.n,r[a]%Kg.d!==zg)return null;r[a]/=Kg.d,s*=BigInt(a)**r[a]}return Kg.s<zg?Yg(s,i):Yg(i,s)},log:function(e,t){if(Jg(e,t),this.s<=zg||Kg.s<=zg)return null;const n={},r=Xg(Kg.n),i=Xg(Kg.d),s=Xg(this.n),a=Xg(this.d);for(const c in i)r[c]=(r[c]||zg)-i[c];for(const c in a)s[c]=(s[c]||zg)-a[c];for(const c in r)"1"!==c&&(n[c]=!0);for(const c in s)"1"!==c&&(n[c]=!0);let o=null,l=null;for(const c in n){const e=r[c]||zg,t=s[c]||zg;if(e===zg){if(t!==zg)return null;continue}let n=t,i=e;const a=ev(n,i);if(n/=a,i/=a,null===o&&null===l)o=n,l=i;else if(n*l!==o*i)return null}return null!==o&&null!==l?Yg(o,l):null},equals:function(e,t){return Jg(e,t),this.s*this.n*Kg.d===Kg.s*Kg.n*this.d},lt:function(e,t){return Jg(e,t),this.s*this.n*Kg.d<Kg.s*Kg.n*this.d},lte:function(e,t){return Jg(e,t),this.s*this.n*Kg.d<=Kg.s*Kg.n*this.d},gt:function(e,t){return Jg(e,t),this.s*this.n*Kg.d>Kg.s*Kg.n*this.d},gte:function(e,t){return Jg(e,t),this.s*this.n*Kg.d>=Kg.s*Kg.n*this.d},compare:function(e,t){Jg(e,t);let n=this.s*this.n*Kg.d-Kg.s*Kg.n*this.d;return(zg<n)-(n<zg)},ceil:function(e){return e=Wg**BigInt(e||0),Yg(Qg(this.s*e*this.n/this.d)+(e*this.n%this.d>zg&&this.s>=zg?$g:zg),e)},floor:function(e){return e=Wg**BigInt(e||0),Yg(Qg(this.s*e*this.n/this.d)-(e*this.n%this.d>zg&&this.s<zg?$g:zg),e)},round:function(e){return e=Wg**BigInt(e||0),Yg(Qg(this.s*e*this.n/this.d)+this.s*((this.s>=zg?$g:zg)+qg*(e*this.n%this.d)>this.d?$g:zg),e)},roundTo:function(e,t){Jg(e,t);const n=this.n*Kg.d,r=this.d*Kg.n,i=n%r;let s=Qg(n/r);return i+i>=r&&s++,Yg(this.s*s*Kg.n,Kg.d)},divisible:function(e,t){return Jg(e,t),!(!(Kg.n*this.d)||this.n*Kg.d%(Kg.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(e){let t=this.n,n=this.d;e=e||15;let r=function(e,t){for(;t%qg===zg;t/=qg);for(;t%Hg===zg;t/=Hg);if(t===$g)return zg;let n=Wg%t,r=1;for(;n!==$g;r++)if(n=n*Wg%t,r>2e3)return zg;return BigInt(r)}(0,n),i=Zg(0,n,r),s=this.s<zg?"-":"";if(s+=Qg(t/n),t%=n,t*=Wg,t&&(s+="."),r){for(let e=i;e--;)s+=Qg(t/n),t%=n,t*=Wg;s+="(";for(let e=r;e--;)s+=Qg(t/n),t%=n,t*=Wg;s+=")"}else for(let a=e;t&&a--;)s+=Qg(t/n),t%=n,t*=Wg;return s},toFraction:function(e){let t=this.n,n=this.d,r=this.s<zg?"-":"";if(n===$g)r+=t;else{let i=Qg(t/n);e&&i>zg&&(r+=i,r+=" ",t%=n),r+=t,r+="/",r+=n}return r},toLatex:function(e){let t=this.n,n=this.d,r=this.s<zg?"-":"";if(n===$g)r+=t;else{let i=Qg(t/n);e&&i>zg&&(r+=i,t%=n),r+="\\frac{",r+=t,r+="}{",r+=n,r+="}"}return r},toContinued:function(){let e=this.n,t=this.d,n=[];do{n.push(Qg(e/t));let r=e%t;e=t,t=r}while(e!==$g);return n},simplify:function(e){const t=BigInt(1/(e||.001)|0),n=this.abs(),r=n.toContinued();for(let i=1;i<r.length;i++){let e=Yg(r[i-1],$g);for(let t=i-2;t>=0;t--)e=e.inverse().add(r[t]);let s=e.sub(n);if(s.n*t<s.d)return e.mul(this.s)}return this}};const sv=["cup","cups","c","tablespoon","tablespoons","tbsp","T","teaspoon","teaspoons","tsp","t","ounce","ounces","oz","pound","pounds","lb","lbs","gram","grams","g","kilogram","kilograms","kg","milliliter","milliliters","ml","liter","liters","l","pint","pints","pt","quart","quarts","qt","gallon","gallons","gal","fluid ounce","fluid ounces","fl oz","stick","sticks","clove","cloves","head","heads","bunch","bunches","package","packages","pkg","can","cans","jar","jars","box","boxes","bag","bags","slice","slices","piece","pieces","inch","inches","small","medium","large","dash","pinch","handful"],av=/(\d+)\s*\/\s*(\d+)/,ov=/(\d+)\s+(\d+)\s*\/\s*(\d+)/,lv=/\d+\.?\d*/,cv=/(\d+\.?\d*)\s*-\s*(\d+\.?\d*)/;function uv(e,t){const{quantity:n,unit:r,original:i}=function(e){const t=new RegExp(`\\b(${sv.join("|")})\\b`,"i"),n=e.match(t),r=n?n[1]:"",i=r?e.substring(0,e.indexOf(r)).trim():e;let s=null;const a=i.match(ov);if(a){const e=parseInt(a[1]),t=parseInt(a[2]),n=parseInt(a[3]);s=new tv(e*n+t,n)}else if(s){if(!s){const e=i.match(lv);e&&(s=new tv(parseFloat(e[0])))}}else{const e=i.match(av);e&&(s=new tv(parseInt(e[1]),parseInt(e[2])))}const o=i.match(cv);o&&(s=new tv((parseFloat(o[1])+parseFloat(o[2]))/2));return{quantity:s,unit:r,original:e}}(e);if(!n)return e;return`${function(e){if(!e)return"";const t=e.simplify(),n=Number(t.n),r=Number(t.d);if(!isFinite(n)||!isFinite(r))return e.valueOf().toFixed(2);if(1===r)return n.toString();const i=n/r;if(.5===i)return"\xbd";if(.25===i)return"\xbc";if(.75===i)return"\xbe";if(Math.abs(i-.333)<.001)return"\u2153";if(Math.abs(i-.667)<.001)return"\u2154";if(i%1===0||i.toFixed(2)==i.toFixed(6))return i.toFixed(2).replace(/\.00$/,"");if(n>r){const e=Math.floor(n/r),t=n%r;return 0===t?e.toString():`${e} ${t}/${r}`}return`${n}/${r}`}(n.mul(t))} ${i.replace(ov,"").replace(av,"").replace(lv,"").replace(cv,"").trim()}`.trim()}function dv(e){var t;let{recipe:n,onClose:r,onSaveScaled:s}=e;const[a,o]=(0,i.useState)(n.serves||4),[l,c]=(0,i.useState)(!1),u=(0,i.useMemo)(()=>a===n.serves?n:function(e,t){const n=t/(e.serves||4),r={...e};if(r.serves=t,e.ingredients)if(Array.isArray(e.ingredients))r.ingredients=e.ingredients.map(e=>uv(e,n));else if("string"===typeof e.ingredients){const t=e.ingredients.split("\n").filter(e=>e.trim());r.ingredients=t.map(e=>uv(e,n))}return n<.5?r.scaling_notes="Note: When scaling down significantly, cooking times may need to be reduced. Check for doneness earlier than the original recipe suggests.":n>2&&(r.scaling_notes="Note: When scaling up significantly, cooking times may need to be increased. Use multiple pans if necessary to maintain proper cooking conditions."),e.cook_time&&(n>2?r.cook_time_note="Cooking time may need to be increased by 10-25%":n<.5&&(r.cook_time_note="Cooking time may need to be reduced by 10-25%")),r}(n,a),[n,a]),d=a/(n.serves||4);return(0,Ng.jsxs)("div",{className:"recipe-scaler",children:[(0,Ng.jsxs)("div",{className:"scaler-header",children:[(0,Ng.jsx)("h2",{children:"Scale Recipe"}),(0,Ng.jsx)("button",{className:"close-btn",onClick:r,children:"\u2715"})]}),(0,Ng.jsxs)("div",{className:"scaler-controls",children:[(0,Ng.jsxs)("div",{className:"serving-selector",children:[(0,Ng.jsx)("label",{children:"Original Servings:"}),(0,Ng.jsx)("span",{className:"original-servings",children:n.serves||4})]}),(0,Ng.jsxs)("div",{className:"serving-selector",children:[(0,Ng.jsx)("label",{children:"Target Servings:"}),(0,Ng.jsxs)("div",{className:"serving-input-group",children:[(0,Ng.jsx)("button",{className:"serving-btn",onClick:()=>o(Math.max(1,a-1)),children:"\u2212"}),(0,Ng.jsx)("input",{type:"number",value:a,onChange:e=>o(Math.max(1,parseInt(e.target.value)||1)),min:"1",className:"serving-input"}),(0,Ng.jsx)("button",{className:"serving-btn",onClick:()=>o(a+1),children:"+"})]})]}),(0,Ng.jsxs)("div",{className:"scale-factor",children:["Scale Factor: ",(0,Ng.jsxs)("strong",{children:[d.toFixed(2),"x"]})]})]}),(0,Ng.jsxs)("div",{className:"quick-scale-buttons",children:[(0,Ng.jsx)("button",{className:"quick-scale-btn "+(a===Math.round(.5*n.serves)?"active":""),onClick:()=>o(Math.round(.5*(n.serves||4))),children:"\xbdx"}),(0,Ng.jsx)("button",{className:"quick-scale-btn "+(a===n.serves?"active":""),onClick:()=>o(n.serves||4),children:"1x"}),(0,Ng.jsx)("button",{className:"quick-scale-btn "+(a===Math.round(1.5*n.serves)?"active":""),onClick:()=>o(Math.round(1.5*(n.serves||4))),children:"1.5x"}),(0,Ng.jsx)("button",{className:"quick-scale-btn "+(a===Math.round(2*n.serves)?"active":""),onClick:()=>o(Math.round(2*(n.serves||4))),children:"2x"}),(0,Ng.jsx)("button",{className:"quick-scale-btn "+(a===Math.round(3*n.serves)?"active":""),onClick:()=>o(Math.round(3*(n.serves||4))),children:"3x"})]}),u.scaling_notes&&(0,Ng.jsxs)("div",{className:"scaling-notes",children:[(0,Ng.jsxs)("div",{className:"notes-header",onClick:()=>c(!l),children:[(0,Ng.jsx)("span",{children:"\ud83d\udcdd Scaling Tips"}),(0,Ng.jsx)("span",{className:"toggle-icon",children:l?"\u2212":"+"})]}),l&&(0,Ng.jsx)("div",{className:"notes-content",children:u.scaling_notes})]}),(0,Ng.jsxs)("div",{className:"scaled-recipe printable",children:[(0,Ng.jsxs)("h3",{children:[u.name," (Serves ",a,")"]}),(0,Ng.jsxs)("div",{className:"scaled-section",children:[(0,Ng.jsx)("h4",{children:"Ingredients"}),(0,Ng.jsx)("ul",{className:"scaled-ingredients",children:null===(t=u.ingredients)||void 0===t?void 0:t.map((e,t)=>(0,Ng.jsx)("li",{children:e},t))})]}),u.instructions&&(0,Ng.jsxs)("div",{className:"scaled-section",children:[(0,Ng.jsx)("h4",{children:"Instructions"}),(0,Ng.jsx)("div",{className:"scaled-instructions",children:"string"===typeof u.instructions?(0,Ng.jsx)("p",{children:u.instructions}):(0,Ng.jsx)("ol",{children:u.instructions.map((e,t)=>(0,Ng.jsx)("li",{children:e},t))})})]}),u.notes&&(0,Ng.jsxs)("div",{className:"scaled-section",children:[(0,Ng.jsx)("h4",{children:"Notes"}),(0,Ng.jsx)("p",{children:u.notes})]})]}),(0,Ng.jsxs)("div",{className:"scaler-actions",children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{window.print()},children:"\ud83d\udda8\ufe0f Print Scaled Recipe"}),s&&(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:()=>{s&&s(u)},children:"\ud83d\udcbe Save as New Recipe"}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:r,children:"Close"})]})]})}function hv(){const{id:e}=re(),t=ne(),{hasRole:n}=kg(),[r,s]=(0,i.useState)(null),[a,o]=(0,i.useState)(!0),[l,c]=(0,i.useState)(null),[u,d]=(0,i.useState)(!1),[h,f]=(0,i.useState)(!1),[p,m]=(0,i.useState)([]),[g,v]=(0,i.useState)([]),[y,b]=(0,i.useState)(null),[w,x]=(0,i.useState)(!1),[_,N]=(0,i.useState)(!1),[E,k]=(0,i.useState)(""),[S,C]=(0,i.useState)(!1);(0,i.useEffect)(()=>{j()},[e]);const j=async()=>{try{o(!0);const t=await Tp(jf(wg,"recipes",e));if(!t.exists())return void c("Recipe not found");const n={id:t.id,...t.data()};s(n);const[r,i]=await Promise.all([Mg(e),Fg(e)]);m(r),v(i)}catch(t){console.error("Error loading recipe:",t),c("Failed to load recipe")}finally{o(!1)}};return a?(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading recipe..."})]}):l?(0,Ng.jsxs)("div",{className:"error-container",children:[(0,Ng.jsx)("h2",{children:"Error"}),(0,Ng.jsx)("p",{children:l}),(0,Ng.jsx)(Te,{to:"/recipes",className:"btn btn-secondary",children:"Back to Recipes"})]}):r?(0,Ng.jsxs)("div",{className:"recipe-viewer",children:[(0,Ng.jsx)("div",{className:"recipe-header",children:(0,Ng.jsxs)("div",{className:"recipe-header-content",children:[(0,Ng.jsx)(Te,{to:"/recipes",className:"back-link",children:"\u2190 Back to Recipes"}),(0,Ng.jsx)("h1",{children:r.name||"Unnamed Recipe"}),(0,Ng.jsxs)("div",{className:"recipe-actions",children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>d(!u),children:"\ud83d\udcd0 Scale Recipe"}),n("user")&&(0,Ng.jsxs)(Ng.Fragment,{children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{t(`/recipes/${e}/edit`)},children:"\u270f\ufe0f Edit"}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>N(!0),children:"\u2795 Add Version"}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{t("/recipes/new",{state:{prefillData:r}})},children:"\ud83d\udccb Duplicate"}),(0,Ng.jsx)("button",{className:"btn btn-danger",onClick:()=>f(!0),children:"\ud83d\uddd1\ufe0f Delete"})]}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{window.print()},children:"\ud83d\udda8\ufe0f Print"}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{alert("PDF export coming soon!")},children:"\ud83d\udcc4 Export PDF"}),g.length>0&&(0,Ng.jsxs)("button",{className:"btn btn-secondary",onClick:()=>x(!w),children:["\ud83d\udcda Version History (",g.length,")"]})]}),p.length>0&&(0,Ng.jsxs)("div",{className:"version-selector",children:[(0,Ng.jsx)("label",{children:"View Version: "}),(0,Ng.jsxs)("select",{value:y||"",onChange:e=>{if(e.target.value){const t=p.find(t=>t.id===e.target.value);s(t),b(e.target.value)}else j(),b(null)},className:"version-dropdown",children:[(0,Ng.jsx)("option",{value:"",children:"Original Recipe"}),p.map(e=>(0,Ng.jsx)("option",{value:e.id,children:e.special_version},e.id))]})]})]})}),h&&(0,Ng.jsx)("div",{className:"modal-overlay",onClick:()=>f(!1),children:(0,Ng.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,Ng.jsx)("h3",{children:"Delete Recipe?"}),(0,Ng.jsxs)("p",{children:['Are you sure you want to delete "',r.name,'"? This action cannot be undone.']}),(0,Ng.jsxs)("div",{className:"modal-actions",children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>f(!1),children:"Cancel"}),(0,Ng.jsx)("button",{className:"btn btn-danger",onClick:async()=>{try{await Op(jf(wg,"recipes",e)),t("/recipes")}catch(n){console.error("Error deleting recipe:",n),alert("Failed to delete recipe")}},children:"Delete Recipe"})]})]})}),u&&(0,Ng.jsx)(dv,{recipe:r,onClose:()=>d(!1)}),w&&(0,Ng.jsx)("div",{className:"modal-overlay",onClick:()=>x(!1),children:(0,Ng.jsxs)("div",{className:"modal-content version-history-modal",onClick:e=>e.stopPropagation(),children:[(0,Ng.jsxs)("div",{className:"modal-header",children:[(0,Ng.jsx)("h3",{children:"Version History"}),(0,Ng.jsx)("button",{className:"close-button",onClick:()=>x(!1),children:"\u2715"})]}),(0,Ng.jsx)("div",{className:"version-history-list",children:0===g.length?(0,Ng.jsx)("p",{className:"empty-message",children:"No version history available"}):g.map(e=>{var t;return(0,Ng.jsxs)("div",{className:"version-item",children:[(0,Ng.jsxs)("div",{className:"version-header",children:[(0,Ng.jsx)("span",{className:"version-date",children:null!==(t=e.timestamp)&&void 0!==t&&t.toDate?new Date(e.timestamp.toDate()).toLocaleString():"Unknown date"}),e.edit_note&&(0,Ng.jsx)("span",{className:"version-note",children:e.edit_note})]}),(0,Ng.jsx)("button",{className:"btn btn-small",onClick:()=>{s(e),b(e.id),x(!1)},children:"View this version"})]},e.id)})})]})}),(0,Ng.jsx)("div",{className:"recipe-main",children:(0,Ng.jsxs)("div",{className:"recipe-content-grid",children:[(0,Ng.jsxs)("div",{className:"recipe-sidebar",children:[r.image_url&&(0,Ng.jsx)("div",{className:"recipe-hero-image",children:(0,Ng.jsx)("img",{src:r.image_url,alt:r.name})}),(0,Ng.jsxs)("div",{className:"recipe-info-card",children:[(0,Ng.jsx)("h3",{children:"Recipe Information"}),(0,Ng.jsxs)("div",{className:"info-item",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Serves:"}),(0,Ng.jsx)("span",{className:"info-value",children:r.serves||"Not specified"})]}),r.prep_time&&(0,Ng.jsxs)("div",{className:"info-item",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Prep Time:"}),(0,Ng.jsxs)("span",{className:"info-value",children:[r.prep_time," minutes"]})]}),r.cook_time&&(0,Ng.jsxs)("div",{className:"info-item",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Cook Time:"}),(0,Ng.jsxs)("span",{className:"info-value",children:[r.cook_time," minutes"]})]}),r.tags&&r.tags.length>0&&(0,Ng.jsxs)("div",{className:"info-item",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Tags:"}),(0,Ng.jsx)("div",{className:"tag-list",children:r.tags.map(e=>(0,Ng.jsx)("span",{className:"tag",children:e},e))})]}),r.allergens&&r.allergens.length>0&&(0,Ng.jsxs)("div",{className:"info-item allergen-section",children:[(0,Ng.jsx)("span",{className:"info-label",children:"\u26a0\ufe0f Contains:"}),(0,Ng.jsx)("div",{className:"allergen-list",children:r.allergens.map(e=>(0,Ng.jsx)("span",{className:"allergen",children:e},e))})]}),r.created_by&&(0,Ng.jsxs)("div",{className:"info-item",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Added by:"}),(0,Ng.jsx)("span",{className:"info-value",children:r.created_by})]}),r.created_at&&(0,Ng.jsxs)("div",{className:"info-item",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Date added:"}),(0,Ng.jsx)("span",{className:"info-value",children:new Date(1e3*r.created_at.seconds||r.created_at).toLocaleDateString()})]})]})]}),(0,Ng.jsxs)("div",{className:"recipe-details",children:[(0,Ng.jsxs)("section",{className:"recipe-section",children:[(0,Ng.jsx)("h2",{children:"Ingredients"}),(0,Ng.jsx)("div",{className:"ingredients-list",children:r.ingredients?"string"===typeof r.ingredients?(0,Ng.jsx)("div",{className:"ingredients-text",children:r.ingredients.split("\n").map((e,t)=>e.trim()&&(0,Ng.jsx)("p",{className:"ingredient-item",children:e},t))}):Array.isArray(r.ingredients)&&r.ingredients.length>0?(0,Ng.jsx)("ul",{children:r.ingredients.map((e,t)=>(0,Ng.jsx)("li",{className:"ingredient-item",children:e},t))}):(0,Ng.jsx)("p",{className:"empty-message",children:"No ingredients listed"}):(0,Ng.jsx)("p",{className:"empty-message",children:"No ingredients listed"})})]}),(0,Ng.jsxs)("section",{className:"recipe-section",children:[(0,Ng.jsx)("h2",{children:"Instructions"}),(0,Ng.jsx)("div",{className:"instructions",children:r.instructions?"string"===typeof r.instructions?(0,Ng.jsx)("div",{className:"instructions-text",children:r.instructions.split("\n").map((e,t)=>(0,Ng.jsx)("p",{children:e},t))}):Array.isArray(r.instructions)?(0,Ng.jsx)("ol",{className:"instructions-list",children:r.instructions.map((e,t)=>(0,Ng.jsx)("li",{className:"instruction-step",children:e},t))}):null:(0,Ng.jsx)("p",{className:"empty-message",children:"No instructions provided"})})]}),r.notes&&(0,Ng.jsxs)("section",{className:"recipe-section",children:[(0,Ng.jsx)("h2",{children:"Notes"}),(0,Ng.jsx)("div",{className:"recipe-notes",children:r.notes})]}),r.special_version&&(0,Ng.jsxs)("section",{className:"recipe-section",children:[(0,Ng.jsx)("h2",{children:"Special Version"}),(0,Ng.jsx)("div",{className:"special-version-badge",children:r.special_version})]})]})]})}),_&&(0,Ng.jsx)("div",{className:"modal-overlay",onClick:()=>N(!1),children:(0,Ng.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,Ng.jsx)("h3",{children:"Create Special Version"}),(0,Ng.jsx)("p",{children:"Create a dietary variant of this recipe (e.g., Gluten-Free, Vegan, etc.)"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{children:"Version Name"}),(0,Ng.jsx)("input",{type:"text",value:E,onChange:e=>k(e.target.value),placeholder:"e.g., Gluten-Free, Vegan, Dairy-Free",autoFocus:!0})]}),(0,Ng.jsxs)("div",{className:"modal-actions",children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{N(!1),k("")},disabled:S,children:"Cancel"}),(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:async()=>{if(E.trim()){C(!0);try{const t=r.parent_id||e,n=r.parent_id?await Tp(jf(wg,"recipes",t)):{data:()=>r};await Ug(t,n.data(),E.trim(),`Created ${E.trim()} version`),await j(),N(!1),k("")}catch(t){console.error("Error creating special version:",t),alert("Failed to create special version")}finally{C(!1)}}else alert("Please enter a name for the special version")},disabled:S||!E.trim(),children:S?"Creating...":"Create Version"})]})]})})]}):null}const fv=["Appetizer","Main Course","Side Dish","Dessert","Breakfast","Lunch","Dinner","Snack","Beverage","Vegetarian","Vegan","Quick & Easy","Make Ahead","Freezer Friendly","One Pot","Slow Cooker","Instant Pot","Grilled","Baked","No Cook"],pv=["Dairy","Eggs","Fish","Shellfish","Tree Nuts","Peanuts","Wheat","Soy","Sesame","Gluten"];function mv(){var e;const{id:t}=re(),n=ne(),r=ee(),{currentUser:s}=kg(),{selectedEventId:a}=jg(),o=!t,l=null===(e=r.state)||void 0===e?void 0:e.prefillData,[c,u]=(0,i.useState)({name:"",serves:4,prep_time:"",cook_time:"",ingredients:[""],instructions:"",notes:"",tags:[],allergens:[],image_url:"",special_version:""}),[d,h]=(0,i.useState)(!o),[f,p]=(0,i.useState)(!1),[m,g]=(0,i.useState)(null),[v,y]=(0,i.useState)(!1),[b,w]=(0,i.useState)(!1),[x,_]=(0,i.useState)({}),[N,E]=(0,i.useState)(!1),[k,S]=(0,i.useState)(""),[C,j]=(0,i.useState)(!1);(0,i.useEffect)(()=>{o&&l?u({...l,name:`${l.name} (Copy)`,id:void 0,created_at:void 0,created_by:void 0}):o||I()},[t,o,l]);const I=async()=>{try{h(!0);const e=await Tp(jf(wg,"recipes",t));if(!e.exists())return void g("Recipe not found");const n=e.data();u({name:n.name||"",serves:n.serves||4,prep_time:n.prep_time||"",cook_time:n.cook_time||"",ingredients:Array.isArray(n.ingredients)?n.ingredients:[""],instructions:n.instructions||"",notes:n.notes||"",tags:n.tags||[],allergens:n.allergens||[],image_url:n.image_url||"",special_version:n.special_version||""})}catch(e){console.error("Error loading recipe:",e),g("Failed to load recipe")}finally{h(!1)}},T=(e,t)=>{u(n=>({...n,[e]:t})),x[e]&&_(t=>{const n={...t};return delete n[e],n})},A=e=>{u(t=>({...t,tags:t.tags.includes(e)?t.tags.filter(t=>t!==e):[...t.tags,e]}))},R=e=>{u(t=>({...t,allergens:t.allergens.includes(e)?t.allergens.filter(t=>t!==e):[...t.allergens,e]}))};return d?(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading recipe..."})]}):m&&!o?(0,Ng.jsxs)("div",{className:"error-container",children:[(0,Ng.jsx)("h2",{children:"Error"}),(0,Ng.jsx)("p",{children:m}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>n("/recipes"),children:"Back to Recipes"})]}):(0,Ng.jsxs)("div",{className:"recipe-editor",children:[(0,Ng.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return c.name.trim()||(e.name="Recipe name is required"),(!c.serves||c.serves<1)&&(e.serves="Serving size must be at least 1"),c.ingredients.some(e=>e.trim())||(e.ingredients="At least one ingredient is required"),c.instructions.trim()||(e.instructions="Instructions are required"),_(e),0===Object.keys(e).length})()){p(!0),g(null);try{const e=c.ingredients.filter(e=>e.trim()),r={...c,ingredients:e,serves:parseInt(c.serves),prep_time:c.prep_time?parseInt(c.prep_time):null,cook_time:c.cook_time?parseInt(c.cook_time):null,ingredients_parsed:!0,updated_at:Vp()};if(o){r.created_at=Vp(),r.created_by=s.email;const e=jf(wg,"recipes").id;await Dp(jf(wg,"recipes",e),r),n(`/recipes/${e}`)}else{const e=await Tp(jf(wg,"recipes",t));e.exists()&&await async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const{special_version:r,...i}=t;return Lg(e,i,n,!1)}(t,e.data(),k||"Recipe updated"),await Pp(jf(wg,"recipes",t),r),o||c.special_version?n(`/recipes/${t}`):E(!0)}}catch(r){console.error("Error saving recipe:",r),g("Failed to save recipe. Please try again.")}finally{p(!1)}}},children:[(0,Ng.jsxs)("div",{className:"editor-header",children:[(0,Ng.jsx)("h1",{children:o?"Create New Recipe":"Edit Recipe"}),(0,Ng.jsxs)("div",{className:"editor-actions",children:[(0,Ng.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{window.confirm("Are you sure you want to cancel? Any unsaved changes will be lost.")&&n(t?`/recipes/${t}`:"/recipes")},disabled:f,children:"Cancel"}),(0,Ng.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:f,children:f?"Saving...":"Save Recipe"})]})]}),m&&(0,Ng.jsx)("div",{className:"error-message",children:m}),(0,Ng.jsxs)("div",{className:"editor-content",children:[(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Basic Information"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"name",children:"Recipe Name *"}),(0,Ng.jsx)("input",{id:"name",type:"text",value:c.name,onChange:e=>T("name",e.target.value),placeholder:"Enter recipe name",className:x.name?"error":""}),x.name&&(0,Ng.jsx)("span",{className:"field-error",children:x.name})]}),(0,Ng.jsxs)("div",{className:"form-row",children:[(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"serves",children:"Serves *"}),(0,Ng.jsx)("input",{id:"serves",type:"number",value:c.serves,onChange:e=>T("serves",e.target.value),min:"1",className:x.serves?"error":""}),x.serves&&(0,Ng.jsx)("span",{className:"field-error",children:x.serves})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"prep_time",children:"Prep Time (minutes)"}),(0,Ng.jsx)("input",{id:"prep_time",type:"number",value:c.prep_time,onChange:e=>T("prep_time",e.target.value),min:"0",placeholder:"Optional"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"cook_time",children:"Cook Time (minutes)"}),(0,Ng.jsx)("input",{id:"cook_time",type:"number",value:c.cook_time,onChange:e=>T("cook_time",e.target.value),min:"0",placeholder:"Optional"})]})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"image_url",children:"Image URL"}),(0,Ng.jsx)("input",{id:"image_url",type:"url",value:c.image_url,onChange:e=>T("image_url",e.target.value),placeholder:"https://example.com/image.jpg"}),c.image_url&&(0,Ng.jsx)("div",{className:"image-preview",children:(0,Ng.jsx)("img",{src:c.image_url,alt:"Recipe preview",onError:e=>e.target.style.display="none"})})]})]}),(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Ingredients *"}),x.ingredients&&(0,Ng.jsx)("span",{className:"field-error",children:x.ingredients}),(0,Ng.jsx)("div",{className:"ingredients-list",children:c.ingredients.map((e,t)=>(0,Ng.jsxs)("div",{className:"ingredient-row",children:[(0,Ng.jsxs)("span",{className:"ingredient-number",children:[t+1,"."]}),(0,Ng.jsx)("input",{type:"text",value:e,onChange:e=>((e,t)=>{const n=[...c.ingredients];n[e]=t,u(e=>({...e,ingredients:n}))})(t,e.target.value),placeholder:"Enter ingredient",className:"ingredient-input"}),c.ingredients.length>1&&(0,Ng.jsx)("button",{type:"button",className:"remove-btn",onClick:()=>(e=>{if(c.ingredients.length>1){const t=c.ingredients.filter((t,n)=>n!==e);u(e=>({...e,ingredients:t}))}})(t),title:"Remove ingredient",children:"\u2715"})]},t))}),(0,Ng.jsx)("button",{type:"button",className:"btn btn-secondary add-ingredient-btn",onClick:()=>{u(e=>({...e,ingredients:[...e.ingredients,""]}))},children:"+ Add Ingredient"})]}),(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Instructions *"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("textarea",{value:c.instructions,onChange:e=>T("instructions",e.target.value),placeholder:"Enter cooking instructions...",rows:"10",className:x.instructions?"error":""}),x.instructions&&(0,Ng.jsx)("span",{className:"field-error",children:x.instructions})]})]}),(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Notes"}),(0,Ng.jsx)("div",{className:"form-group",children:(0,Ng.jsx)("textarea",{value:c.notes,onChange:e=>T("notes",e.target.value),placeholder:"Optional notes, tips, or variations...",rows:"4"})})]}),(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Tags & Categories"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{children:"Tags"}),(0,Ng.jsxs)("div",{className:"tags-selector",children:[(0,Ng.jsxs)("div",{className:"selected-tags",children:[c.tags.map(e=>(0,Ng.jsxs)("span",{className:"selected-tag",children:[e,(0,Ng.jsx)("button",{type:"button",className:"remove-tag",onClick:()=>A(e),children:"\u2715"})]},e)),(0,Ng.jsx)("button",{type:"button",className:"add-tag-btn",onClick:()=>y(!v),children:"+ Add Tag"})]}),v&&(0,Ng.jsx)("div",{className:"tags-dropdown",children:fv.filter(e=>!c.tags.includes(e)).map(e=>(0,Ng.jsx)("button",{type:"button",className:"tag-option",onClick:()=>{A(e),y(!1)},children:e},e))})]})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{children:"Allergens"}),(0,Ng.jsxs)("div",{className:"allergens-selector",children:[(0,Ng.jsxs)("div",{className:"selected-allergens",children:[c.allergens.map(e=>(0,Ng.jsxs)("span",{className:"selected-allergen",children:["\u26a0\ufe0f ",e,(0,Ng.jsx)("button",{type:"button",className:"remove-allergen",onClick:()=>R(e),children:"\u2715"})]},e)),(0,Ng.jsx)("button",{type:"button",className:"add-allergen-btn",onClick:()=>w(!b),children:"+ Add Allergen"})]}),b&&(0,Ng.jsx)("div",{className:"allergens-dropdown",children:pv.filter(e=>!c.allergens.includes(e)).map(e=>(0,Ng.jsx)("button",{type:"button",className:"allergen-option",onClick:()=>{R(e),w(!1)},children:e},e))})]})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"special_version",children:"Special Version"}),(0,Ng.jsx)("input",{id:"special_version",type:"text",value:c.special_version,onChange:e=>T("special_version",e.target.value),placeholder:"e.g., Gluten-Free, Vegan, etc."})]}),!o&&(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"edit_note",children:"Edit Note (for version history)"}),(0,Ng.jsx)("input",{id:"edit_note",type:"text",value:k,onChange:e=>S(e.target.value),placeholder:"Brief description of changes made..."})]})]})]})]}),N&&(0,Ng.jsx)("div",{className:"modal-overlay",children:(0,Ng.jsxs)("div",{className:"modal-content",children:[(0,Ng.jsx)("h3",{children:"Create Special Version?"}),(0,Ng.jsx)("p",{children:"Would you like to save this as a special dietary version (e.g., Gluten-Free, Vegan)?"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{children:"Special Version Name"}),(0,Ng.jsx)("input",{type:"text",value:c.special_version,onChange:e=>T("special_version",e.target.value),placeholder:"e.g., Gluten-Free, Vegan, Dairy-Free",autoFocus:!0})]}),(0,Ng.jsxs)("div",{className:"modal-actions",children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{E(!1),n(`/recipes/${t}`)},children:"Skip"}),(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:async()=>{if(c.special_version.trim()){j(!0);try{await Ug(t,c,c.special_version.trim(),`Created ${c.special_version} version`),n(`/recipes/${t}`)}catch(e){console.error("Error creating special version:",e),alert("Failed to create special version")}finally{j(!1)}}else alert("Please enter a name for the special version")},disabled:C||!c.special_version.trim(),children:C?"Creating...":"Create Special Version"})]})]})})]})}function gv(e){let{onFileSelect:t,accept:n,multiple:r=!1}=e;const[s,a]=(0,i.useState)(!1),[o,l]=(0,i.useState)([]),c=(0,i.useRef)(null),u=e=>{if(r)l(e),t(e);else{const n=e[0];n&&(l([n]),t(n))}},d=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]};return(0,Ng.jsxs)("div",{className:"file-upload",children:[(0,Ng.jsxs)("div",{className:"upload-area "+(s?"dragging":""),onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),a(!0)},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),a(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),a(!1);const t=Array.from(e.dataTransfer.files);u(t)},onClick:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.click()},children:[(0,Ng.jsx)("input",{ref:c,type:"file",onChange:e=>{const t=Array.from(e.target.files);u(t)},accept:n,multiple:r,style:{display:"none"}}),(0,Ng.jsx)("div",{className:"upload-icon",children:"\ud83d\udcc1"}),(0,Ng.jsx)("p",{className:"upload-text",children:"Drag and drop files here, or click to browse"}),(0,Ng.jsx)("p",{className:"upload-hint",children:n?`Accepted formats: ${n}`:"All file types accepted"})]}),o.length>0&&(0,Ng.jsxs)("div",{className:"selected-files",children:[(0,Ng.jsx)("h4",{children:"Selected Files:"}),o.map((e,n)=>(0,Ng.jsxs)("div",{className:"file-item",children:[(0,Ng.jsx)("span",{className:"file-icon",children:"\ud83d\udcc4"}),(0,Ng.jsxs)("div",{className:"file-info",children:[(0,Ng.jsx)("span",{className:"file-name",children:e.name}),(0,Ng.jsx)("span",{className:"file-size",children:d(e.size)})]}),(0,Ng.jsx)("button",{type:"button",className:"remove-file",onClick:e=>{e.stopPropagation(),(e=>{const n=o.filter((t,n)=>n!==e);l(n),r?t(n):0===n.length&&t(null)})(n)},children:"\u2715"})]},n))]})]})}async function vv(e){const t=await async function(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=e=>{t(e.target.result)},r.onerror=e=>{n(new Error("Failed to read file"))},e.type.includes("image")?t("Mock text from image file"):r.readAsText(e)})}(e);return async function(e){await new Promise(e=>setTimeout(e,1500));let t="Imported Recipe";const n=e.match(/^(.+?)[\n\r]/);n&&(t=n[1].trim());let r=4;const i=e.match(/(?:serves?|servings?|yield)\s*:?\s*(\d+)/i);i&&(r=parseInt(i[1]));const s=[],a=e.match(/ingredients?:?([\s\S]*?)(?:instructions?|directions?|method|steps?:|$)/i);a&&a[1].split("\n").forEach(e=>{const t=e.trim().replace(/^[-\u2022*\d.)\s]+/,"");t&&t.length>3&&s.push(t)});let o="";const l=e.match(/(?:instructions?|directions?|method|steps?):?([\s\S]*?)$/i);l&&(o=l[1].trim());let c=null,u=null;const d=e.match(/prep(?:aration)?\s*time\s*:?\s*(\d+)\s*(?:min|minute)/i);d&&(c=parseInt(d[1]));const h=e.match(/cook(?:ing)?\s*time\s*:?\s*(\d+)\s*(?:min|minute)/i);h&&(u=parseInt(h[1]));const f=[],p=e.toLowerCase();return Object.entries({Dairy:["milk","cheese","butter","cream","yogurt"],Eggs:["egg","eggs"],Gluten:["flour","bread","pasta","wheat"],Nuts:["almond","walnut","pecan","cashew","pistachio"],Soy:["soy","tofu","tempeh"]}).forEach(e=>{let[t,n]=e;n.some(e=>p.includes(e))&&f.push(t)}),{name:t,serves:r,prep_time:c,cook_time:u,ingredients:s.filter(Boolean),instructions:o,allergens:[...new Set(f)],tags:[]}}(t)}function yv(){var e,t,n,r,s,a;const o=ne(),{currentUser:l}=kg(),[c,u]=(0,i.useState)("file"),[d,h]=(0,i.useState)(""),[f,p]=(0,i.useState)(!1),[m,g]=(0,i.useState)(null),[v,y]=(0,i.useState)(null),[b,w]=(0,i.useState)(!1),x=(e,t)=>{y(n=>({...n,[e]:t}))};return(0,Ng.jsxs)("div",{className:"recipe-import",children:[(0,Ng.jsxs)("div",{className:"import-header",children:[(0,Ng.jsx)("h1",{children:"Import Recipe"}),(0,Ng.jsx)("div",{className:"import-actions",children:(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{o("/recipes")},disabled:f,children:"Cancel"})})]}),(0,Ng.jsxs)("div",{className:"import-mode-selector",children:[(0,Ng.jsx)("button",{className:"mode-btn "+("file"===c?"active":""),onClick:()=>u("file"),children:"\ud83d\udcc1 From File"}),(0,Ng.jsx)("button",{className:"mode-btn "+("url"===c?"active":""),onClick:()=>u("url"),children:"\ud83c\udf10 From URL"})]}),(0,Ng.jsx)("div",{className:"import-input-section",children:"file"===c?(0,Ng.jsx)(gv,{onFileSelect:async e=>{if(e){p(!0),g(null);try{const t=await vv(e);y(t),w(!1)}catch(t){console.error("Error parsing file:",t),g("Failed to parse recipe from file. Please try a different format."),y(null)}finally{p(!1)}}else y(null)},accept:".pdf,.jpg,.jpeg,.png,.txt,.doc,.docx",multiple:!1}):(0,Ng.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),d.trim()){p(!0),g(null);try{const e=await async function(e){return await new Promise(e=>setTimeout(e,1500)),{name:"Recipe from "+new URL(e).hostname,serves:4,prep_time:15,cook_time:30,ingredients:["2 cups all-purpose flour","1 cup sugar","3 eggs","1/2 cup butter, melted","1 tsp vanilla extract","2 tsp baking powder","1/2 tsp salt"],instructions:"1. Preheat oven to 350\xb0F (175\xb0C).\n2. Mix dry ingredients in a large bowl.\n3. In another bowl, beat eggs and add melted butter and vanilla.\n4. Combine wet and dry ingredients until just mixed.\n5. Pour into prepared pan and bake for 25-30 minutes.\n6. Cool before serving.",allergens:["Dairy","Eggs","Gluten"],tags:["Baking","Dessert"]}}(d);y(e),w(!1)}catch(t){console.error("Error parsing URL:",t),g("Failed to parse recipe from URL. Please check the URL and try again."),y(null)}finally{p(!1)}}},className:"url-form",children:(0,Ng.jsxs)("div",{className:"url-input-group",children:[(0,Ng.jsx)("input",{type:"url",value:d,onChange:e=>h(e.target.value),placeholder:"Enter recipe URL (e.g., https://example.com/recipe)",className:"url-input",disabled:f}),(0,Ng.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:!d.trim()||f,children:f?"Parsing...":"Parse Recipe"})]})})}),m&&(0,Ng.jsx)("div",{className:"import-error",children:m}),f&&(0,Ng.jsxs)("div",{className:"processing-indicator",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Parsing recipe..."})]}),v&&!f&&(0,Ng.jsxs)("div",{className:"recipe-preview",children:[(0,Ng.jsxs)("div",{className:"preview-header",children:[(0,Ng.jsx)("h2",{children:"Recipe Preview"}),(0,Ng.jsx)("div",{className:"preview-actions",children:b?(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:()=>w(!1),children:"\u2713 Done Editing"}):(0,Ng.jsxs)(Ng.Fragment,{children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{w(!0)},children:"\u270f\ufe0f Edit"}),(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:async()=>{if(v){p(!0),g(null);try{const e={...v,created_at:Vp(),created_by:l.email,ingredients_parsed:!0},t=await Lp(Cf(wg,"recipes"),e);o(`/recipes/${t.id}`)}catch(e){console.error("Error saving recipe:",e),"permission-denied"===e.code?g("Permission denied. Please ensure you have the proper permissions to add recipes."):"unauthenticated"===e.code?g("You must be logged in to save recipes."):g(`Failed to save recipe: ${e.message||"Please try again."}`)}finally{p(!1)}}},children:"\ud83d\udcbe Save Recipe"})]})})]}),(0,Ng.jsxs)("div",{className:"preview-content",children:[(0,Ng.jsxs)("section",{className:"preview-section",children:[(0,Ng.jsx)("h3",{children:"Basic Information"}),b?(0,Ng.jsxs)(Ng.Fragment,{children:[(0,Ng.jsxs)("div",{className:"edit-field",children:[(0,Ng.jsx)("label",{children:"Recipe Name"}),(0,Ng.jsx)("input",{type:"text",value:v.name||"",onChange:e=>x("name",e.target.value)})]}),(0,Ng.jsxs)("div",{className:"edit-row",children:[(0,Ng.jsxs)("div",{className:"edit-field",children:[(0,Ng.jsx)("label",{children:"Serves"}),(0,Ng.jsx)("input",{type:"number",value:v.serves||4,onChange:e=>x("serves",parseInt(e.target.value)||4),min:"1"})]}),(0,Ng.jsxs)("div",{className:"edit-field",children:[(0,Ng.jsx)("label",{children:"Prep Time (min)"}),(0,Ng.jsx)("input",{type:"number",value:v.prep_time||"",onChange:e=>x("prep_time",parseInt(e.target.value)||null),min:"0"})]}),(0,Ng.jsxs)("div",{className:"edit-field",children:[(0,Ng.jsx)("label",{children:"Cook Time (min)"}),(0,Ng.jsx)("input",{type:"number",value:v.cook_time||"",onChange:e=>x("cook_time",parseInt(e.target.value)||null),min:"0"})]})]})]}):(0,Ng.jsxs)(Ng.Fragment,{children:[(0,Ng.jsxs)("p",{children:[(0,Ng.jsx)("strong",{children:"Name:"})," ",v.name||"Unnamed Recipe"]}),(0,Ng.jsxs)("p",{children:[(0,Ng.jsx)("strong",{children:"Serves:"})," ",v.serves||4]}),v.prep_time&&(0,Ng.jsxs)("p",{children:[(0,Ng.jsx)("strong",{children:"Prep Time:"})," ",v.prep_time," minutes"]}),v.cook_time&&(0,Ng.jsxs)("p",{children:[(0,Ng.jsx)("strong",{children:"Cook Time:"})," ",v.cook_time," minutes"]})]})]}),(0,Ng.jsxs)("section",{className:"preview-section",children:[(0,Ng.jsx)("h3",{children:"Ingredients"}),b?(0,Ng.jsxs)("div",{className:"edit-ingredients",children:[null===(e=v.ingredients)||void 0===e?void 0:e.map((e,t)=>(0,Ng.jsxs)("div",{className:"edit-ingredient-row",children:[(0,Ng.jsx)("input",{type:"text",value:e,onChange:e=>((e,t)=>{const n=[...v.ingredients];n[e]=t,x("ingredients",n)})(t,e.target.value)}),(0,Ng.jsx)("button",{type:"button",className:"remove-btn",onClick:()=>(e=>{const t=v.ingredients.filter((t,n)=>n!==e);x("ingredients",t)})(t),children:"\u2715"})]},t)),(0,Ng.jsx)("button",{type:"button",className:"btn btn-secondary add-btn",onClick:()=>{x("ingredients",[...v.ingredients,""])},children:"+ Add Ingredient"})]}):(0,Ng.jsx)("ul",{className:"ingredient-list",children:null===(t=v.ingredients)||void 0===t?void 0:t.map((e,t)=>(0,Ng.jsx)("li",{children:e},t))})]}),(0,Ng.jsxs)("section",{className:"preview-section",children:[(0,Ng.jsx)("h3",{children:"Instructions"}),b?(0,Ng.jsx)("textarea",{value:v.instructions||"",onChange:e=>x("instructions",e.target.value),rows:"10",className:"edit-textarea"}):(0,Ng.jsx)("div",{className:"instructions-preview",children:"string"===typeof v.instructions?v.instructions.split("\n").map((e,t)=>(0,Ng.jsx)("p",{children:e},t)):Array.isArray(v.instructions)?(0,Ng.jsx)("ol",{children:v.instructions.map((e,t)=>(0,Ng.jsx)("li",{children:e},t))}):null})]}),((null===(n=v.tags)||void 0===n?void 0:n.length)>0||(null===(r=v.allergens)||void 0===r?void 0:r.length)>0)&&(0,Ng.jsxs)("section",{className:"preview-section",children:[(0,Ng.jsx)("h3",{children:"Tags & Allergens"}),(null===(s=v.tags)||void 0===s?void 0:s.length)>0&&(0,Ng.jsxs)("div",{className:"preview-tags",children:[(0,Ng.jsx)("strong",{children:"Tags:"}),v.tags.map(e=>(0,Ng.jsx)("span",{className:"preview-tag",children:e},e))]}),(null===(a=v.allergens)||void 0===a?void 0:a.length)>0&&(0,Ng.jsxs)("div",{className:"preview-allergens",children:[(0,Ng.jsx)("strong",{children:"Contains:"}),v.allergens.map(e=>(0,Ng.jsxs)("span",{className:"preview-allergen",children:["\u26a0\ufe0f ",e]},e))]})]})]})]})]})}function bv(){const e=ne(),{hasRole:t}=kg(),[n,r]=(0,i.useState)([]),[s,a]=(0,i.useState)(!0),[o,l]=(0,i.useState)("upcoming"),[c,u]=(0,i.useState)("");(0,i.useEffect)(()=>{const e=Mp(fp(Cf(wg,"events"),yp("start_date","desc")),e=>{console.log("Events snapshot received:",e.size,"documents");const t=e.docs.map(e=>({id:e.id,...e.data()}));console.log("Events data:",t),r(t),a(!1)},e=>{console.error("Error fetching events:",e),a(!1)});return()=>e()},[]);const d=n.filter(e=>{var t;if(c){var n,r,i;const t=c.toLowerCase(),s=null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(t),a=null===(r=e.client_name)||void 0===r?void 0:r.toLowerCase().includes(t),o=null===(i=e.venue)||void 0===i?void 0:i.toLowerCase().includes(t);if(!s&&!a&&!o)return!1}const s=e.event_date||e.start_date,a=(null===s||void 0===s||null===(t=s.toDate)||void 0===t?void 0:t.call(s))||new Date(s),l=new Date;return l.setHours(0,0,0,0),"upcoming"===o?a>=l:"past"!==o||a<l}),h=()=>{e("/events/new")},f=e=>{var t;if(!e)return"No date";return((null===(t=e.toDate)||void 0===t?void 0:t.call(e))||new Date(e)).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})},p=e=>{var t;const n=e.event_date||e.start_date,r=(null===n||void 0===n||null===(t=n.toDate)||void 0===t?void 0:t.call(n))||new Date(n),i=new Date;if(i.setHours(0,0,0,0),r<i)return"past";if(r.toDateString()===i.toDateString())return"today";return Math.ceil((r-i)/864e5)<=7?"soon":"upcoming"};return s?(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading events..."})]}):(0,Ng.jsxs)("div",{className:"event-list",children:[(0,Ng.jsxs)("div",{className:"event-list-header",children:[(0,Ng.jsx)("h1",{children:"Events"}),t("user")&&(0,Ng.jsxs)("button",{className:"btn btn-primary",onClick:h,children:[(0,Ng.jsx)("span",{className:"btn-icon",children:"\u2795"}),"New Event"]})]}),(0,Ng.jsxs)("div",{className:"event-filters",children:[(0,Ng.jsxs)("div",{className:"search-bar",children:[(0,Ng.jsx)("span",{className:"search-icon",children:"\ud83d\udd0d"}),(0,Ng.jsx)("input",{type:"text",placeholder:"Search events, clients, or venues...",value:c,onChange:e=>u(e.target.value),className:"search-input"}),c&&(0,Ng.jsx)("button",{className:"clear-search",onClick:()=>u(""),children:"\u2715"})]}),(0,Ng.jsxs)("div",{className:"filter-tabs",children:[(0,Ng.jsx)("button",{className:"filter-tab "+("upcoming"===o?"active":""),onClick:()=>l("upcoming"),children:"Upcoming"}),(0,Ng.jsx)("button",{className:"filter-tab "+("all"===o?"active":""),onClick:()=>l("all"),children:"All Events"}),(0,Ng.jsx)("button",{className:"filter-tab "+("past"===o?"active":""),onClick:()=>l("past"),children:"Past"})]})]}),(0,Ng.jsxs)("div",{className:"results-summary",children:["Showing ",d.length," ","all"===o?"":o," events"]}),(0,Ng.jsx)("div",{className:"events-grid",children:d.map(t=>(0,Ng.jsx)(wv,{event:t,status:p(t),onClick:()=>{return n=t.id,void e(`/events/${n}`);var n},formatDate:f},t.id))}),0===d.length&&(0,Ng.jsxs)("div",{className:"empty-state",children:[(0,Ng.jsx)("p",{children:"No events found."}),t("user")&&"upcoming"===o&&(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:h,children:"Create Your First Event"})]})]})}function wv(e){let{event:t,status:n,onClick:r,formatDate:i}=e;const s=()=>{switch(n){case"past":return"status-past";case"today":return"status-today";case"soon":return"status-soon";default:return"status-upcoming"}};return(0,Ng.jsxs)("div",{className:`event-card ${s()}`,onClick:r,children:[(0,Ng.jsx)("div",{className:"event-card-header",children:(0,Ng.jsx)("span",{className:`event-status ${s()}`,children:(()=>{switch(n){case"past":return"Past";case"today":return"Today!";case"soon":return"This Week";default:return"Upcoming"}})()})}),(0,Ng.jsxs)("div",{className:"event-card-body",children:[(0,Ng.jsx)("h3",{className:"event-name",children:t.name||"Unnamed Event"}),(0,Ng.jsxs)("div",{className:"event-details",children:[(0,Ng.jsxs)("div",{className:"event-detail",children:[(0,Ng.jsx)("span",{className:"detail-icon",children:"\ud83d\udcc5"}),(0,Ng.jsx)("span",{children:i(t.event_date||t.start_date)})]}),t.client_name&&(0,Ng.jsxs)("div",{className:"event-detail",children:[(0,Ng.jsx)("span",{className:"detail-icon",children:"\ud83d\udc64"}),(0,Ng.jsx)("span",{children:t.client_name})]}),t.venue&&(0,Ng.jsxs)("div",{className:"event-detail",children:[(0,Ng.jsx)("span",{className:"detail-icon",children:"\ud83d\udccd"}),(0,Ng.jsx)("span",{children:t.venue})]}),(0,Ng.jsxs)("div",{className:"event-detail",children:[(0,Ng.jsx)("span",{className:"detail-icon",children:"\ud83d\udc65"}),(0,Ng.jsxs)("span",{children:[t.guest_count||"?"," guests"]})]}),t.website&&(0,Ng.jsxs)("div",{className:"event-detail",children:[(0,Ng.jsx)("span",{className:"detail-icon",children:"\ud83c\udf10"}),(0,Ng.jsx)("span",{children:"Has Website"})]})]}),t.flyer_url&&(0,Ng.jsx)("div",{className:"event-flyer-indicator",children:"\ud83d\udcc4 Has Flyer"}),t.allergens&&t.allergens.length>0&&(0,Ng.jsxs)("div",{className:"event-allergens",children:[t.allergens.slice(0,3).map(e=>(0,Ng.jsxs)("span",{className:"allergen-tag",children:["\u26a0\ufe0f ",e]},e)),t.allergens.length>3&&(0,Ng.jsxs)("span",{className:"allergen-tag",children:["+",t.allergens.length-3," more"]})]})]})]})}function xv(){var e,t;const{id:n}=re(),r=ne(),{hasRole:s}=kg(),{menus:a}=jg(),[o,l]=(0,i.useState)(null),[c,u]=(0,i.useState)([]),[d,h]=(0,i.useState)([]),[f,p]=(0,i.useState)(!0),[m,g]=(0,i.useState)(null),[v,y]=(0,i.useState)(!1),[b,w]=(0,i.useState)("overview");(0,i.useEffect)(()=>{x(),_(),N()},[n]);const x=async()=>{try{p(!0);const e=await Tp(jf(wg,"events",n));if(!e.exists())return void g("Event not found");l({id:e.id,...e.data()})}catch(e){console.error("Error loading event:",e),g("Failed to load event")}finally{p(!1)}},_=()=>{const e=Mp(fp(Cf(wg,"events",n,"allergies")),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));u(t)});return()=>e()},N=()=>{const e=Mp(fp(Cf(wg,"menus"),mp("event_id","==",n)),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));h(t)});return()=>e()},E=e=>e||"No time";if(f)return(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading event..."})]});if(m)return(0,Ng.jsxs)("div",{className:"error-container",children:[(0,Ng.jsx)("h2",{children:"Error"}),(0,Ng.jsx)("p",{children:m}),(0,Ng.jsx)(Te,{to:"/events",className:"btn btn-secondary",children:"Back to Events"})]});if(!o)return null;return(0,Ng.jsxs)("div",{className:"event-viewer",children:[(0,Ng.jsx)("div",{className:"event-header",children:(0,Ng.jsxs)("div",{className:"event-header-content",children:[(0,Ng.jsx)(Te,{to:"/events",className:"back-link",children:"\u2190 Back to Events"}),(0,Ng.jsx)("div",{className:"event-title-row",children:(0,Ng.jsx)("h1",{children:o.name||"Unnamed Event"})}),(0,Ng.jsx)("div",{className:"event-actions",children:s("user")&&(0,Ng.jsxs)(Ng.Fragment,{children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{r(`/events/${n}/edit`)},children:"\u270f\ufe0f Edit"}),(0,Ng.jsx)("button",{className:"btn btn-danger",onClick:()=>y(!0),children:"\ud83d\uddd1\ufe0f Delete"})]})})]})}),v&&(0,Ng.jsx)("div",{className:"modal-overlay",onClick:()=>y(!1),children:(0,Ng.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,Ng.jsx)("h3",{children:"Delete Event?"}),(0,Ng.jsxs)("p",{children:['Are you sure you want to delete "',o.name,'"? This action cannot be undone.']}),(0,Ng.jsxs)("div",{className:"modal-actions",children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>y(!1),children:"Cancel"}),(0,Ng.jsx)("button",{className:"btn btn-danger",onClick:async()=>{try{await Op(jf(wg,"events",n)),r("/events")}catch(e){console.error("Error deleting event:",e),alert("Failed to delete event")}},children:"Delete Event"})]})]})}),(0,Ng.jsxs)("div",{className:"event-tabs",children:[(0,Ng.jsx)("button",{className:"tab "+("overview"===b?"active":""),onClick:()=>w("overview"),children:"Overview"}),(0,Ng.jsx)("button",{className:"tab "+("details"===b?"active":""),onClick:()=>w("details"),children:"Details"}),(0,Ng.jsxs)("button",{className:"tab "+("allergies"===b?"active":""),onClick:()=>w("allergies"),children:["Allergies (",c.length,")"]}),(0,Ng.jsx)("button",{className:"tab "+("timeline"===b?"active":""),onClick:()=>w("timeline"),children:"Timeline"}),(0,Ng.jsx)("button",{className:"tab "+("menus"===b?"active":""),onClick:()=>w("menus"),children:"Menus"})]}),(0,Ng.jsxs)("div",{className:"event-content",children:["overview"===b&&(0,Ng.jsxs)("div",{className:"overview-grid",children:[(0,Ng.jsxs)("div",{className:"info-card",children:[(0,Ng.jsx)("h2",{children:"Event Information"}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Date:"}),(0,Ng.jsx)("span",{className:"info-value",children:(e=>{var t;if(!e)return"No date";return((null===(t=e.toDate)||void 0===t?void 0:t.call(e))||new Date(e)).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})(o.event_date)})]}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Time:"}),(0,Ng.jsxs)("span",{className:"info-value",children:[E(o.start_time)," - ",E(o.end_time)]})]}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Event Mode:"}),(0,Ng.jsx)("span",{className:"info-value status-badge event-mode-off",children:"Off"})]}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Guest Count:"}),(0,Ng.jsx)("span",{className:"info-value",children:o.guest_count||"Not specified"})]}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Staff Count:"}),(0,Ng.jsx)("span",{className:"info-value",children:o.staff_count||"Not specified"})]})]}),(0,Ng.jsxs)("div",{className:"info-card",children:[(0,Ng.jsx)("h2",{children:"Client Information"}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Name:"}),(0,Ng.jsx)("span",{className:"info-value",children:o.client_name||"Not specified"})]}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Email:"}),(0,Ng.jsx)("span",{className:"info-value",children:o.client_email?(0,Ng.jsx)("a",{href:`mailto:${o.client_email}`,children:o.client_email}):"Not specified"})]}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Phone:"}),(0,Ng.jsx)("span",{className:"info-value",children:o.client_phone?(0,Ng.jsx)("a",{href:`tel:${o.client_phone}`,children:o.client_phone}):"Not specified"})]}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Website:"}),(0,Ng.jsx)("span",{className:"info-value",children:o.website?(0,Ng.jsx)("a",{href:o.website,target:"_blank",rel:"noopener noreferrer",children:o.website}):"Not specified"})]})]}),(0,Ng.jsxs)("div",{className:"info-card",children:[(0,Ng.jsx)("h2",{children:"Venue Information"}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Venue:"}),(0,Ng.jsx)("span",{className:"info-value",children:o.venue||"Not specified"})]}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Address:"}),(0,Ng.jsx)("span",{className:"info-value",children:o.venue_address||"Not specified"})]}),o.venue_contact&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Contact:"}),(0,Ng.jsx)("span",{className:"info-value",children:o.venue_contact})]})]}),(0,Ng.jsxs)("div",{className:"info-card",children:[(0,Ng.jsx)("h2",{children:"Quick Stats"}),(0,Ng.jsxs)("div",{className:"stats-grid",children:[(0,Ng.jsxs)("div",{className:"stat",children:[(0,Ng.jsx)("span",{className:"stat-value",children:(null===(e=o.allergens)||void 0===e?void 0:e.length)||0}),(0,Ng.jsx)("span",{className:"stat-label",children:"Allergens"})]}),(0,Ng.jsxs)("div",{className:"stat",children:[(0,Ng.jsx)("span",{className:"stat-value",children:c.length}),(0,Ng.jsx)("span",{className:"stat-label",children:"Individual Allergies"})]}),(0,Ng.jsxs)("div",{className:"stat",children:[(0,Ng.jsx)("span",{className:"stat-value",children:(null===(t=o.menu_items)||void 0===t?void 0:t.length)||0}),(0,Ng.jsx)("span",{className:"stat-label",children:"Menu Items"})]})]})]})]}),"details"===b&&(0,Ng.jsx)("div",{className:"details-section",children:(0,Ng.jsxs)("div",{className:"details-card",children:[(0,Ng.jsx)("h2",{children:"Event Details"}),o.description&&(0,Ng.jsxs)("div",{className:"detail-block",children:[(0,Ng.jsx)("h3",{children:"Description"}),(0,Ng.jsx)("p",{children:o.description})]}),o.notes&&(0,Ng.jsxs)("div",{className:"detail-block",children:[(0,Ng.jsx)("h3",{children:"Notes"}),(0,Ng.jsx)("p",{children:o.notes})]}),o.special_requests&&(0,Ng.jsxs)("div",{className:"detail-block",children:[(0,Ng.jsx)("h3",{children:"Special Requests"}),(0,Ng.jsx)("p",{children:o.special_requests})]}),o.flyer_url&&(0,Ng.jsxs)("div",{className:"detail-block",children:[(0,Ng.jsx)("h3",{children:"Event Flyer/Invitation"}),(0,Ng.jsx)("a",{href:o.flyer_url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-secondary",children:"\ud83d\udcc4 View Flyer"})]}),!o.description&&!o.notes&&!o.special_requests&&!o.flyer_url&&(0,Ng.jsx)("p",{className:"empty-message",children:"No additional details available."})]})}),"allergies"===b&&(0,Ng.jsxs)("div",{className:"allergies-section",children:[(0,Ng.jsxs)("div",{className:"allergies-header",children:[(0,Ng.jsx)("h2",{children:"Allergy Management"}),s("user")&&(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:()=>r(`/events/${n}/allergies`),children:"\u2795 Add Allergy"})]}),o.allergens&&o.allergens.length>0&&(0,Ng.jsxs)("div",{className:"allergen-summary",children:[(0,Ng.jsx)("h3",{children:"Summary of All Allergens"}),(0,Ng.jsx)("div",{className:"allergen-tags",children:o.allergens.map(e=>(0,Ng.jsxs)("span",{className:"allergen-tag large",children:["\u26a0\ufe0f ",e]},e))})]}),c.length>0?(0,Ng.jsxs)("div",{className:"allergies-list",children:[(0,Ng.jsxs)("h3",{children:["Individual Allergies (",c.length,")"]}),c.slice(0,5).map(e=>{var t;return(0,Ng.jsx)("div",{className:"allergy-item",children:(0,Ng.jsxs)("div",{className:"allergy-info",children:[(0,Ng.jsx)("h4",{children:e.guest_name}),(0,Ng.jsxs)("div",{className:"allergy-details",children:[(0,Ng.jsxs)("span",{children:["Severity: ",e.severity||"Not specified"]}),e.notes&&(0,Ng.jsxs)("span",{children:["Notes: ",e.notes]})]}),(0,Ng.jsx)("div",{className:"allergy-allergens",children:null===(t=e.allergens)||void 0===t?void 0:t.map(e=>(0,Ng.jsx)("span",{className:"allergen-tag",children:e},e))})]})},e.id)}),c.length>5&&(0,Ng.jsxs)("p",{className:"more-allergies",children:["And ",c.length-5," more..."]})]}):(0,Ng.jsx)("p",{className:"empty-message",children:"No individual allergies recorded yet."})]}),"timeline"===b&&(0,Ng.jsxs)("div",{className:"timeline-section",children:[(0,Ng.jsx)("h2",{children:"Event Timeline"}),o.timeline&&o.timeline.length>0?(0,Ng.jsx)("div",{className:"timeline",children:o.timeline.map((e,t)=>(0,Ng.jsxs)("div",{className:"timeline-item",children:[(0,Ng.jsx)("div",{className:"timeline-time",children:e.time}),(0,Ng.jsxs)("div",{className:"timeline-content",children:[(0,Ng.jsx)("h4",{children:e.activity}),e.notes&&(0,Ng.jsx)("p",{children:e.notes})]})]},t))}):(0,Ng.jsx)("p",{className:"empty-message",children:"No timeline created yet."})]}),"menus"===b&&(0,Ng.jsxs)("div",{className:"menus-section",children:[(0,Ng.jsxs)("div",{className:"menus-header",children:[(0,Ng.jsx)("h2",{children:"Event Menus"}),s("user")&&(0,Ng.jsx)("button",{onClick:()=>r("/menus/new",{state:{eventId:n}}),className:"btn btn-primary",children:"+ Add Menu"})]}),d.length>0?(0,Ng.jsx)("div",{className:"menus-grid",children:d.map(e=>{var t,n;return(0,Ng.jsxs)("div",{className:"menu-card",children:[(0,Ng.jsxs)("div",{className:"menu-card-header",children:[(0,Ng.jsx)("h3",{children:e.name}),(0,Ng.jsx)("span",{className:"menu-type",children:e.type})]}),e.description&&(0,Ng.jsx)("p",{className:"menu-description",children:e.description}),(0,Ng.jsxs)("div",{className:"menu-stats",children:[(0,Ng.jsxs)("span",{children:[(null===(t=e.sections)||void 0===t?void 0:t.length)||0," sections"]}),(0,Ng.jsxs)("span",{children:[(null===(n=e.sections)||void 0===n?void 0:n.reduce((e,t)=>{var n;return e+((null===(n=t.items)||void 0===n?void 0:n.length)||0)},0))||0," items"]})]}),(0,Ng.jsxs)("div",{className:"menu-actions",children:[(0,Ng.jsx)(Te,{to:`/menus/${e.id}`,className:"btn btn-secondary btn-sm",children:"View"}),s("user")&&(0,Ng.jsx)(Te,{to:`/menus/${e.id}/edit`,className:"btn btn-secondary btn-sm",children:"Edit"})]})]},e.id)})}):(0,Ng.jsxs)("div",{className:"empty-state",children:[(0,Ng.jsx)("p",{children:"No menus created for this event yet."}),s("user")&&(0,Ng.jsx)("button",{onClick:()=>r("/menus/new",{state:{eventId:n}}),className:"btn btn-primary",children:"Create First Menu"})]})]})]})]})}async function _v(e){if(await new Promise(e=>setTimeout(e,1500)),!e||0===e.trim().length)return{};const t={},n=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n").map(e=>e.trim()).filter(e=>e.length>0);for(let u=0;u<Math.min(5,n.length);u++){const e=n[u];if(e.length<100&&!e.match(/^(date|time|when|where|location|venue|rsvp|email|phone|website)/i)&&!e.match(/^\d/)&&e.length>5){t.name=e;break}}const r=[/(\d{1,2})[\\/\\-\\.](\d{1,2})[\\/\\-\\.](\d{2,4})/,/(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{1,2}),?\s+(\d{4})/i,/(\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December),?\s+(\d{4})/i,/(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday),?\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{1,2}),?\s+(\d{4})/i];for(const u of r){const n=e.match(u);if(n)try{const e=new Date(n[0]);if(!isNaN(e.getTime())){t.event_date=e.toISOString().split("T")[0];break}}catch(Bw){}}const i=[/(\d{1,2}):(\d{2})\s*(AM|PM|am|pm|a\.m\.|p\.m\.)/,/(\d{1,2})\s*(AM|PM|am|pm|a\.m\.|p\.m\.)/,/(\d{1,2}):(\d{2})\s*-\s*(\d{1,2}):(\d{2})\s*(AM|PM|am|pm)?/];for(const u of i){const n=e.match(u);if(n){t.start_time=n[0].split("-")[0].trim();break}}const s=[/(?:venue|location|where|at|held at|taking place at)[\s:]+(.+?)(?:\n|$)/i,/(?:^|\n)at\s+(.+?)(?:\n|$)/i];for(const u of s){const n=e.match(u);if(n&&n[1].length<100){t.venue=n[1].trim();break}}const a=[/(\d+\s+[\w\s]+(?:Street|St|Avenue|Ave|Road|Rd|Boulevard|Blvd|Lane|Ln|Drive|Dr|Court|Ct|Place|Pl|Way|Circle|Cir)\.?(?:,?\s*(?:Suite|Ste|Unit|Apt)\.?\s*[\w\d]+)?[\w\s,]*\d{5}(?:-\d{4})?)/i,/(\d+\s+[\w\s]+,\s*[\w\s]+,\s*[A-Z]{2}\s+\d{5})/i];for(const u of a){const n=e.match(u);if(n){t.venue_address=n[0].trim();break}}const o=[/(\d+)\s*(?:guests?|people|attendees|seats|capacity)/i,/(?:guests?|people|attendees|seats|capacity)[\s:]+(\d+)/i];for(const u of o){const n=e.match(u);if(n){const e=parseInt(n[1]);if(!isNaN(e)&&e>0&&e<1e4){t.guest_count=e;break}}}const l=[/(?:website|web|online|visit us at|more info)[\s:]+(?:https?:\/\/)?(?:www\.)?([a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)+(?:\/[^\s]*)?)/i,/(?:https?:\/\/)?(?:www\.)?([a-zA-Z0-9-]+\.[a-zA-Z]{2,}(?:\/[^\s]*)?)/];for(const u of l){const n=e.match(u);if(n){let e=n[0];e.match(/^(website|web|online|visit)/i)&&(e=e.replace(/^[^:]+:\s*/,"")),e.startsWith("http")||(e="https://"+e),t.website=e;break}}const c=n.filter(e=>e.length>30&&!e.match(/^(date|time|when|where|location|venue|rsvp|email|phone|website):/i)&&!e.match(/^\d+\s+\w+\s+(Street|St|Avenue|Ave|Road|Rd)/));return c.length>0&&(t.description=c.slice(0,3).join(" ").substring(0,500)),t}async function Nv(e){try{if(e.type.includes("text")){const t=await Ev(e);if(t)return _v(t)}const t=await async function(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=()=>{const e=r.result.split(",")[1];t(e)},r.onerror=n,r.readAsDataURL(e)})}(e),n=vg(_g,"parseEventFlyer"),r=await n({fileData:t,mimeType:e.type});if(r.data.success)return r.data.event;throw new Error("Failed to parse event flyer")}catch(r){var t,n;if(console.error("Error parsing event file:",r),"functions/not-found"===r.code||null!==(t=r.message)&&void 0!==t&&t.includes("404")){console.warn("AI parsing function not deployed. Using fallback parser.");const t=await Ev(e);if(t)return _v(t)}if(e.type.includes("text")){const t=await Ev(e);if(t)return _v(t)}if("functions/not-found"===r.code||null!==(n=r.message)&&void 0!==n&&n.includes("404"))throw new Error("AI parsing is not available yet. For now, text files can be parsed locally, but images and PDFs require the AI service to be deployed. Please enter details manually or use a text file.");throw new Error("Unable to parse event details from this file. Please try a different file or enter details manually.")}}async function Ev(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=e=>{t(e.target.result)},r.onerror=e=>{n(new Error("Failed to read file"))},e.type.includes("image")?(console.warn("Image files require OCR service for text extraction. Please use a text-based file or fill in details manually."),t("")):"application/pdf"===e.type?(console.warn("PDF files require special parsing. Please use a text file or fill in details manually."),t("")):r.readAsText(e)})}function kv(){const{id:e}=re(),t=ne(),{currentUser:n}=kg(),r=!e,[s,a]=(0,i.useState)({name:"",event_date:"",start_time:"",end_time:"",guest_count:"",client_name:"",client_email:"",client_phone:"",website:"",venue:"",venue_address:"",venue_contact:"",description:"",notes:"",special_requests:"",budget:"",status:"planning",flyer_url:""}),[o,l]=(0,i.useState)(!r),[c,u]=(0,i.useState)(!1),[d,h]=(0,i.useState)(null),[f,p]=(0,i.useState)({}),[m,g]=(0,i.useState)(null),[v,y]=(0,i.useState)(!1),[b,w]=(0,i.useState)(!1);(0,i.useEffect)(()=>{r||x()},[e,r]);const x=async()=>{try{l(!0);const r=await Tp(jf(wg,"events",e));if(!r.exists())return void h("Event not found");const i=r.data();let s="";if(i.event_date){var t,n;s=((null===(t=(n=i.event_date).toDate)||void 0===t?void 0:t.call(n))||new Date(i.event_date)).toISOString().split("T")[0]}a({name:i.name||"",event_date:s,start_time:i.start_time||"",end_time:i.end_time||"",guest_count:i.guest_count||"",client_name:i.client_name||"",client_email:i.client_email||"",client_phone:i.client_phone||"",website:i.website||"",venue:i.venue||"",venue_address:i.venue_address||"",venue_contact:i.venue_contact||"",description:i.description||"",notes:i.notes||"",special_requests:i.special_requests||"",budget:i.budget||"",status:i.status||"planning",flyer_url:i.flyer_url||""})}catch(r){console.error("Error loading event:",r),h("Failed to load event")}finally{l(!1)}},_=(e,t)=>{a(n=>({...n,[e]:t})),f[e]&&p(t=>{const n={...t};return delete n[e],n})},N=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);return o?(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading event..."})]}):d&&!r?(0,Ng.jsxs)("div",{className:"error-container",children:[(0,Ng.jsx)("h2",{children:"Error"}),(0,Ng.jsx)("p",{children:d}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>t("/events"),children:"Back to Events"})]}):(0,Ng.jsx)("div",{className:"event-editor",children:(0,Ng.jsxs)("form",{onSubmit:async i=>{if(i.preventDefault(),(()=>{const e={};return s.name.trim()||(e.name="Event name is required"),s.event_date||(e.event_date="Event date is required"),s.client_name.trim()||(e.client_name="Client name is required"),s.client_email&&!N(s.client_email)&&(e.client_email="Invalid email address"),s.guest_count&&s.guest_count<1&&(e.guest_count="Guest count must be at least 1"),p(e),0===Object.keys(e).length})()){u(!0),h(null);try{const i=new Date(s.event_date);i.setHours(12,0,0,0);let c=s.flyer_url;if(m){y(!0);try{const t=(a=xg,o=`events/${r?"new":e}/flyers/${m.name}`,Ym(a=st(a),o)),n=await function(e,t,n){return Wm(e=st(e),t,n)}(t,m);c=await function(e){return Km(e=st(e))}(n.ref)}catch(l){console.error("Error uploading flyer:",l),h("Failed to upload flyer. Event will be saved without it.")}finally{y(!1)}}const u={...s,event_date:i,guest_count:s.guest_count?parseInt(s.guest_count):null,budget:s.budget?parseFloat(s.budget):null,flyer_url:c,updated_at:Vp()};if(r){u.created_at=Vp(),u.created_by=n.email,u.allergens=[];const e=jf(wg,"events").id;await Dp(jf(wg,"events",e),u),t(`/events/${e}`)}else await Pp(jf(wg,"events",e),u),t(`/events/${e}`)}catch(c){console.error("Error saving event:",c),h("Failed to save event. Please try again.")}finally{u(!1)}var a,o}},children:[(0,Ng.jsxs)("div",{className:"editor-header",children:[(0,Ng.jsx)("h1",{children:r?"Create New Event":"Edit Event"}),(0,Ng.jsxs)("div",{className:"editor-actions",children:[(0,Ng.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{window.confirm("Are you sure you want to cancel? Any unsaved changes will be lost.")&&t(e?`/events/${e}`:"/events")},disabled:c,children:"Cancel"}),(0,Ng.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:c,children:c?"Saving...":"Save Event"})]})]}),d&&(0,Ng.jsx)("div",{className:"error-message",children:d}),(0,Ng.jsxs)("div",{className:"editor-content",children:[(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Event Information"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"name",children:"Event Name *"}),(0,Ng.jsx)("input",{id:"name",type:"text",value:s.name,onChange:e=>_("name",e.target.value),placeholder:"Enter event name",className:f.name?"error":""}),f.name&&(0,Ng.jsx)("span",{className:"field-error",children:f.name})]}),(0,Ng.jsxs)("div",{className:"form-row",children:[(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"event_date",children:"Event Date *"}),(0,Ng.jsx)("input",{id:"event_date",type:"date",value:s.event_date,onChange:e=>_("event_date",e.target.value),className:f.event_date?"error":""}),f.event_date&&(0,Ng.jsx)("span",{className:"field-error",children:f.event_date})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"start_time",children:"Start Time"}),(0,Ng.jsx)("input",{id:"start_time",type:"time",value:s.start_time,onChange:e=>_("start_time",e.target.value)})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"end_time",children:"End Time"}),(0,Ng.jsx)("input",{id:"end_time",type:"time",value:s.end_time,onChange:e=>_("end_time",e.target.value)})]})]}),(0,Ng.jsxs)("div",{className:"form-row",children:[(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"guest_count",children:"Guest Count"}),(0,Ng.jsx)("input",{id:"guest_count",type:"number",value:s.guest_count,onChange:e=>_("guest_count",e.target.value),min:"1",placeholder:"0",className:f.guest_count?"error":""}),f.guest_count&&(0,Ng.jsx)("span",{className:"field-error",children:f.guest_count})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"budget",children:"Budget ($)"}),(0,Ng.jsx)("input",{id:"budget",type:"number",value:s.budget,onChange:e=>_("budget",e.target.value),min:"0",step:"0.01",placeholder:"0.00"})]})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"description",children:"Description"}),(0,Ng.jsx)("textarea",{id:"description",value:s.description,onChange:e=>_("description",e.target.value),placeholder:"Event description...",rows:"3"})]})]}),(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Client Information"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"client_name",children:"Client Name *"}),(0,Ng.jsx)("input",{id:"client_name",type:"text",value:s.client_name,onChange:e=>_("client_name",e.target.value),placeholder:"Enter client name",className:f.client_name?"error":""}),f.client_name&&(0,Ng.jsx)("span",{className:"field-error",children:f.client_name})]}),(0,Ng.jsxs)("div",{className:"form-row",children:[(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"client_email",children:"Email"}),(0,Ng.jsx)("input",{id:"client_email",type:"email",value:s.client_email,onChange:e=>_("client_email",e.target.value),placeholder:"client@example.com",className:f.client_email?"error":""}),f.client_email&&(0,Ng.jsx)("span",{className:"field-error",children:f.client_email})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"client_phone",children:"Phone"}),(0,Ng.jsx)("input",{id:"client_phone",type:"tel",value:s.client_phone,onChange:e=>_("client_phone",e.target.value),placeholder:"(555) 123-4567"})]})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"website",children:"Website"}),(0,Ng.jsx)("input",{id:"website",type:"url",value:s.website,onChange:e=>_("website",e.target.value),placeholder:"https://example.com"})]})]}),(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Venue Information"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"venue",children:"Venue Name"}),(0,Ng.jsx)("input",{id:"venue",type:"text",value:s.venue,onChange:e=>_("venue",e.target.value),placeholder:"Enter venue name"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"venue_address",children:"Venue Address"}),(0,Ng.jsx)("textarea",{id:"venue_address",value:s.venue_address,onChange:e=>_("venue_address",e.target.value),placeholder:"Enter venue address",rows:"2"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"venue_contact",children:"Venue Contact"}),(0,Ng.jsx)("input",{id:"venue_contact",type:"text",value:s.venue_contact,onChange:e=>_("venue_contact",e.target.value),placeholder:"Contact name or phone"})]})]}),(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Event Flyer/Invitation"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{children:"Upload Flyer or Invitation"}),(0,Ng.jsx)(gv,{onFileSelect:async e=>{if(e){g(e),w(!0),h(null);try{const t=await Nv(e);if(t){const e={};if(t.name&&!s.name&&(e.name=t.name),t.event_date&&!s.event_date){const n=new Date(t.event_date);e.event_date=n.toISOString().split("T")[0]}t.start_time&&!s.start_time&&(e.start_time=t.start_time),t.venue&&!s.venue&&(e.venue=t.venue),t.venue_address&&!s.venue_address&&(e.venue_address=t.venue_address),t.description&&!s.description&&(e.description=t.description),t.guest_count&&!s.guest_count&&(e.guest_count=t.guest_count),t.website&&!s.website&&(e.website=t.website),Object.keys(e).length>0&&(a(t=>({...t,...e})),h(null))}}catch(t){console.error("Error parsing file:",t),h("Could not parse event details from file. You can still fill in the details manually.")}finally{w(!1)}}else g(null)},accept:".pdf,.png,.jpg,.jpeg",multiple:!1}),s.flyer_url&&(0,Ng.jsx)("div",{className:"flyer-preview",children:(0,Ng.jsxs)("p",{children:["Current flyer: ",(0,Ng.jsx)("a",{href:s.flyer_url,target:"_blank",rel:"noopener noreferrer",children:"View Flyer"})]})}),b&&(0,Ng.jsxs)("div",{className:"parsing-indicator",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Parsing event details from file..."})]})]})]}),(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Additional Details"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"special_requests",children:"Special Requests"}),(0,Ng.jsx)("textarea",{id:"special_requests",value:s.special_requests,onChange:e=>_("special_requests",e.target.value),placeholder:"Any special requests or requirements...",rows:"3"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"notes",children:"Internal Notes"}),(0,Ng.jsx)("textarea",{id:"notes",value:s.notes,onChange:e=>_("notes",e.target.value),placeholder:"Notes for the team...",rows:"3"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"status",children:"Status"}),(0,Ng.jsxs)("select",{id:"status",value:s.status,onChange:e=>_("status",e.target.value),children:[(0,Ng.jsx)("option",{value:"planning",children:"Planning"}),(0,Ng.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,Ng.jsx)("option",{value:"completed",children:"Completed"}),(0,Ng.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]})]})]})]})})}const Sv=["Dairy","Eggs","Fish","Shellfish","Tree Nuts","Peanuts","Wheat","Soy","Sesame","Gluten","Mustard","Celery","Lupin","Molluscs","Sulphites"],Cv=["Mild","Moderate","Severe"];function jv(e){let{allergy:t,onSubmit:n,onCancel:r}=e;const[s,a]=(0,i.useState)({guest_name:(null===t||void 0===t?void 0:t.guest_name)||"",allergens:(null===t||void 0===t?void 0:t.allergens)||[],severity:(null===t||void 0===t?void 0:t.severity)||"Moderate",notes:(null===t||void 0===t?void 0:t.notes)||"",dietary_restrictions:(null===t||void 0===t?void 0:t.dietary_restrictions)||"",emergency_contact:(null===t||void 0===t?void 0:t.emergency_contact)||"",emergency_phone:(null===t||void 0===t?void 0:t.emergency_phone)||""}),[o,l]=(0,i.useState)(""),[c,u]=(0,i.useState)({}),d=(e,t)=>{a(n=>({...n,[e]:t})),c[e]&&u(t=>{const n={...t};return delete n[e],n})},h=()=>{o.trim()&&!s.allergens.includes(o.trim())&&(a(e=>({...e,allergens:[...e.allergens,o.trim()]})),l(""))};return(0,Ng.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{const e={};return s.guest_name.trim()||(e.guest_name="Guest name is required"),0===s.allergens.length&&(e.allergens="At least one allergen must be selected"),u(e),0===Object.keys(e).length})()&&n(s)},className:"allergy-form",children:[(0,Ng.jsxs)("div",{className:"form-section",children:[(0,Ng.jsx)("h3",{children:"Guest Information"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"guest_name",children:"Guest Name *"}),(0,Ng.jsx)("input",{id:"guest_name",type:"text",value:s.guest_name,onChange:e=>d("guest_name",e.target.value),placeholder:"Enter guest name",className:c.guest_name?"error":""}),c.guest_name&&(0,Ng.jsx)("span",{className:"field-error",children:c.guest_name})]}),(0,Ng.jsxs)("div",{className:"form-row",children:[(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"emergency_contact",children:"Emergency Contact"}),(0,Ng.jsx)("input",{id:"emergency_contact",type:"text",value:s.emergency_contact,onChange:e=>d("emergency_contact",e.target.value),placeholder:"Contact name"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"emergency_phone",children:"Emergency Phone"}),(0,Ng.jsx)("input",{id:"emergency_phone",type:"tel",value:s.emergency_phone,onChange:e=>d("emergency_phone",e.target.value),placeholder:"Phone number"})]})]})]}),(0,Ng.jsxs)("div",{className:"form-section",children:[(0,Ng.jsx)("h3",{children:"Allergens *"}),c.allergens&&(0,Ng.jsx)("span",{className:"field-error",children:c.allergens}),(0,Ng.jsx)("div",{className:"allergen-grid",children:Sv.map(e=>(0,Ng.jsxs)("label",{className:"allergen-checkbox",children:[(0,Ng.jsx)("input",{type:"checkbox",checked:s.allergens.includes(e),onChange:()=>(e=>{a(t=>({...t,allergens:t.allergens.includes(e)?t.allergens.filter(t=>t!==e):[...t.allergens,e]}))})(e)}),(0,Ng.jsx)("span",{children:e})]},e))}),(0,Ng.jsxs)("div",{className:"custom-allergen",children:[(0,Ng.jsx)("input",{type:"text",value:o,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),h())},placeholder:"Add custom allergen"}),(0,Ng.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:h,disabled:!o.trim(),children:"Add"})]}),s.allergens.length>0&&(0,Ng.jsxs)("div",{className:"selected-allergens",children:[(0,Ng.jsx)("h4",{children:"Selected Allergens:"}),(0,Ng.jsx)("div",{className:"allergen-tags",children:s.allergens.map(e=>(0,Ng.jsxs)("span",{className:"allergen-tag",children:[e,(0,Ng.jsx)("button",{type:"button",className:"remove-allergen",onClick:()=>(e=>{a(t=>({...t,allergens:t.allergens.filter(t=>t!==e)}))})(e),children:"\xd7"})]},e))})]})]}),(0,Ng.jsxs)("div",{className:"form-section",children:[(0,Ng.jsx)("h3",{children:"Severity Level"}),(0,Ng.jsx)("div",{className:"severity-options",children:Cv.map(e=>(0,Ng.jsxs)("label",{className:"severity-option",children:[(0,Ng.jsx)("input",{type:"radio",name:"severity",value:e,checked:s.severity===e,onChange:()=>d("severity",e)}),(0,Ng.jsx)("span",{className:`severity-label ${e.toLowerCase()}`,children:e})]},e))})]}),(0,Ng.jsxs)("div",{className:"form-section",children:[(0,Ng.jsx)("h3",{children:"Additional Information"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"dietary_restrictions",children:"Other Dietary Restrictions"}),(0,Ng.jsx)("input",{id:"dietary_restrictions",type:"text",value:s.dietary_restrictions,onChange:e=>d("dietary_restrictions",e.target.value),placeholder:"e.g., Vegetarian, Vegan, Kosher, Halal"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"notes",children:"Notes"}),(0,Ng.jsx)("textarea",{id:"notes",value:s.notes,onChange:e=>d("notes",e.target.value),placeholder:"Any additional information about the allergy...",rows:"3"})]})]}),(0,Ng.jsxs)("div",{className:"form-actions",children:[(0,Ng.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"Cancel"}),(0,Ng.jsx)("button",{type:"submit",className:"btn btn-primary",children:t?"Update Allergy":"Add Allergy"})]})]})}function Iv(e){let{allergies:t,onEdit:n,onDelete:r}=e;const[s,a]=(0,i.useState)(new Set),[o,l]=(0,i.useState)(""),[c,u]=(0,i.useState)("all"),d=t.filter(e=>{if(o){var t,n;const r=o.toLowerCase(),i=null===(t=e.guest_name)||void 0===t?void 0:t.toLowerCase().includes(r),s=null===(n=e.allergens)||void 0===n?void 0:n.some(e=>e.toLowerCase().includes(r));if(!i&&!s)return!1}var r;if("all"!==c&&(null===(r=e.severity)||void 0===r?void 0:r.toLowerCase())!==c)return!1;return!0}),h=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"severe":return"severity-severe";case"moderate":default:return"severity-moderate";case"mild":return"severity-mild"}},f=e=>{var t;if(!e)return"";return((null===(t=e.toDate)||void 0===t?void 0:t.call(e))||new Date(e)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})};return(0,Ng.jsxs)("div",{className:"allergy-list",children:[(0,Ng.jsxs)("div",{className:"list-filters",children:[(0,Ng.jsxs)("div",{className:"search-bar",children:[(0,Ng.jsx)("span",{className:"search-icon",children:"\ud83d\udd0d"}),(0,Ng.jsx)("input",{type:"text",placeholder:"Search by guest name or allergen...",value:o,onChange:e=>l(e.target.value),className:"search-input"}),o&&(0,Ng.jsx)("button",{className:"clear-search",onClick:()=>l(""),children:"\u2715"})]}),(0,Ng.jsxs)("div",{className:"severity-filter",children:[(0,Ng.jsx)("label",{children:"Filter by severity:"}),(0,Ng.jsxs)("select",{value:c,onChange:e=>u(e.target.value),children:[(0,Ng.jsx)("option",{value:"all",children:"All"}),(0,Ng.jsx)("option",{value:"severe",children:"Severe"}),(0,Ng.jsx)("option",{value:"moderate",children:"Moderate"}),(0,Ng.jsx)("option",{value:"mild",children:"Mild"})]})]})]}),(0,Ng.jsx)("div",{className:"list-results",children:0===d.length?(0,Ng.jsx)("p",{className:"no-results",children:"No allergies match your filters."}):(0,Ng.jsx)("div",{className:"allergy-items",children:d.map(e=>{var t,i,o;return(0,Ng.jsxs)("div",{className:`allergy-item ${h(e.severity)}`,children:[(0,Ng.jsxs)("div",{className:"item-header",onClick:()=>{return t=e.id,void a(e=>{const n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n});var t},children:[(0,Ng.jsxs)("div",{className:"header-main",children:[(0,Ng.jsx)("h3",{className:"guest-name",children:e.guest_name}),(0,Ng.jsx)("span",{className:`severity-badge ${h(e.severity)}`,children:e.severity||"Moderate"})]}),(0,Ng.jsxs)("div",{className:"header-allergens",children:[null===(t=e.allergens)||void 0===t?void 0:t.slice(0,3).map(e=>(0,Ng.jsx)("span",{className:"allergen-chip",children:e},e)),(null===(i=e.allergens)||void 0===i?void 0:i.length)>3&&(0,Ng.jsxs)("span",{className:"allergen-chip more",children:["+",e.allergens.length-3," more"]})]}),(0,Ng.jsx)("button",{className:"expand-btn",children:s.has(e.id)?"\u2212":"+"})]}),s.has(e.id)&&(0,Ng.jsxs)("div",{className:"item-details",children:[(0,Ng.jsxs)("div",{className:"detail-section",children:[(0,Ng.jsx)("h4",{children:"All Allergens"}),(0,Ng.jsx)("div",{className:"allergen-list",children:null===(o=e.allergens)||void 0===o?void 0:o.map(e=>(0,Ng.jsxs)("span",{className:"allergen-tag",children:["\u26a0\ufe0f ",e]},e))})]}),e.dietary_restrictions&&(0,Ng.jsxs)("div",{className:"detail-section",children:[(0,Ng.jsx)("h4",{children:"Other Dietary Restrictions"}),(0,Ng.jsx)("p",{children:e.dietary_restrictions})]}),(e.emergency_contact||e.emergency_phone)&&(0,Ng.jsxs)("div",{className:"detail-section",children:[(0,Ng.jsx)("h4",{children:"Emergency Contact"}),(0,Ng.jsxs)("p",{children:[e.emergency_contact,e.emergency_phone&&(0,Ng.jsxs)(Ng.Fragment,{children:[" - ",(0,Ng.jsx)("a",{href:`tel:${e.emergency_phone}`,children:e.emergency_phone})]})]})]}),e.notes&&(0,Ng.jsxs)("div",{className:"detail-section",children:[(0,Ng.jsx)("h4",{children:"Notes"}),(0,Ng.jsx)("p",{children:e.notes})]}),(0,Ng.jsx)("div",{className:"detail-section",children:(0,Ng.jsxs)("p",{className:"meta-info",children:["Added ",f(e.created_at),e.updated_at&&e.updated_at!==e.created_at&&(0,Ng.jsxs)(Ng.Fragment,{children:[" \u2022 Updated ",f(e.updated_at)]})]})}),(n||r)&&(0,Ng.jsxs)("div",{className:"item-actions",children:[n&&(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>n(e),children:"Edit"}),r&&(0,Ng.jsx)("button",{className:"btn btn-danger",onClick:()=>r(e.id),children:"Delete"})]})]})]},e.id)})})})]})}function Tv(){const{eventId:e}=re(),{hasRole:t}=(ne(),kg()),[n,r]=(0,i.useState)(null),[s,a]=(0,i.useState)([]),[o,l]=(0,i.useState)(!0),[c,u]=(0,i.useState)(null),[d,h]=(0,i.useState)(!1),[f,p]=(0,i.useState)(null),[m,g]=(0,i.useState)(!1);(0,i.useEffect)(()=>{v();const e=y();return()=>e()},[e]);const v=async()=>{try{const t=await Tp(jf(wg,"events",e));if(!t.exists())return void u("Event not found");r({id:t.id,...t.data()})}catch(t){console.error("Error loading event:",t),u("Failed to load event")}},y=()=>Mp(fp(Cf(wg,"events",e,"allergies")),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));a(t),l(!1),b(t)},e=>{console.error("Error fetching allergies:",e),l(!1)}),b=async t=>{const i=new Set;t.forEach(e=>{var t;null===(t=e.allergens)||void 0===t||t.forEach(e=>i.add(e))});const s=Array.from(i).sort();if(n&&JSON.stringify(n.allergens)!==JSON.stringify(s))try{g(!0),await Pp(jf(wg,"events",e),{allergens:s,updated_at:Vp()}),r(e=>({...e,allergens:s}))}catch(a){console.error("Error updating event allergens:",a)}finally{g(!1)}};if(o)return(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading allergies..."})]});if(c)return(0,Ng.jsxs)("div",{className:"error-container",children:[(0,Ng.jsx)("h2",{children:"Error"}),(0,Ng.jsx)("p",{children:c}),(0,Ng.jsx)(Te,{to:`/events/${e}`,className:"btn btn-secondary",children:"Back to Event"})]});const w=(()=>{const e={severe:0,moderate:0,mild:0};return s.forEach(t=>{var n;const r=(null===(n=t.severity)||void 0===n?void 0:n.toLowerCase())||"moderate";void 0!==e[r]&&e[r]++}),e})();return(0,Ng.jsxs)("div",{className:"allergy-manager",children:[(0,Ng.jsx)("div",{className:"allergy-header",children:(0,Ng.jsxs)("div",{className:"header-content",children:[(0,Ng.jsx)(Te,{to:`/events/${e}`,className:"back-link",children:"\u2190 Back to Event"}),(0,Ng.jsx)("h1",{children:"Allergy Management"}),(0,Ng.jsx)("p",{className:"event-name",children:null===n||void 0===n?void 0:n.name}),t("user")&&!d&&(0,Ng.jsxs)("button",{className:"btn btn-primary",onClick:()=>h(!0),children:[(0,Ng.jsx)("span",{className:"btn-icon",children:"\u2795"}),"Add Allergy"]})]})}),(0,Ng.jsxs)("div",{className:"allergy-stats",children:[(0,Ng.jsxs)("div",{className:"stat-card",children:[(0,Ng.jsx)("div",{className:"stat-value",children:s.length}),(0,Ng.jsx)("div",{className:"stat-label",children:"Total Guests with Allergies"})]}),(0,Ng.jsxs)("div",{className:"stat-card severe",children:[(0,Ng.jsx)("div",{className:"stat-value",children:w.severe}),(0,Ng.jsx)("div",{className:"stat-label",children:"Severe Allergies"})]}),(0,Ng.jsxs)("div",{className:"stat-card moderate",children:[(0,Ng.jsx)("div",{className:"stat-value",children:w.moderate}),(0,Ng.jsx)("div",{className:"stat-label",children:"Moderate Allergies"})]}),(0,Ng.jsxs)("div",{className:"stat-card mild",children:[(0,Ng.jsx)("div",{className:"stat-value",children:w.mild}),(0,Ng.jsx)("div",{className:"stat-label",children:"Mild Allergies"})]})]}),(null===n||void 0===n?void 0:n.allergens)&&n.allergens.length>0&&(0,Ng.jsxs)("div",{className:"allergen-summary",children:[(0,Ng.jsx)("h2",{children:"All Allergens Present"}),(0,Ng.jsx)("div",{className:"allergen-tags",children:n.allergens.map(e=>(0,Ng.jsxs)("span",{className:"allergen-tag large",children:["\u26a0\ufe0f ",e]},e))}),m&&(0,Ng.jsx)("p",{className:"updating-note",children:"Updating event allergens..."})]}),d&&(0,Ng.jsxs)("div",{className:"form-section",children:[(0,Ng.jsx)("h2",{children:f?"Edit Allergy":"Add New Allergy"}),(0,Ng.jsx)(jv,{allergy:f,onSubmit:f?t=>(async(t,n)=>{try{await Pp(jf(wg,"events",e,"allergies",t),{...n,updated_at:Vp()}),p(null)}catch(r){console.error("Error updating allergy:",r),alert("Failed to update allergy")}})(f.id,t):async t=>{try{await Lp(Cf(wg,"events",e,"allergies"),{...t,created_at:Vp(),updated_at:Vp()}),h(!1)}catch(n){console.error("Error adding allergy:",n),alert("Failed to add allergy")}},onCancel:()=>{h(!1),p(null)}})]}),(0,Ng.jsxs)("div",{className:"allergy-list-section",children:[(0,Ng.jsx)("h2",{children:"Individual Allergies"}),s.length>0?(0,Ng.jsx)(Iv,{allergies:s,onEdit:t("user")?e=>{p(e),h(!0)}:null,onDelete:t("user")?async t=>{if(window.confirm("Are you sure you want to delete this allergy record?"))try{await Op(jf(wg,"events",e,"allergies",t))}catch(n){console.error("Error deleting allergy:",n),alert("Failed to delete allergy")}}:null}):(0,Ng.jsxs)("div",{className:"empty-state",children:[(0,Ng.jsx)("p",{children:"No allergies recorded yet."}),t("user")&&(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:()=>h(!0),children:"Add First Allergy"})]})]})]})}const Av=["breakfast","brunch","lunch","dinner","ceremony"];function Rv(){const e=ne(),{hasRole:t}=kg(),{menus:n}=jg(),[r,s]=(0,i.useState)([]),[a,o]=(0,i.useState)(!0),[l,c]=(0,i.useState)(""),[u,d]=(0,i.useState)("all"),[h,f]=(0,i.useState)(null),[p,m]=(0,i.useState)([...Av]);(0,i.useEffect)(()=>{const e=Mp(fp(Cf(wg,"menus"),yp("created_at","desc")),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));s(t),o(!1)},e=>{console.error("Error fetching menus:",e),o(!1)}),t=Mp(Cf(wg,"meal_types"),e=>{const t=e.docs.map(e=>e.id);m([...Av,...t])});return()=>{e(),t()}},[]);const g=r.filter(e=>{if(l){var t,n;const r=l.toLowerCase(),i=null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(r),s=null===(n=e.description)||void 0===n?void 0:n.toLowerCase().includes(r);if(!i&&!s)return!1}if("all"!==u){var r;if(!((null===(r=e.meals)||void 0===r?void 0:r.map(e=>e.type))||[]).includes(u))return!1}return!0}),v=()=>{e("/menus/new")},y=e=>{switch(e){case"breakfast":return"\ud83c\udf05";case"lunch":return"\u2600\ufe0f";case"dinner":return"\ud83c\udf19";case"ceremony":return"\ud83c\udf8b";case"brunch":return"\ud83e\udd50";case"custom":return"\u2728";default:return"\ud83c\udf7d\ufe0f"}},b=e=>{var t;if(!e)return"No date";return((null===(t=e.toDate)||void 0===t?void 0:t.call(e))||new Date(e)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})};return a?(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading menus..."})]}):(0,Ng.jsxs)("div",{className:"menu-list",children:[(0,Ng.jsxs)("div",{className:"menu-list-header",children:[(0,Ng.jsx)("h1",{children:"Menu Builder"}),t("user")&&(0,Ng.jsxs)("button",{className:"btn btn-primary",onClick:v,children:[(0,Ng.jsx)("span",{className:"btn-icon",children:"\u2795"}),"Create Menu"]})]}),(0,Ng.jsxs)("div",{className:"menu-filters",children:[(0,Ng.jsxs)("div",{className:"search-bar",children:[(0,Ng.jsx)("span",{className:"search-icon",children:"\ud83d\udd0d"}),(0,Ng.jsx)("input",{type:"text",placeholder:"Search menus...",value:l,onChange:e=>c(e.target.value),className:"search-input"}),l&&(0,Ng.jsx)("button",{className:"clear-search",onClick:()=>c(""),children:"\u2715"})]}),(0,Ng.jsxs)("div",{className:"filter-pills",children:[(0,Ng.jsx)("button",{className:"filter-pill "+("all"===u?"active":""),onClick:()=>d("all"),children:"All Menus"}),p.map(e=>(0,Ng.jsxs)("button",{className:"filter-pill "+(u===e?"active":""),onClick:()=>d(e),children:[{breakfast:"\ud83c\udf05",brunch:"\ud83e\udd50",lunch:"\u2600\ufe0f",dinner:"\ud83c\udf19",ceremony:"\ud83c\udf8b"}[e]||"\ud83c\udf7d\ufe0f"," ",e.charAt(0).toUpperCase()+e.slice(1)]},e))]})]}),(0,Ng.jsxs)("div",{className:"results-summary",children:["Showing ",g.length," of ",r.length," menus"]}),(0,Ng.jsx)("div",{className:"menu-grid",children:g.map(n=>{var r;return(0,Ng.jsxs)("div",{className:"menu-card",onClick:()=>{return t=n.id,void e(`/menus/${t}`);var t},children:[h===n.id&&(0,Ng.jsxs)("div",{className:"delete-confirm-modal",onClick:e=>e.stopPropagation(),children:[(0,Ng.jsx)("p",{children:"Delete this menu?"}),(0,Ng.jsxs)("div",{className:"confirm-actions",children:[(0,Ng.jsx)("button",{className:"btn btn-sm btn-secondary",onClick:e=>{e.stopPropagation(),f(null)},children:"Cancel"}),(0,Ng.jsx)("button",{className:"btn btn-sm btn-danger",onClick:e=>{e.stopPropagation(),(async e=>{try{await Op(jf(wg,"menus",e)),f(null)}catch(t){console.error("Error deleting menu:",t),alert("Failed to delete menu")}})(n.id)},children:"Delete"})]})]}),(0,Ng.jsxs)("div",{className:"menu-card-header",children:[(0,Ng.jsx)("span",{className:"menu-type-icon",children:y(n.type)}),t("user")&&(0,Ng.jsxs)("div",{className:"menu-actions",children:[(0,Ng.jsx)("button",{className:"action-btn",onClick:t=>((t,n)=>{t.stopPropagation(),e("/menus/new",{state:{template:{...n,name:`${n.name} (Copy)`,id:void 0,created_at:void 0,created_by:void 0}}})})(t,n),title:"Duplicate menu",children:"\ud83d\udccb"}),(0,Ng.jsx)("button",{className:"action-btn delete",onClick:e=>{e.stopPropagation(),f(n.id)},title:"Delete menu",children:"\ud83d\uddd1\ufe0f"})]})]}),(0,Ng.jsxs)("div",{className:"menu-card-body",children:[(0,Ng.jsx)("h3",{className:"menu-name",children:n.name||"Unnamed Menu"}),n.description&&(0,Ng.jsx)("p",{className:"menu-description",children:n.description}),(0,Ng.jsxs)("div",{className:"menu-meta",children:[(0,Ng.jsx)("span",{className:"menu-type",children:"custom"===n.type&&n.displayType?n.displayType:n.type?n.type.charAt(0).toUpperCase()+n.type.slice(1):"General"}),(0,Ng.jsxs)("span",{className:"menu-items",children:[(null===(r=n.sections)||void 0===r?void 0:r.reduce((e,t)=>{var n;return e+((null===(n=t.items)||void 0===n?void 0:n.length)||0)},0))||0," items"]})]}),n.event_name&&(0,Ng.jsxs)("div",{className:"menu-event",children:["\ud83d\udcc5 ",n.event_name]}),(0,Ng.jsx)("div",{className:"menu-footer",children:(0,Ng.jsxs)("span",{className:"menu-date",children:["Created ",b(n.created_at)]})})]})]},n.id)})}),0===g.length&&(0,Ng.jsxs)("div",{className:"empty-state",children:[(0,Ng.jsx)("p",{children:"No menus found."}),t("user")&&(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:v,children:"Create Your First Menu"})]})]})}function Dv(){var e,t;const{id:n}=re(),r=ne(),{hasRole:s}=kg(),[a,o]=(0,i.useState)(null),[l,c]=(0,i.useState)(!0),[u,d]=(0,i.useState)(null),[h,f]=(0,i.useState)(!1),[p,m]=(0,i.useState)(new Set);(0,i.useEffect)(()=>{g()},[n]);const g=async()=>{try{var e,t;c(!0);const r=await Tp(jf(wg,"menus",n));if(!r.exists())return void d("Menu not found");const i={id:r.id,...r.data()};o(i);const s=(null===(e=i.meals)||void 0===e?void 0:e.map(e=>e.id))||(null===(t=i.sections)||void 0===t?void 0:t.map(e=>e.id))||[];m(new Set(s))}catch(r){console.error("Error loading menu:",r),d("Failed to load menu")}finally{c(!1)}},v=e=>{switch(e){case"breakfast":return"\ud83c\udf05";case"lunch":return"\u2600\ufe0f";case"dinner":return"\ud83c\udf19";case"ceremony":return"\ud83c\udf8b";case"brunch":return"\ud83e\udd50";case"custom":return"\u2728";default:return"\ud83c\udf7d\ufe0f"}};return l?(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading menu..."})]}):u?(0,Ng.jsxs)("div",{className:"error-container",children:[(0,Ng.jsx)("h2",{children:"Error"}),(0,Ng.jsx)("p",{children:u}),(0,Ng.jsx)(Te,{to:"/menus",className:"btn btn-secondary",children:"Back to Menus"})]}):a?(0,Ng.jsxs)("div",{className:"menu-viewer",children:[(0,Ng.jsx)("div",{className:"menu-header",children:(0,Ng.jsxs)("div",{className:"menu-header-content",children:[(0,Ng.jsx)(Te,{to:"/menus",className:"back-link",children:"\u2190 Back to Menus"}),(0,Ng.jsxs)("div",{className:"menu-title-row",children:[(0,Ng.jsx)("span",{className:"menu-type-icon",children:v(a.type)}),(0,Ng.jsx)("h1",{children:a.name||"Unnamed Menu"})]}),(0,Ng.jsxs)("div",{className:"menu-actions",children:[s("user")&&(0,Ng.jsxs)(Ng.Fragment,{children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{r(`/menus/${n}/edit`)},children:"\u270f\ufe0f Edit"}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{r("/menus/new",{state:{template:{...a,name:`${a.name} (Copy)`,id:void 0,created_at:void 0,created_by:void 0}}})},children:"\ud83d\udccb Duplicate"}),(0,Ng.jsx)("button",{className:"btn btn-danger",onClick:()=>f(!0),children:"\ud83d\uddd1\ufe0f Delete"})]}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{window.print()},children:"\ud83d\udda8\ufe0f Print"}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{alert("PDF export coming soon!")},children:"\ud83d\udcc4 Export PDF"})]})]})}),h&&(0,Ng.jsx)("div",{className:"modal-overlay",onClick:()=>f(!1),children:(0,Ng.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,Ng.jsx)("h3",{children:"Delete Menu?"}),(0,Ng.jsxs)("p",{children:['Are you sure you want to delete "',a.name,'"? This action cannot be undone.']}),(0,Ng.jsxs)("div",{className:"modal-actions",children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>f(!1),children:"Cancel"}),(0,Ng.jsx)("button",{className:"btn btn-danger",onClick:async()=>{try{await Op(jf(wg,"menus",n)),r("/menus")}catch(e){console.error("Error deleting menu:",e),alert("Failed to delete menu")}},children:"Delete Menu"})]})]})}),(0,Ng.jsxs)("div",{className:"menu-info",children:[(0,Ng.jsxs)("div",{className:"info-grid",children:[(0,Ng.jsxs)("div",{className:"info-item",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Meals:"}),(0,Ng.jsx)("span",{className:"info-value",children:(null===(e=a.meals)||void 0===e?void 0:e.length)||(null===(t=a.sections)||void 0===t?void 0:t.length)||0})]}),(0,Ng.jsxs)("div",{className:"info-item",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Total Items:"}),(0,Ng.jsx)("span",{className:"info-value",children:((null===a||void 0===a?void 0:a.meals)||(null===a||void 0===a?void 0:a.sections)||[]).reduce((e,t)=>{var n,r;return e+((null===(n=t.recipes)||void 0===n?void 0:n.length)||(null===(r=t.items)||void 0===r?void 0:r.length)||0)},0)||0})]}),a.event_name&&(0,Ng.jsxs)("div",{className:"info-item",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Event:"}),(0,Ng.jsx)("span",{className:"info-value",children:a.event_name})]}),(0,Ng.jsxs)("div",{className:"info-item",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Created:"}),(0,Ng.jsx)("span",{className:"info-value",children:(e=>{var t;if(!e)return"No date";return((null===(t=e.toDate)||void 0===t?void 0:t.call(e))||new Date(e)).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})(a.created_at)})]})]}),a.description&&(0,Ng.jsx)("div",{className:"menu-description",children:(0,Ng.jsx)("p",{children:a.description})})]}),(0,Ng.jsxs)("div",{className:"menu-content printable",children:[(0,Ng.jsxs)("div",{className:"print-header",children:[(0,Ng.jsx)("h2",{children:a.name}),a.event_name&&(0,Ng.jsxs)("p",{className:"print-event",children:["For: ",a.event_name]})]}),a.meals&&a.meals.length>0||a.sections&&a.sections.length>0?(0,Ng.jsx)("div",{className:"menu-sections",children:(a.meals||a.sections).map(e=>(0,Ng.jsxs)("div",{className:"menu-section meal-section",children:[(0,Ng.jsxs)("div",{className:"section-header",onClick:()=>{return t=e.id,void m(e=>{const n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n});var t},children:[(0,Ng.jsxs)("div",{className:"meal-header-info",children:[(0,Ng.jsxs)("span",{className:"meal-type-badge",children:[v(e.type||"dinner")," ",(e.type||e.name||"Meal").charAt(0).toUpperCase()+(e.type||e.name||"meal").slice(1)]}),e.name&&!e.type&&(0,Ng.jsx)("h3",{children:e.name})]}),(0,Ng.jsx)("span",{className:"section-toggle",children:p.has(e.id)?"\u2212":"+"})]}),p.has(e.id)&&(0,Ng.jsxs)("div",{className:"meal-content",children:[(e.description||e.instructions||e.notes)&&(0,Ng.jsxs)("div",{className:"meal-details",children:[e.description&&(0,Ng.jsxs)("div",{className:"meal-detail",children:[(0,Ng.jsx)("strong",{children:"Description:"}),(0,Ng.jsx)("p",{children:e.description})]}),e.instructions&&(0,Ng.jsxs)("div",{className:"meal-detail",children:[(0,Ng.jsx)("strong",{children:"Instructions:"}),(0,Ng.jsx)("p",{children:e.instructions})]}),e.notes&&(0,Ng.jsxs)("div",{className:"meal-detail",children:[(0,Ng.jsx)("strong",{children:"Notes:"}),(0,Ng.jsx)("p",{children:e.notes})]})]}),(0,Ng.jsx)("div",{className:"section-items",children:e.recipes&&e.recipes.length>0||e.items&&e.items.length>0?(e.recipes||e.items).map((e,t)=>(0,Ng.jsxs)("div",{className:"menu-item-display",children:[(0,Ng.jsxs)("div",{className:"item-main-info",children:[(0,Ng.jsx)("h4",{children:e.recipe_name}),(0,Ng.jsxs)("span",{className:"item-serves",children:["Serves ",e.serves||"?"]})]}),e.notes&&(0,Ng.jsx)("p",{className:"item-notes",children:e.notes})]},e.id||t)):(0,Ng.jsx)("p",{className:"empty-section",children:"No recipes in this meal"})})]})]},e.id))}):(0,Ng.jsx)("div",{className:"empty-menu",children:(0,Ng.jsx)("p",{children:"This menu has no meals yet."})})]})]}):null}const Pv="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;function Ov(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function Lv(e){return"nodeType"in e}function Mv(e){var t,n;return e?Ov(e)?e:Lv(e)&&null!=(t=null==(n=e.ownerDocument)?void 0:n.defaultView)?t:window:window}function Fv(e){const{Document:t}=Mv(e);return e instanceof t}function Uv(e){return!Ov(e)&&e instanceof Mv(e).HTMLElement}function Vv(e){return e instanceof Mv(e).SVGElement}function Bv(e){return e?Ov(e)?e.document:Lv(e)?Fv(e)?e:Uv(e)||Vv(e)?e.ownerDocument:document:document:document}const zv=Pv?i.useLayoutEffect:i.useEffect;function $v(e){const t=(0,i.useRef)(e);return zv(()=>{t.current=e}),(0,i.useCallback)(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null==t.current?void 0:t.current(...n)},[])}function qv(e,t){void 0===t&&(t=[e]);const n=(0,i.useRef)(e);return zv(()=>{n.current!==e&&(n.current=e)},t),n}function Hv(e,t){const n=(0,i.useRef)();return(0,i.useMemo)(()=>{const t=e(n.current);return n.current=t,t},[...t])}function Wv(e){const t=$v(e),n=(0,i.useRef)(null),r=(0,i.useCallback)(e=>{e!==n.current&&(null==t||t(e,n.current)),n.current=e},[]);return[n,r]}function Kv(e){const t=(0,i.useRef)();return(0,i.useEffect)(()=>{t.current=e},[e]),t.current}let Gv={};function Qv(e,t){return(0,i.useMemo)(()=>{if(t)return t;const n=null==Gv[e]?0:Gv[e]+1;return Gv[e]=n,e+"-"+n},[e,t])}function Yv(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((t,n)=>{const r=Object.entries(n);for(const[i,s]of r){const n=t[i];null!=n&&(t[i]=n+e*s)}return t},{...t})}}const Xv=Yv(1),Jv=Yv(-1);function Zv(e){if(!e)return!1;const{KeyboardEvent:t}=Mv(e.target);return t&&e instanceof t}function ey(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=Mv(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const ty=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[ty.Translate.toString(e),ty.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),ny="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ry(e){return e.matches(ny)?e:e.querySelector(ny)}const iy={display:"none"};function sy(e){let{id:t,value:n}=e;return i.createElement("div",{id:t,style:iy},n)}function ay(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;return i.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":r,"aria-atomic":!0},n)}const oy=(0,i.createContext)(null);const ly={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},cy={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function uy(e){let{announcements:t=cy,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=ly}=e;const{announce:a,announcement:l}=function(){const[e,t]=(0,i.useState)("");return{announce:(0,i.useCallback)(e=>{null!=e&&t(e)},[]),announcement:e}}(),c=Qv("DndLiveRegion"),[u,d]=(0,i.useState)(!1);if((0,i.useEffect)(()=>{d(!0)},[]),function(e){const t=(0,i.useContext)(oy);(0,i.useEffect)(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}((0,i.useMemo)(()=>({onDragStart(e){let{active:n}=e;a(t.onDragStart({active:n}))},onDragMove(e){let{active:n,over:r}=e;t.onDragMove&&a(t.onDragMove({active:n,over:r}))},onDragOver(e){let{active:n,over:r}=e;a(t.onDragOver({active:n,over:r}))},onDragEnd(e){let{active:n,over:r}=e;a(t.onDragEnd({active:n,over:r}))},onDragCancel(e){let{active:n,over:r}=e;a(t.onDragCancel({active:n,over:r}))}}),[a,t])),!u)return null;const h=i.createElement(i.Fragment,null,i.createElement(sy,{id:r,value:s.draggable}),i.createElement(ay,{id:c,announcement:l}));return n?(0,o.createPortal)(h,n):h}var dy;function hy(){}function fy(e,t){return(0,i.useMemo)(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}!function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"}(dy||(dy={}));const py=Object.freeze({x:0,y:0});function my(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function gy(e,t){const n=ey(e);if(!n)return"0 0";return(n.x-t.left)/t.width*100+"% "+(n.y-t.top)/t.height*100+"%"}function vy(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function yy(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function by(e){let{left:t,top:n,height:r,width:i}=e;return[{x:t,y:n},{x:t+i,y:n},{x:t,y:n+r},{x:t+i,y:n+r}]}function wy(e,t){if(!e||0===e.length)return null;const[n]=e;return t?n[t]:n}function xy(e,t,n){return void 0===t&&(t=e.left),void 0===n&&(n=e.top),{x:t+.5*e.width,y:n+.5*e.height}}const _y=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=xy(t,t.left,t.top),s=[];for(const a of r){const{id:e}=a,t=n.get(e);if(t){const n=my(xy(t),i);s.push({id:e,data:{droppableContainer:a,value:n}})}}return s.sort(vy)};function Ny(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),a=i-r,o=s-n;if(r<i&&n<s){const n=t.width*t.height,r=e.width*e.height,i=a*o;return Number((i/(n+r-i)).toFixed(4))}return 0}const Ey=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=[];for(const s of r){const{id:e}=s,r=n.get(e);if(r){const n=Ny(r,t);n>0&&i.push({id:e,data:{droppableContainer:s,value:n}})}}return i.sort(yy)};function ky(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:py}function Sy(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((t,n)=>({...t,top:t.top+e*n.y,bottom:t.bottom+e*n.y,left:t.left+e*n.x,right:t.right+e*n.x}),{...t})}}const Cy=Sy(1);function jy(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}const Iy={ignoreTransform:!1};function Ty(e,t){void 0===t&&(t=Iy);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:r}=Mv(e).getComputedStyle(e);t&&(n=function(e,t,n){const r=jy(t);if(!r)return e;const{scaleX:i,scaleY:s,x:a,y:o}=r,l=e.left-a-(1-i)*parseFloat(n),c=e.top-o-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),u=i?e.width/i:e.width,d=s?e.height/s:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}(n,t,r))}const{top:r,left:i,width:s,height:a,bottom:o,right:l}=n;return{top:r,left:i,width:s,height:a,bottom:o,right:l}}function Ay(e){return Ty(e,{ignoreTransform:!0})}function Ry(e,t){const n=[];return e?function r(i){if(null!=t&&n.length>=t)return n;if(!i)return n;if(Fv(i)&&null!=i.scrollingElement&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!Uv(i)||Vv(i))return n;if(n.includes(i))return n;const s=Mv(e).getComputedStyle(i);return i!==e&&function(e,t){void 0===t&&(t=Mv(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(e=>{const r=t[e];return"string"===typeof r&&n.test(r)})}(i,s)&&n.push(i),function(e,t){return void 0===t&&(t=Mv(e).getComputedStyle(e)),"fixed"===t.position}(i,s)?n:r(i.parentNode)}(e):n}function Dy(e){const[t]=Ry(e,1);return null!=t?t:null}function Py(e){return Pv&&e?Ov(e)?e:Lv(e)?Fv(e)||e===Bv(e).scrollingElement?window:Uv(e)?e:null:null:null}function Oy(e){return Ov(e)?e.scrollX:e.scrollLeft}function Ly(e){return Ov(e)?e.scrollY:e.scrollTop}function My(e){return{x:Oy(e),y:Ly(e)}}var Fy;function Uy(e){return!(!Pv||!e)&&e===document.scrollingElement}function Vy(e){const t={x:0,y:0},n=Uy(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=r.y,isRight:e.scrollLeft>=r.x,maxScroll:r,minScroll:t}}!function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"}(Fy||(Fy={}));const By={x:.2,y:.2};function zy(e,t,n,r,i){let{top:s,left:a,right:o,bottom:l}=n;void 0===r&&(r=10),void 0===i&&(i=By);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=Vy(e),f={x:0,y:0},p={x:0,y:0},m=t.height*i.y,g=t.width*i.x;return!c&&s<=t.top+m?(f.y=Fy.Backward,p.y=r*Math.abs((t.top+m-s)/m)):!u&&l>=t.bottom-m&&(f.y=Fy.Forward,p.y=r*Math.abs((t.bottom-m-l)/m)),!h&&o>=t.right-g?(f.x=Fy.Forward,p.x=r*Math.abs((t.right-g-o)/g)):!d&&a<=t.left+g&&(f.x=Fy.Backward,p.x=r*Math.abs((t.left+g-a)/g)),{direction:f,speed:p}}function $y(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:n,right:r,bottom:i}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:i,width:e.clientWidth,height:e.clientHeight}}function qy(e){return e.reduce((e,t)=>Xv(e,My(t)),py)}function Hy(e,t){if(void 0===t&&(t=Ty),!e)return;const{top:n,left:r,bottom:i,right:s}=t(e);Dy(e)&&(i<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Wy=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+Oy(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+Ly(t),0)}]];class Ky{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Ry(t),r=qy(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[i,s,a]of Wy)for(const e of s)Object.defineProperty(this,e,{get:()=>{const t=a(n),s=r[i]-t;return this.rect[e]+s},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Gy{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,n){var r;null==(r=this.target)||r.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function Qy(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return"number"===typeof t?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t&&r>t.y}var Yy,Xy;function Jy(e){e.preventDefault()}function Zy(e){e.stopPropagation()}!function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"}(Yy||(Yy={})),function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"}(Xy||(Xy={}));const eb={start:[Xy.Space,Xy.Enter],cancel:[Xy.Esc],end:[Xy.Space,Xy.Enter,Xy.Tab]},tb=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Xy.Right:return{...n,x:n.x+25};case Xy.Left:return{...n,x:n.x-25};case Xy.Down:return{...n,y:n.y+25};case Xy.Up:return{...n,y:n.y-25}}};class nb{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new Gy(Bv(t)),this.windowListeners=new Gy(Mv(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Yy.Resize,this.handleCancel),this.windowListeners.add(Yy.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Yy.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&Hy(n),t(py)}handleKeyDown(e){if(Zv(e)){const{active:t,context:n,options:r}=this.props,{keyboardCodes:i=eb,coordinateGetter:s=tb,scrollBehavior:a="smooth"}=r,{code:o}=e;if(i.end.includes(o))return void this.handleEnd(e);if(i.cancel.includes(o))return void this.handleCancel(e);const{collisionRect:l}=n.current,c=l?{x:l.left,y:l.top}:py;this.referenceCoordinates||(this.referenceCoordinates=c);const u=s(e,{active:t,context:n.current,currentCoordinates:c});if(u){const t=Jv(u,c),r={x:0,y:0},{scrollableAncestors:i}=n.current;for(const n of i){const i=e.code,{isTop:s,isRight:o,isLeft:l,isBottom:c,maxScroll:d,minScroll:h}=Vy(n),f=$y(n),p={x:Math.min(i===Xy.Right?f.right-f.width/2:f.right,Math.max(i===Xy.Right?f.left:f.left+f.width/2,u.x)),y:Math.min(i===Xy.Down?f.bottom-f.height/2:f.bottom,Math.max(i===Xy.Down?f.top:f.top+f.height/2,u.y))},m=i===Xy.Right&&!o||i===Xy.Left&&!l,g=i===Xy.Down&&!c||i===Xy.Up&&!s;if(m&&p.x!==u.x){const e=n.scrollLeft+t.x,s=i===Xy.Right&&e<=d.x||i===Xy.Left&&e>=h.x;if(s&&!t.y)return void n.scrollTo({left:e,behavior:a});r.x=s?n.scrollLeft-e:i===Xy.Right?n.scrollLeft-d.x:n.scrollLeft-h.x,r.x&&n.scrollBy({left:-r.x,behavior:a});break}if(g&&p.y!==u.y){const e=n.scrollTop+t.y,s=i===Xy.Down&&e<=d.y||i===Xy.Up&&e>=h.y;if(s&&!t.x)return void n.scrollTo({top:e,behavior:a});r.y=s?n.scrollTop-e:i===Xy.Down?n.scrollTop-d.y:n.scrollTop-h.y,r.y&&n.scrollBy({top:-r.y,behavior:a});break}}this.handleMove(e,Xv(Jv(u,this.referenceCoordinates),r))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function rb(e){return Boolean(e&&"distance"in e)}function ib(e){return Boolean(e&&"delay"in e)}nb.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=eb,onActivation:i}=t,{active:s}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const t=s.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==i||i({event:e.nativeEvent}),!0)}return!1}}];class sb{constructor(e,t,n){var r;void 0===n&&(n=function(e){const{EventTarget:t}=Mv(e);return e instanceof t?e:Bv(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:i}=e,{target:s}=i;this.props=e,this.events=t,this.document=Bv(s),this.documentListeners=new Gy(this.document),this.listeners=new Gy(n),this.windowListeners=new Gy(Mv(s)),this.initialCoordinates=null!=(r=ey(i))?r:py,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Yy.Resize,this.handleCancel),this.windowListeners.add(Yy.DragStart,Jy),this.windowListeners.add(Yy.VisibilityChange,this.handleCancel),this.windowListeners.add(Yy.ContextMenu,Jy),this.documentListeners.add(Yy.Keydown,this.handleKeydown),t){if(null!=n&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(ib(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(rb(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:r}=this.props;r(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Yy.Click,Zy,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Yy.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:r,props:i}=this,{onMove:s,options:{activationConstraint:a}}=i;if(!r)return;const o=null!=(t=ey(e))?t:py,l=Jv(r,o);if(!n&&a){if(rb(a)){if(null!=a.tolerance&&Qy(l,a.tolerance))return this.handleCancel();if(Qy(l,a.distance))return this.handleStart()}return ib(a)&&Qy(l,a.tolerance)?this.handleCancel():void this.handlePending(a,l)}e.cancelable&&e.preventDefault(),s(o)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===Xy.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const ab={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ob extends sb{constructor(e){const{event:t}=e,n=Bv(t.target);super(e,ab,n)}}ob.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!(!n.isPrimary||0!==n.button)&&(null==r||r({event:n}),!0)}}];const lb={move:{name:"mousemove"},end:{name:"mouseup"}};var cb;!function(e){e[e.RightClick=2]="RightClick"}(cb||(cb={}));(class extends sb{constructor(e){super(e,lb,Bv(e.event.target))}}).activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button!==cb.RightClick&&(null==r||r({event:n}),!0)}}];const ub={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var db,hb;function fb(e){let{acceleration:t,activator:n=db.Pointer,canScroll:r,draggingRect:s,enabled:a,interval:o=5,order:l=hb.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:f}=e;const p=function(e){let{delta:t,disabled:n}=e;const r=Kv(t);return Hv(e=>{if(n||!r||!e)return pb;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[Fy.Backward]:e.x[Fy.Backward]||-1===i.x,[Fy.Forward]:e.x[Fy.Forward]||1===i.x},y:{[Fy.Backward]:e.y[Fy.Backward]||-1===i.y,[Fy.Forward]:e.y[Fy.Forward]||1===i.y}}},[n,t,r])}({delta:h,disabled:!a}),[m,g]=function(){const e=(0,i.useRef)(null);return[(0,i.useCallback)((t,n)=>{e.current=setInterval(t,n)},[]),(0,i.useCallback)(()=>{null!==e.current&&(clearInterval(e.current),e.current=null)},[])]}(),v=(0,i.useRef)({x:0,y:0}),y=(0,i.useRef)({x:0,y:0}),b=(0,i.useMemo)(()=>{switch(n){case db.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case db.DraggableRect:return s}},[n,s,c]),w=(0,i.useRef)(null),x=(0,i.useCallback)(()=>{const e=w.current;if(!e)return;const t=v.current.x*y.current.x,n=v.current.y*y.current.y;e.scrollBy(t,n)},[]),_=(0,i.useMemo)(()=>l===hb.TreeOrder?[...u].reverse():u,[l,u]);(0,i.useEffect)(()=>{if(a&&u.length&&b){for(const e of _){if(!1===(null==r?void 0:r(e)))continue;const n=u.indexOf(e),i=d[n];if(!i)continue;const{direction:s,speed:a}=zy(e,i,b,t,f);for(const e of["x","y"])p[e][s[e]]||(a[e]=0,s[e]=0);if(a.x>0||a.y>0)return g(),w.current=e,m(x,o),v.current=a,void(y.current=s)}v.current={x:0,y:0},y.current={x:0,y:0},g()}else g()},[t,x,r,g,a,o,JSON.stringify(b),JSON.stringify(p),m,u,_,d,JSON.stringify(f)])}(class extends sb{constructor(e){super(e,ub)}static setup(){return window.addEventListener(ub.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(ub.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:i}=n;return!(i.length>1)&&(null==r||r({event:n}),!0)}}],function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"}(db||(db={})),function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"}(hb||(hb={}));const pb={x:{[Fy.Backward]:!1,[Fy.Forward]:!1},y:{[Fy.Backward]:!1,[Fy.Forward]:!1}};var mb,gb;!function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"}(mb||(mb={})),function(e){e.Optimized="optimized"}(gb||(gb={}));const vb=new Map;function yb(e,t){return Hv(n=>e?n||("function"===typeof t?t(e):e):null,[t,e])}function bb(e){let{callback:t,disabled:n}=e;const r=$v(t),s=(0,i.useMemo)(()=>{if(n||"undefined"===typeof window||"undefined"===typeof window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(r)},[n]);return(0,i.useEffect)(()=>()=>null==s?void 0:s.disconnect(),[s]),s}function wb(e){return new Ky(Ty(e),e)}function xb(e,t,n){void 0===t&&(t=wb);const[r,s]=(0,i.useState)(null);function a(){s(r=>{if(!e)return null;var i;if(!1===e.isConnected)return null!=(i=null!=r?r:n)?i:null;const s=t(e);return JSON.stringify(r)===JSON.stringify(s)?r:s})}const o=function(e){let{callback:t,disabled:n}=e;const r=$v(t),s=(0,i.useMemo)(()=>{if(n||"undefined"===typeof window||"undefined"===typeof window.MutationObserver)return;const{MutationObserver:e}=window;return new e(r)},[r,n]);return(0,i.useEffect)(()=>()=>null==s?void 0:s.disconnect(),[s]),s}({callback(t){if(e)for(const n of t){const{type:t,target:r}=n;if("childList"===t&&r instanceof HTMLElement&&r.contains(e)){a();break}}}}),l=bb({callback:a});return zv(()=>{a(),e?(null==l||l.observe(e),null==o||o.observe(document.body,{childList:!0,subtree:!0})):(null==l||l.disconnect(),null==o||o.disconnect())},[e]),r}const _b=[];function Nb(e,t){void 0===t&&(t=[]);const n=(0,i.useRef)(null);return(0,i.useEffect)(()=>{n.current=null},t),(0,i.useEffect)(()=>{const t=e!==py;t&&!n.current&&(n.current=e),!t&&n.current&&(n.current=null)},[e]),n.current?Jv(e,n.current):py}function Eb(e){return(0,i.useMemo)(()=>e?function(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}(e):null,[e])}const kb=[];function Sb(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Uv(t)?t:e}const Cb=[{sensor:ob,options:{}},{sensor:nb,options:{}}],jb={current:{}},Ib={draggable:{measure:Ay},droppable:{measure:Ay,strategy:mb.WhileDragging,frequency:gb.Optimized},dragOverlay:{measure:Ty}};class Tb extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return null!=(t=null==(n=this.get(e))?void 0:n.node.current)?t:void 0}}const Ab={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Tb,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:hy},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ib,measureDroppableContainers:hy,windowRect:null,measuringScheduled:!1},Rb={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:hy,draggableNodes:new Map,over:null,measureDroppableContainers:hy},Db=(0,i.createContext)(Rb),Pb=(0,i.createContext)(Ab);function Ob(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Tb}}}function Lb(e,t){switch(t.type){case dy.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case dy.DragMove:return null==e.draggable.active?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case dy.DragEnd:case dy.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case dy.RegisterDroppable:{const{element:n}=t,{id:r}=n,i=new Tb(e.droppable.containers);return i.set(r,n),{...e,droppable:{...e.droppable,containers:i}}}case dy.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const a=new Tb(e.droppable.containers);return a.set(n,{...s,disabled:i}),{...e,droppable:{...e.droppable,containers:a}}}case dy.UnregisterDroppable:{const{id:n,key:r}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const s=new Tb(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function Mb(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=(0,i.useContext)(Db),a=Kv(r),o=Kv(null==n?void 0:n.id);return(0,i.useEffect)(()=>{if(!t&&!r&&a&&null!=o){if(!Zv(a))return;if(document.activeElement===a.target)return;const e=s.get(o);if(!e)return;const{activatorNode:t,node:n}=e;if(!t.current&&!n.current)return;requestAnimationFrame(()=>{for(const e of[t.current,n.current]){if(!e)continue;const t=ry(e);if(t){t.focus();break}}})}},[r,t,s,o,a]),null}function Fb(e,t){let{transform:n,...r}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...r}),n):n}const Ub=(0,i.createContext)({...py,scaleX:1,scaleY:1});var Vb;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(Vb||(Vb={}));const Bb=(0,i.memo)(function(e){var t,n,r,s;let{id:a,accessibility:l,autoScroll:c=!0,children:u,sensors:d=Cb,collisionDetection:h=Ey,measuring:f,modifiers:p,...m}=e;const g=(0,i.useReducer)(Lb,void 0,Ob),[v,y]=g,[b,w]=function(){const[e]=(0,i.useState)(()=>new Set),t=(0,i.useCallback)(t=>(e.add(t),()=>e.delete(t)),[e]);return[(0,i.useCallback)(t=>{let{type:n,event:r}=t;e.forEach(e=>{var t;return null==(t=e[n])?void 0:t.call(e,r)})},[e]),t]}(),[x,_]=(0,i.useState)(Vb.Uninitialized),N=x===Vb.Initialized,{draggable:{active:E,nodes:k,translate:S},droppable:{containers:C}}=v,j=null!=E?k.get(E):null,I=(0,i.useRef)({initial:null,translated:null}),T=(0,i.useMemo)(()=>{var e;return null!=E?{id:E,data:null!=(e=null==j?void 0:j.data)?e:jb,rect:I}:null},[E,j]),A=(0,i.useRef)(null),[R,D]=(0,i.useState)(null),[P,O]=(0,i.useState)(null),L=qv(m,Object.values(m)),M=Qv("DndDescribedBy",a),F=(0,i.useMemo)(()=>C.getEnabled(),[C]),U=(V=f,(0,i.useMemo)(()=>({draggable:{...Ib.draggable,...null==V?void 0:V.draggable},droppable:{...Ib.droppable,...null==V?void 0:V.droppable},dragOverlay:{...Ib.dragOverlay,...null==V?void 0:V.dragOverlay}}),[null==V?void 0:V.draggable,null==V?void 0:V.droppable,null==V?void 0:V.dragOverlay]));var V;const{droppableRects:B,measureDroppableContainers:z,measuringScheduled:$}=function(e,t){let{dragging:n,dependencies:r,config:s}=t;const[a,o]=(0,i.useState)(null),{frequency:l,measure:c,strategy:u}=s,d=(0,i.useRef)(e),h=function(){switch(u){case mb.Always:return!1;case mb.BeforeDragging:return n;default:return!n}}(),f=qv(h),p=(0,i.useCallback)(function(e){void 0===e&&(e=[]),f.current||o(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[f]),m=(0,i.useRef)(null),g=Hv(t=>{if(h&&!n)return vb;if(!t||t===vb||d.current!==e||null!=a){const t=new Map;for(let n of e){if(!n)continue;if(a&&a.length>0&&!a.includes(n.id)&&n.rect.current){t.set(n.id,n.rect.current);continue}const e=n.node.current,r=e?new Ky(c(e),e):null;n.rect.current=r,r&&t.set(n.id,r)}return t}return t},[e,a,n,h,c]);return(0,i.useEffect)(()=>{d.current=e},[e]),(0,i.useEffect)(()=>{h||p()},[n,h]),(0,i.useEffect)(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),(0,i.useEffect)(()=>{h||"number"!==typeof l||null!==m.current||(m.current=setTimeout(()=>{p(),m.current=null},l))},[l,h,p,...r]),{droppableRects:g,measureDroppableContainers:p,measuringScheduled:null!=a}}(F,{dragging:N,dependencies:[S.x,S.y],config:U.droppable}),q=function(e,t){const n=null!=t?e.get(t):void 0,r=n?n.node.current:null;return Hv(e=>{var n;return null==t?null:null!=(n=null!=r?r:e)?n:null},[r,t])}(k,E),H=(0,i.useMemo)(()=>P?ey(P):null,[P]),W=function(){const e=!1===(null==R?void 0:R.autoScrollEnabled),t="object"===typeof c?!1===c.enabled:!1===c,n=N&&!e&&!t;if("object"===typeof c)return{...c,enabled:n};return{enabled:n}}(),K=function(e,t){return yb(e,t)}(q,U.draggable.measure);!function(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const a=(0,i.useRef)(!1),{x:o,y:l}="boolean"===typeof s?{x:s,y:s}:s;zv(()=>{if(!o&&!l||!t)return void(a.current=!1);if(a.current||!r)return;const e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;const i=ky(n(e),r);if(o||(i.x=0),l||(i.y=0),a.current=!0,Math.abs(i.x)>0||Math.abs(i.y)>0){const t=Dy(e);t&&t.scrollBy({top:i.y,left:i.x})}},[t,o,l,r,n])}({activeNode:null!=E?k.get(E):null,config:W.layoutShiftCompensation,initialRect:K,measure:U.draggable.measure});const G=xb(q,U.draggable.measure,K),Q=xb(q?q.parentElement:null),Y=(0,i.useRef)({activatorEvent:null,active:null,activeNode:q,collisionRect:null,collisions:null,droppableRects:B,draggableNodes:k,draggingNode:null,draggingNodeRect:null,droppableContainers:C,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),X=C.getNodeFor(null==(t=Y.current.over)?void 0:t.id),J=function(e){let{measure:t}=e;const[n,r]=(0,i.useState)(null),s=bb({callback:(0,i.useCallback)(e=>{for(const{target:n}of e)if(Uv(n)){r(e=>{const r=t(n);return e?{...e,width:r.width,height:r.height}:r});break}},[t])}),a=(0,i.useCallback)(e=>{const n=Sb(e);null==s||s.disconnect(),n&&(null==s||s.observe(n)),r(n?t(n):null)},[t,s]),[o,l]=Wv(a);return(0,i.useMemo)(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}({measure:U.dragOverlay.measure}),Z=null!=(n=J.nodeRef.current)?n:q,ee=N?null!=(r=J.rect)?r:G:null,te=Boolean(J.nodeRef.current&&J.rect),ne=ky(re=te?null:G,yb(re));var re;const ie=Eb(Z?Mv(Z):null),se=function(e){const t=(0,i.useRef)(e),n=Hv(n=>e?n&&n!==_b&&e&&t.current&&e.parentNode===t.current.parentNode?n:Ry(e):_b,[e]);return(0,i.useEffect)(()=>{t.current=e},[e]),n}(N?null!=X?X:q:null),ae=function(e,t){void 0===t&&(t=Ty);const[n]=e,r=Eb(n?Mv(n):null),[s,a]=(0,i.useState)(kb);function o(){a(()=>e.length?e.map(e=>Uy(e)?r:new Ky(t(e),e)):kb)}const l=bb({callback:o});return zv(()=>{null==l||l.disconnect(),o(),e.forEach(e=>null==l?void 0:l.observe(e))},[e]),s}(se),oe=Fb(p,{transform:{x:S.x-ne.x,y:S.y-ne.y,scaleX:1,scaleY:1},activatorEvent:P,active:T,activeNodeRect:G,containerNodeRect:Q,draggingNodeRect:ee,over:Y.current.over,overlayNodeRect:J.rect,scrollableAncestors:se,scrollableAncestorRects:ae,windowRect:ie}),le=H?Xv(H,S):null,ce=function(e){const[t,n]=(0,i.useState)(null),r=(0,i.useRef)(e),s=(0,i.useCallback)(e=>{const t=Py(e.target);t&&n(e=>e?(e.set(t,My(t)),new Map(e)):null)},[]);return(0,i.useEffect)(()=>{const t=r.current;if(e!==t){i(t);const a=e.map(e=>{const t=Py(e);return t?(t.addEventListener("scroll",s,{passive:!0}),[t,My(t)]):null}).filter(e=>null!=e);n(a.length?new Map(a):null),r.current=e}return()=>{i(e),i(t)};function i(e){e.forEach(e=>{const t=Py(e);null==t||t.removeEventListener("scroll",s)})}},[s,e]),(0,i.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>Xv(e,t),py):qy(e):py,[e,t])}(se),ue=Nb(ce),de=Nb(ce,[G]),he=Xv(oe,ue),fe=ee?Cy(ee,oe):null,pe=T&&fe?h({active:T,collisionRect:fe,droppableRects:B,droppableContainers:F,pointerCoordinates:le}):null,me=wy(pe,"id"),[ge,ve]=(0,i.useState)(null),ye=function(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}(te?oe:Xv(oe,de),null!=(s=null==ge?void 0:ge.rect)?s:null,G),be=(0,i.useRef)(null),we=(0,i.useCallback)((e,t)=>{let{sensor:n,options:r}=t;if(null==A.current)return;const i=k.get(A.current);if(!i)return;const s=e.nativeEvent,a=new n({active:A.current,activeNode:i,event:s,options:r,context:Y,onAbort(e){if(!k.get(e))return;const{onDragAbort:t}=L.current,n={id:e};null==t||t(n),b({type:"onDragAbort",event:n})},onPending(e,t,n,r){if(!k.get(e))return;const{onDragPending:i}=L.current,s={id:e,constraint:t,initialCoordinates:n,offset:r};null==i||i(s),b({type:"onDragPending",event:s})},onStart(e){const t=A.current;if(null==t)return;const n=k.get(t);if(!n)return;const{onDragStart:r}=L.current,i={activatorEvent:s,active:{id:t,data:n.data,rect:I}};(0,o.unstable_batchedUpdates)(()=>{null==r||r(i),_(Vb.Initializing),y({type:dy.DragStart,initialCoordinates:e,active:t}),b({type:"onDragStart",event:i}),D(be.current),O(s)})},onMove(e){y({type:dy.DragMove,coordinates:e})},onEnd:l(dy.DragEnd),onCancel:l(dy.DragCancel)});function l(e){return async function(){const{active:t,collisions:n,over:r,scrollAdjustedTranslate:i}=Y.current;let a=null;if(t&&i){const{cancelDrop:o}=L.current;if(a={activatorEvent:s,active:t,collisions:n,delta:i,over:r},e===dy.DragEnd&&"function"===typeof o){await Promise.resolve(o(a))&&(e=dy.DragCancel)}}A.current=null,(0,o.unstable_batchedUpdates)(()=>{y({type:e}),_(Vb.Uninitialized),ve(null),D(null),O(null),be.current=null;const t=e===dy.DragEnd?"onDragEnd":"onDragCancel";if(a){const e=L.current[t];null==e||e(a),b({type:t,event:a})}})}}be.current=a},[k]),xe=(0,i.useCallback)((e,t)=>(n,r)=>{const i=n.nativeEvent,s=k.get(r);if(null!==A.current||!s||i.dndKit||i.defaultPrevented)return;const a={active:s};!0===e(n,t.options,a)&&(i.dndKit={capturedBy:t.sensor},A.current=r,we(n,t))},[k,we]),_e=function(e,t){return(0,i.useMemo)(()=>e.reduce((e,n)=>{const{sensor:r}=n;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:t(e.handler,n)}))]},[]),[e,t])}(d,xe);!function(e){(0,i.useEffect)(()=>{if(!Pv)return;const t=e.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(const e of t)null==e||e()}},e.map(e=>{let{sensor:t}=e;return t}))}(d),zv(()=>{G&&x===Vb.Initializing&&_(Vb.Initialized)},[G,x]),(0,i.useEffect)(()=>{const{onDragMove:e}=L.current,{active:t,activatorEvent:n,collisions:r,over:i}=Y.current;if(!t||!n)return;const s={active:t,activatorEvent:n,collisions:r,delta:{x:he.x,y:he.y},over:i};(0,o.unstable_batchedUpdates)(()=>{null==e||e(s),b({type:"onDragMove",event:s})})},[he.x,he.y]),(0,i.useEffect)(()=>{const{active:e,activatorEvent:t,collisions:n,droppableContainers:r,scrollAdjustedTranslate:i}=Y.current;if(!e||null==A.current||!t||!i)return;const{onDragOver:s}=L.current,a=r.get(me),l=a&&a.rect.current?{id:a.id,rect:a.rect.current,data:a.data,disabled:a.disabled}:null,c={active:e,activatorEvent:t,collisions:n,delta:{x:i.x,y:i.y},over:l};(0,o.unstable_batchedUpdates)(()=>{ve(l),null==s||s(c),b({type:"onDragOver",event:c})})},[me]),zv(()=>{Y.current={activatorEvent:P,active:T,activeNode:q,collisionRect:fe,collisions:pe,droppableRects:B,draggableNodes:k,draggingNode:Z,draggingNodeRect:ee,droppableContainers:C,over:ge,scrollableAncestors:se,scrollAdjustedTranslate:he},I.current={initial:ee,translated:fe}},[T,q,pe,fe,k,Z,ee,B,C,ge,se,he]),fb({...W,delta:S,draggingRect:fe,pointerCoordinates:le,scrollableAncestors:se,scrollableAncestorRects:ae});const Ne=(0,i.useMemo)(()=>({active:T,activeNode:q,activeNodeRect:G,activatorEvent:P,collisions:pe,containerNodeRect:Q,dragOverlay:J,draggableNodes:k,droppableContainers:C,droppableRects:B,over:ge,measureDroppableContainers:z,scrollableAncestors:se,scrollableAncestorRects:ae,measuringConfiguration:U,measuringScheduled:$,windowRect:ie}),[T,q,G,P,pe,Q,J,k,C,B,ge,z,se,ae,U,$,ie]),Ee=(0,i.useMemo)(()=>({activatorEvent:P,activators:_e,active:T,activeNodeRect:G,ariaDescribedById:{draggable:M},dispatch:y,draggableNodes:k,over:ge,measureDroppableContainers:z}),[P,_e,T,G,y,M,k,ge,z]);return i.createElement(oy.Provider,{value:w},i.createElement(Db.Provider,{value:Ee},i.createElement(Pb.Provider,{value:Ne},i.createElement(Ub.Provider,{value:ye},u)),i.createElement(Mb,{disabled:!1===(null==l?void 0:l.restoreFocus)})),i.createElement(uy,{...l,hiddenTextDescribedById:M}))}),zb=(0,i.createContext)(null),$b="button";function qb(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const a=Qv("Draggable"),{activators:o,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:h,over:f}=(0,i.useContext)(Db),{role:p=$b,roleDescription:m="draggable",tabIndex:g=0}=null!=s?s:{},v=(null==c?void 0:c.id)===t,y=(0,i.useContext)(v?Ub:zb),[b,w]=Wv(),[x,_]=Wv(),N=function(e,t){return(0,i.useMemo)(()=>e.reduce((e,n)=>{let{eventName:r,handler:i}=n;return e[r]=e=>{i(e,t)},e},{}),[e,t])}(o,t),E=qv(n);zv(()=>(h.set(t,{id:t,key:a,node:b,activatorNode:x,data:E}),()=>{const e=h.get(t);e&&e.key===a&&h.delete(t)}),[h,t]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:(0,i.useMemo)(()=>({role:p,tabIndex:g,"aria-disabled":r,"aria-pressed":!(!v||p!==$b)||void 0,"aria-roledescription":m,"aria-describedby":d.draggable}),[r,p,g,v,m,d.draggable]),isDragging:v,listeners:r?void 0:N,node:b,over:f,setNodeRef:w,setActivatorNodeRef:_,transform:y}}function Hb(){return(0,i.useContext)(Pb)}const Wb={timeout:25};function Kb(e){let{animation:t,children:n}=e;const[r,s]=(0,i.useState)(null),[a,o]=(0,i.useState)(null),l=Kv(n);return n||r||!l||s(l),zv(()=>{if(!a)return;const e=null==r?void 0:r.key,n=null==r?void 0:r.props.id;null!=e&&null!=n?Promise.resolve(t(n,a)).then(()=>{s(null)}):s(null)},[t,r,a]),i.createElement(i.Fragment,null,n,r?(0,i.cloneElement)(r,{ref:o}):null)}const Gb={x:0,y:0,scaleX:1,scaleY:1};function Qb(e){let{children:t}=e;return i.createElement(Db.Provider,{value:Rb},i.createElement(Ub.Provider,{value:Gb},t))}const Yb={position:"fixed",touchAction:"none"},Xb=e=>Zv(e)?"transform 250ms ease":void 0,Jb=(0,i.forwardRef)((e,t)=>{let{as:n,activatorEvent:r,adjustScale:s,children:a,className:o,rect:l,style:c,transform:u,transition:d=Xb}=e;if(!l)return null;const h=s?u:{...u,scaleX:1,scaleY:1},f={...Yb,width:l.width,height:l.height,top:l.top,left:l.left,transform:ty.Transform.toString(h),transformOrigin:s&&r?gy(r,l):void 0,transition:"function"===typeof d?d(r):d,...c};return i.createElement(n,{className:o,style:f,ref:t},a)}),Zb=e=>t=>{let{active:n,dragOverlay:r}=t;const i={},{styles:s,className:a}=e;if(null!=s&&s.active)for(const[e,o]of Object.entries(s.active))void 0!==o&&(i[e]=n.node.style.getPropertyValue(e),n.node.style.setProperty(e,o));if(null!=s&&s.dragOverlay)for(const[e,o]of Object.entries(s.dragOverlay))void 0!==o&&r.node.style.setProperty(e,o);return null!=a&&a.active&&n.node.classList.add(a.active),null!=a&&a.dragOverlay&&r.node.classList.add(a.dragOverlay),function(){for(const[e,t]of Object.entries(i))n.node.style.setProperty(e,t);null!=a&&a.active&&n.node.classList.remove(a.active)}},ew={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:n}}=e;return[{transform:ty.Transform.toString(t)},{transform:ty.Transform.toString(n)}]},sideEffects:Zb({styles:{active:{opacity:"0"}}})};function tw(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:i}=e;return $v((e,s)=>{if(null===t)return;const a=n.get(e);if(!a)return;const o=a.node.current;if(!o)return;const l=Sb(s);if(!l)return;const{transform:c}=Mv(s).getComputedStyle(s),u=jy(c);if(!u)return;const d="function"===typeof t?t:function(e){const{duration:t,easing:n,sideEffects:r,keyframes:i}={...ew,...e};return e=>{let{active:s,dragOverlay:a,transform:o,...l}=e;if(!t)return;const c={x:a.rect.left-s.rect.left,y:a.rect.top-s.rect.top},u={scaleX:1!==o.scaleX?s.rect.width*o.scaleX/a.rect.width:1,scaleY:1!==o.scaleY?s.rect.height*o.scaleY/a.rect.height:1},d={x:o.x-c.x,y:o.y-c.y,...u},h=i({...l,active:s,dragOverlay:a,transform:{initial:o,final:d}}),[f]=h,p=h[h.length-1];if(JSON.stringify(f)===JSON.stringify(p))return;const m=null==r?void 0:r({active:s,dragOverlay:a,...l}),g=a.node.animate(h,{duration:t,easing:n,fill:"forwards"});return new Promise(e=>{g.onfinish=()=>{null==m||m(),e()}})}}(t);return Hy(o,i.draggable.measure),d({active:{id:e,data:a.data,node:o,rect:i.draggable.measure(o)},draggableNodes:n,dragOverlay:{node:s,rect:i.dragOverlay.measure(l)},droppableContainers:r,measuringConfiguration:i,transform:u})})}let nw=0;function rw(e){return(0,i.useMemo)(()=>{if(null!=e)return nw++,nw},[e])}const iw=i.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:r,style:s,transition:a,modifiers:o,wrapperElement:l="div",className:c,zIndex:u=999}=e;const{activatorEvent:d,active:h,activeNodeRect:f,containerNodeRect:p,draggableNodes:m,droppableContainers:g,dragOverlay:v,over:y,measuringConfiguration:b,scrollableAncestors:w,scrollableAncestorRects:x,windowRect:_}=Hb(),N=(0,i.useContext)(Ub),E=rw(null==h?void 0:h.id),k=Fb(o,{activatorEvent:d,active:h,activeNodeRect:f,containerNodeRect:p,draggingNodeRect:v.rect,over:y,overlayNodeRect:v.rect,scrollableAncestors:w,scrollableAncestorRects:x,transform:N,windowRect:_}),S=yb(f),C=tw({config:r,draggableNodes:m,droppableContainers:g,measuringConfiguration:b}),j=S?v.setRef:void 0;return i.createElement(Qb,null,i.createElement(Kb,{animation:C},h&&E?i.createElement(Jb,{key:E,id:h.id,ref:j,as:l,activatorEvent:d,adjustScale:t,className:c,transition:a,rect:S,style:{zIndex:u,...s},transform:k},n):null))});function sw(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function aw(e,t){return e.reduce((e,n,r)=>{const i=t.get(n);return i&&(e[r]=i),e},Array(e.length))}function ow(e){return null!==e&&e>=0}const lw=e=>{let{rects:t,activeIndex:n,overIndex:r,index:i}=e;const s=sw(t,r,n),a=t[i],o=s[i];return o&&a?{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}:null},cw={scaleX:1,scaleY:1},uw=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:i,rects:s,overIndex:a}=e;const o=null!=(t=s[n])?t:r;if(!o)return null;if(i===n){const e=s[a];return e?{x:0,y:n<a?e.top+e.height-(o.top+o.height):e.top-o.top,...cw}:null}const l=function(e,t,n){const r=e[t],i=e[t-1],s=e[t+1];if(!r)return 0;if(n<t)return i?r.top-(i.top+i.height):s?s.top-(r.top+r.height):0;return s?s.top-(r.top+r.height):i?r.top-(i.top+i.height):0}(s,i,n);return i>n&&i<=a?{x:0,y:-o.height-l,...cw}:i<n&&i>=a?{x:0,y:o.height+l,...cw}:{x:0,y:0,...cw}};const dw="Sortable",hw=i.createContext({activeIndex:-1,containerId:dw,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:lw,disabled:{draggable:!1,droppable:!1}});function fw(e){let{children:t,id:n,items:r,strategy:s=lw,disabled:a=!1}=e;const{active:o,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=Hb(),h=Qv(dw,n),f=Boolean(null!==l.rect),p=(0,i.useMemo)(()=>r.map(e=>"object"===typeof e&&"id"in e?e.id:e),[r]),m=null!=o,g=o?p.indexOf(o.id):-1,v=u?p.indexOf(u.id):-1,y=(0,i.useRef)(p),b=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(p,y.current),w=-1!==v&&-1===g||b,x=function(e){return"boolean"===typeof e?{draggable:e,droppable:e}:e}(a);zv(()=>{b&&m&&d(p)},[b,p,m,d]),(0,i.useEffect)(()=>{y.current=p},[p]);const _=(0,i.useMemo)(()=>({activeIndex:g,containerId:h,disabled:x,disableTransforms:w,items:p,overIndex:v,useDragOverlay:f,sortedRects:aw(p,c),strategy:s}),[g,h,x.draggable,x.droppable,w,p,v,c,f,s]);return i.createElement(hw.Provider,{value:_},t)}const pw=e=>{let{id:t,items:n,activeIndex:r,overIndex:i}=e;return sw(n,r,i).indexOf(t)},mw=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:i,items:s,newIndex:a,previousItems:o,previousContainerId:l,transition:c}=e;return!(!c||!r)&&((o===s||i!==a)&&(!!n||a!==i&&t===l))},gw={duration:200,easing:"ease"},vw="transform",yw=ty.Transition.toString({property:vw,duration:0,easing:"linear"}),bw={roleDescription:"sortable"};function ww(e){let{animateLayoutChanges:t=mw,attributes:n,disabled:r,data:s,getNewIndex:a=pw,id:o,strategy:l,resizeObserverConfig:c,transition:u=gw}=e;const{items:d,containerId:h,activeIndex:f,disabled:p,disableTransforms:m,sortedRects:g,overIndex:v,useDragOverlay:y,strategy:b}=(0,i.useContext)(hw),w=function(e,t){var n,r;if("boolean"===typeof e)return{draggable:e,droppable:!1};return{draggable:null!=(n=null==e?void 0:e.draggable)?n:t.draggable,droppable:null!=(r=null==e?void 0:e.droppable)?r:t.droppable}}(r,p),x=d.indexOf(o),_=(0,i.useMemo)(()=>({sortable:{containerId:h,index:x,items:d},...s}),[h,s,x,d]),N=(0,i.useMemo)(()=>d.slice(d.indexOf(o)),[d,o]),{rect:E,node:k,isOver:S,setNodeRef:C}=function(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const a=Qv("Droppable"),{active:o,dispatch:l,over:c,measureDroppableContainers:u}=(0,i.useContext)(Db),d=(0,i.useRef)({disabled:n}),h=(0,i.useRef)(!1),f=(0,i.useRef)(null),p=(0,i.useRef)(null),{disabled:m,updateMeasurementsFor:g,timeout:v}={...Wb,...s},y=qv(null!=g?g:r),b=bb({callback:(0,i.useCallback)(()=>{h.current?(null!=p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(y.current)?y.current:[y.current]),p.current=null},v)):h.current=!0},[v]),disabled:m||!o}),w=(0,i.useCallback)((e,t)=>{b&&(t&&(b.unobserve(t),h.current=!1),e&&b.observe(e))},[b]),[x,_]=Wv(w),N=qv(t);return(0,i.useEffect)(()=>{b&&x.current&&(b.disconnect(),h.current=!1,b.observe(x.current))},[x,b]),(0,i.useEffect)(()=>(l({type:dy.RegisterDroppable,element:{id:r,key:a,disabled:n,node:x,rect:f,data:N}}),()=>l({type:dy.UnregisterDroppable,key:a,id:r})),[r]),(0,i.useEffect)(()=>{n!==d.current.disabled&&(l({type:dy.SetDroppableDisabled,id:r,key:a,disabled:n}),d.current.disabled=n)},[r,a,n,l]),{active:o,rect:f,isOver:(null==c?void 0:c.id)===r,node:x,over:c,setNodeRef:_}}({id:o,data:_,disabled:w.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...c}}),{active:j,activatorEvent:I,activeNodeRect:T,attributes:A,setNodeRef:R,listeners:D,isDragging:P,over:O,setActivatorNodeRef:L,transform:M}=qb({id:o,data:_,attributes:{...bw,...n},disabled:w.draggable}),F=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,i.useMemo)(()=>e=>{t.forEach(t=>t(e))},t)}(C,R),U=Boolean(j),V=U&&!m&&ow(f)&&ow(v),B=!y&&P,z=B&&V?M:null,$=V?null!=z?z:(null!=l?l:b)({rects:g,activeNodeRect:T,activeIndex:f,overIndex:v,index:x}):null,q=ow(f)&&ow(v)?a({id:o,items:d,activeIndex:f,overIndex:v}):x,H=null==j?void 0:j.id,W=(0,i.useRef)({activeId:H,items:d,newIndex:q,containerId:h}),K=d!==W.current.items,G=t({active:j,containerId:h,isDragging:P,isSorting:U,id:o,index:x,items:d,newIndex:W.current.newIndex,previousItems:W.current.items,previousContainerId:W.current.containerId,transition:u,wasDragging:null!=W.current.activeId}),Q=function(e){let{disabled:t,index:n,node:r,rect:s}=e;const[a,o]=(0,i.useState)(null),l=(0,i.useRef)(n);return zv(()=>{if(!t&&n!==l.current&&r.current){const e=s.current;if(e){const t=Ty(r.current,{ignoreTransform:!0}),n={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(n.x||n.y)&&o(n)}}n!==l.current&&(l.current=n)},[t,n,r,s]),(0,i.useEffect)(()=>{a&&o(null)},[a]),a}({disabled:!G,index:x,node:k,rect:E});return(0,i.useEffect)(()=>{U&&W.current.newIndex!==q&&(W.current.newIndex=q),h!==W.current.containerId&&(W.current.containerId=h),d!==W.current.items&&(W.current.items=d)},[U,q,h,d]),(0,i.useEffect)(()=>{if(H===W.current.activeId)return;if(null!=H&&null==W.current.activeId)return void(W.current.activeId=H);const e=setTimeout(()=>{W.current.activeId=H},50);return()=>clearTimeout(e)},[H]),{active:j,activeIndex:f,attributes:A,data:_,rect:E,index:x,newIndex:q,items:d,isOver:S,isSorting:U,isDragging:P,listeners:D,node:k,overIndex:v,over:O,setNodeRef:F,setActivatorNodeRef:L,setDroppableNodeRef:C,setDraggableNodeRef:R,transform:null!=Q?Q:$,transition:function(){if(Q||K&&W.current.newIndex===x)return yw;if(B&&!Zv(I)||!u)return;if(U||G)return ty.Transition.toString({...u,property:vw});return}()}}function xw(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&"object"===typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const _w=[Xy.Down,Xy.Right,Xy.Up,Xy.Left],Nw=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:i,droppableContainers:s,over:a,scrollableAncestors:o}}=t;if(_w.includes(e.code)){if(e.preventDefault(),!n||!r)return;const t=[];s.getEnabled().forEach(n=>{if(!n||null!=n&&n.disabled)return;const s=i.get(n.id);if(s)switch(e.code){case Xy.Down:r.top<s.top&&t.push(n);break;case Xy.Up:r.top>s.top&&t.push(n);break;case Xy.Left:r.left>s.left&&t.push(n);break;case Xy.Right:r.left<s.left&&t.push(n)}});const l=(e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=by(t),s=[];for(const a of r){const{id:e}=a,t=n.get(e);if(t){const n=by(t),r=i.reduce((e,t,r)=>e+my(n[r],t),0),o=Number((r/4).toFixed(4));s.push({id:e,data:{droppableContainer:a,value:o}})}}return s.sort(vy)})({active:n,collisionRect:r,droppableRects:i,droppableContainers:t,pointerCoordinates:null});let c=wy(l,"id");if(c===(null==a?void 0:a.id)&&l.length>1&&(c=l[1].id),null!=c){const e=s.get(n.id),t=s.get(c),a=t?i.get(t.id):null,l=null==t?void 0:t.node.current;if(l&&a&&e&&t){const n=Ry(l).some((e,t)=>o[t]!==e),i=Ew(e,t),s=function(e,t){if(!xw(e)||!xw(t))return!1;if(!Ew(e,t))return!1;return e.data.current.sortable.index<t.data.current.sortable.index}(e,t),c=n||!i?{x:0,y:0}:{x:s?r.width-a.width:0,y:s?r.height-a.height:0},u={x:a.left,y:a.top};return c.x&&c.y?u:Jv(u,c)}}}};function Ew(e,t){return!(!xw(e)||!xw(t))&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}function kw(e){let{item:t,onUpdate:n,onRemove:r}=e;const[s,a]=(0,i.useState)(!1),[o,l]=(0,i.useState)(t.notes||""),[c,u]=(0,i.useState)(t.serves||0);(0,i.useEffect)(()=>{u(t.serves||0)},[t.serves]);const{attributes:d,listeners:h,setNodeRef:f,transform:p,transition:m,isDragging:g}=ww({id:t.id}),v={transform:ty.Transform.toString(p),transition:m,opacity:g?.5:1};return(0,Ng.jsx)("div",{ref:f,style:v,className:"menu-item",children:(0,Ng.jsxs)("div",{className:"item-main",children:[(0,Ng.jsx)("div",{className:"drag-handle",...d,...h,children:"\u22ee\u22ee"}),(0,Ng.jsxs)("div",{className:"item-content",children:[(0,Ng.jsxs)("div",{className:"item-header",children:[(0,Ng.jsx)("h4",{className:"item-name",children:t.recipe_name}),s?(0,Ng.jsxs)("div",{className:"serves-editor",children:[(0,Ng.jsx)("label",{children:"Serves:"}),(0,Ng.jsx)("input",{type:"number",value:c,onChange:e=>u(e.target.value),min:"1",className:"serves-input"})]}):(0,Ng.jsxs)("span",{className:"item-serves",children:["Serves ",t.serves||"?"]})]}),t.notes&&!s&&(0,Ng.jsx)("p",{className:"item-notes",children:t.notes}),s&&(0,Ng.jsxs)("div",{className:"notes-editor",children:[(0,Ng.jsx)("textarea",{value:o,onChange:e=>{l(e.target.value)},placeholder:"Add notes about this item...",rows:"2",autoFocus:!0}),(0,Ng.jsxs)("div",{className:"notes-actions",children:[(0,Ng.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",onClick:()=>{n({notes:o,serves:parseInt(c)||0}),a(!1)},children:"Save"}),(0,Ng.jsx)("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>{l(t.notes||""),u(t.serves||0),a(!1)},children:"Cancel"})]})]})]}),(0,Ng.jsxs)("div",{className:"item-actions",children:[!s&&(0,Ng.jsx)("button",{type:"button",className:"action-btn",onClick:()=>a(!0),title:"Edit notes",children:"\u270f\ufe0f"}),(0,Ng.jsx)("button",{type:"button",className:"action-btn remove",onClick:r,title:"Remove item",children:"\u2715"})]})]})})}const Sw=["breakfast","brunch","lunch","dinner","ceremony"];function Cw(e){let{meal:t,onUpdate:n,onRemove:r,onAddRecipe:s,onRemoveRecipe:a}=e;const[o,l]=(0,i.useState)([...Sw]),[c,u]=(0,i.useState)(!1),[d,h]=(0,i.useState)(""),{attributes:f,listeners:p,setNodeRef:m,transform:g,transition:v,isDragging:y}=ww({id:t.id}),b={transform:ty.Transform.toString(g),transition:v,opacity:y?.5:1};(0,i.useEffect)(()=>{const e=Mp(Cf(wg,"meal_types"),e=>{const t=e.docs.map(e=>e.id);l([...Sw,...t,"Add New"])});return()=>e()},[]);const w=(e,t)=>{"type"===e&&"Add New"===t?u(!0):n({[e]:t})};return(0,Ng.jsxs)("div",{ref:m,style:b,className:"meal-card",children:[(0,Ng.jsxs)("div",{className:"meal-header",children:[(0,Ng.jsx)("div",{className:"drag-handle",...f,...p,children:"\u22ee\u22ee"}),c?(0,Ng.jsxs)("div",{className:"custom-type-input",children:[(0,Ng.jsx)("input",{type:"text",value:d,onChange:e=>h(e.target.value),placeholder:"Enter meal type",className:"meal-type-input",autoFocus:!0}),(0,Ng.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",onClick:async()=>{if(d.trim()){const t=d.trim().toLowerCase();try{await Dp(jf(wg,"meal_types",t),{name:d.trim(),created_at:new Date}),n({type:t}),h(""),u(!1)}catch(e){console.error("Error adding custom meal type:",e)}}},children:"Add"}),(0,Ng.jsx)("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>{u(!1),h("")},children:"Cancel"})]}):(0,Ng.jsx)("select",{value:t.type,onChange:e=>w("type",e.target.value),className:"meal-type-select",children:o.map(e=>(0,Ng.jsx)("option",{value:e,children:"Add New"===e?"+ Add New":e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,Ng.jsxs)("div",{className:"meal-actions",children:[(0,Ng.jsx)("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:s,children:"+ Add Recipe"}),(0,Ng.jsx)("button",{type:"button",className:"remove-meal-btn",onClick:r,title:"Remove meal",children:"\u2715"})]})]}),(0,Ng.jsxs)("div",{className:"meal-fields",children:[(0,Ng.jsxs)("div",{className:"field-group",children:[(0,Ng.jsx)("label",{children:"Description"}),(0,Ng.jsx)("textarea",{value:t.description||"",onChange:e=>w("description",e.target.value),placeholder:"Brief description of this meal...",rows:"2"})]}),(0,Ng.jsxs)("div",{className:"field-group",children:[(0,Ng.jsx)("label",{children:"Instructions"}),(0,Ng.jsx)("textarea",{value:t.instructions||"",onChange:e=>w("instructions",e.target.value),placeholder:"Special instructions for preparing or serving this meal...",rows:"3"})]}),(0,Ng.jsxs)("div",{className:"field-group",children:[(0,Ng.jsx)("label",{children:"Notes"}),(0,Ng.jsx)("textarea",{value:t.notes||"",onChange:e=>w("notes",e.target.value),placeholder:"Additional notes about dietary restrictions, timing, etc...",rows:"2"})]})]}),(0,Ng.jsxs)("div",{className:"meal-recipes",children:[(0,Ng.jsx)("h4",{children:"Recipes"}),t.recipes.length>0?(0,Ng.jsx)(fw,{items:t.recipes.map(e=>e.id),strategy:uw,children:t.recipes.map(e=>(0,Ng.jsx)(kw,{item:e,onUpdate:r=>((e,r)=>{const i=t.recipes.map(t=>t.id===e?{...t,...r}:t);n({recipes:i})})(e.id,r),onRemove:()=>a(e.id)},e.id))}):(0,Ng.jsxs)("div",{className:"empty-recipes",children:[(0,Ng.jsx)("p",{children:"No recipes in this meal"}),(0,Ng.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",onClick:s,children:"Add First Recipe"})]})]})]})}function jw(e){let{onSelect:t,onClose:n}=e;const{recipes:r}=jg(),[s,a]=(0,i.useState)(""),[o,l]=(0,i.useState)([]),c=(0,i.useMemo)(()=>{const e=new Set;return r.forEach(t=>{var n;null===(n=t.tags)||void 0===n||n.forEach(t=>e.add(t))}),Array.from(e).sort()},[r]),u=(0,i.useMemo)(()=>r.filter(e=>{if(s){var t,n;const r=s.toLowerCase(),i=null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(r),a=null===(n=e.ingredients)||void 0===n?void 0:n.some(e=>e.toLowerCase().includes(r));if(!i&&!a)return!1}var r;if(o.length>0&&(null===(r=e.tags)||void 0===r||!r.some(e=>o.includes(e))))return!1;return!0}),[r,s,o]);return(0,Ng.jsx)("div",{className:"recipe-picker-overlay",onClick:n,children:(0,Ng.jsxs)("div",{className:"recipe-picker-modal",onClick:e=>e.stopPropagation(),children:[(0,Ng.jsxs)("div",{className:"picker-header",children:[(0,Ng.jsx)("h2",{children:"Select Recipe"}),(0,Ng.jsx)("button",{className:"close-btn",onClick:n,children:"\u2715"})]}),(0,Ng.jsxs)("div",{className:"picker-filters",children:[(0,Ng.jsxs)("div",{className:"search-bar",children:[(0,Ng.jsx)("span",{className:"search-icon",children:"\ud83d\udd0d"}),(0,Ng.jsx)("input",{type:"text",placeholder:"Search recipes...",value:s,onChange:e=>a(e.target.value),className:"search-input",autoFocus:!0}),s&&(0,Ng.jsx)("button",{className:"clear-search",onClick:()=>a(""),children:"\u2715"})]}),c.length>0&&(0,Ng.jsxs)("div",{className:"tag-filters",children:[(0,Ng.jsx)("span",{className:"filter-label",children:"Filter by tags:"}),(0,Ng.jsx)("div",{className:"tag-pills",children:c.map(e=>(0,Ng.jsx)("button",{className:"tag-pill "+(o.includes(e)?"active":""),onClick:()=>(e=>{l(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e),children:e},e))})]})]}),(0,Ng.jsxs)("div",{className:"picker-results",children:[(0,Ng.jsxs)("div",{className:"results-header",children:[u.length," recipes found"]}),(0,Ng.jsx)("div",{className:"recipe-grid",children:u.map(e=>(0,Ng.jsxs)("div",{className:"recipe-option",onClick:()=>(e=>{t(e)})(e),children:[(0,Ng.jsx)("h4",{className:"recipe-name",children:e.name}),(0,Ng.jsxs)("div",{className:"recipe-meta",children:[(0,Ng.jsxs)("span",{className:"serves",children:["Serves ",e.serves||"?"]}),e.prep_time&&(0,Ng.jsxs)("span",{className:"time",children:["Prep: ",e.prep_time,"min"]}),e.cook_time&&(0,Ng.jsxs)("span",{className:"time",children:["Cook: ",e.cook_time,"min"]})]}),e.tags&&e.tags.length>0&&(0,Ng.jsxs)("div",{className:"recipe-tags",children:[e.tags.slice(0,3).map(e=>(0,Ng.jsx)("span",{className:"tag",children:e},e)),e.tags.length>3&&(0,Ng.jsxs)("span",{className:"tag",children:["+",e.tags.length-3]})]}),e.allergens&&e.allergens.length>0&&(0,Ng.jsx)("div",{className:"recipe-allergens",children:e.allergens.map(e=>(0,Ng.jsxs)("span",{className:"allergen",children:["\u26a0\ufe0f ",e]},e))})]},e.id))}),0===u.length&&(0,Ng.jsx)("div",{className:"empty-results",children:(0,Ng.jsx)("p",{children:"No recipes found matching your criteria."})})]}),(0,Ng.jsx)("div",{className:"picker-footer",children:(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:n,children:"Cancel"})})]})})}function Iw(){var e,t;const{id:n}=re(),r=ne(),s=ee(),{currentUser:a}=kg(),{recipes:o}=jg(),l=!n,c=null===(e=s.state)||void 0===e?void 0:e.template,u=null===(t=s.state)||void 0===t?void 0:t.eventId,[d,h]=(0,i.useState)({name:"",description:"",event_id:u||"",meals:[]}),[f,p]=(0,i.useState)([]),[m,g]=(0,i.useState)(null),[v,y]=(0,i.useState)(!l),[b,w]=(0,i.useState)(!1),[x,_]=(0,i.useState)(null),[N,E]=(0,i.useState)({}),[k,S]=(0,i.useState)(!1),[C,j]=(0,i.useState)(null),[I,T]=(0,i.useState)(null),[A,R]=(0,i.useState)(!1),[D,P]=(0,i.useState)([]),O=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,i.useMemo)(()=>[...t].filter(e=>null!=e),[...t])}(fy(ob),fy(nb,{coordinateGetter:Nw}));(0,i.useEffect)(()=>{L(),c?h({...c,event_id:"",sections:c.sections||[]}):l||M()},[n,l,c]);const L=()=>{const e=Mp(fp(Cf(wg,"events")),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));p(t)});return()=>e()},M=async()=>{try{y(!0);const e=await Tp(jf(wg,"menus",n));if(!e.exists())return void _("Menu not found");const t=e.data();h({name:t.name||"",description:t.description||"",event_id:t.event_id||"",meals:t.meals||t.sections||[]})}catch(e){console.error("Error loading menu:",e),_("Failed to load menu")}finally{y(!1)}},F=(e,t)=>{if(h(n=>({...n,[e]:t})),N[e]&&E(t=>{const n={...t};return delete n[e],n}),"event_id"===e&&t){const e=f.find(e=>e.id===t);g(e)}},U=()=>{const e={id:`meal-${Date.now()}`,type:"dinner",description:"",instructions:"",notes:"",recipes:[]};h(t=>({...t,meals:[...t.meals,e]}))},V=(e,t)=>{h(n=>({...n,meals:n.meals.map(n=>n.id===e?{...n,recipes:[...n.recipes,t]}:n)}))},B=e=>{for(const t of d.meals){const n=t.recipes.find(t=>t.id===e);if(n)return n}return null};return v?(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading menu..."})]}):x&&!l?(0,Ng.jsxs)("div",{className:"error-container",children:[(0,Ng.jsx)("h2",{children:"Error"}),(0,Ng.jsx)("p",{children:x}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>r("/menus"),children:"Back to Menus"})]}):(0,Ng.jsxs)("div",{className:"menu-editor",children:[(0,Ng.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return d.name.trim()||(e.name="Menu name is required"),0===d.meals.length&&(e.meals="Menu must have at least one meal"),E(e),0===Object.keys(e).length})()){w(!0),_(null);try{let e="";if(d.event_id){const t=f.find(e=>e.id===d.event_id);e=(null===t||void 0===t?void 0:t.name)||""}const t={...d,event_name:e,updated_at:Vp()};if(l){t.created_at=Vp(),t.created_by=a.email;const e=jf(Cf(wg,"menus")).id;await Dp(jf(wg,"menus",e),t),r(`/menus/${e}`)}else await Pp(jf(wg,"menus",n),t),r(`/menus/${n}`)}catch(t){console.error("Error saving menu:",t),_("Failed to save menu. Please try again.")}finally{w(!1)}}},children:[(0,Ng.jsxs)("div",{className:"editor-header",children:[(0,Ng.jsx)("h1",{children:l?"Create New Menu":"Edit Menu"}),(0,Ng.jsxs)("div",{className:"editor-actions",children:[(0,Ng.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{window.confirm("Are you sure you want to cancel? Any unsaved changes will be lost.")&&r(n?`/menus/${n}`:"/menus")},disabled:b,children:"Cancel"}),(0,Ng.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:b,children:b?"Saving...":"Save Menu"})]})]}),x&&(0,Ng.jsx)("div",{className:"error-message",children:x}),(0,Ng.jsxs)("div",{className:"editor-content",children:[(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Menu Information"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"name",children:"Menu Name *"}),(0,Ng.jsx)("input",{id:"name",type:"text",value:d.name,onChange:e=>F("name",e.target.value),placeholder:"Enter menu name",className:N.name?"error":""}),N.name&&(0,Ng.jsx)("span",{className:"field-error",children:N.name})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"event_id",children:"Associated Event"}),(0,Ng.jsxs)("select",{id:"event_id",value:d.event_id,onChange:e=>F("event_id",e.target.value),children:[(0,Ng.jsx)("option",{value:"",children:"No event"}),f.map(e=>{var t,n;return(0,Ng.jsxs)("option",{value:e.id,children:[e.name," - ",new Date((null===(t=e.event_date)||void 0===t||null===(n=t.toDate)||void 0===n?void 0:n.call(t))||e.event_date).toLocaleDateString()]},e.id)})]})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"description",children:"Description"}),(0,Ng.jsx)("textarea",{id:"description",value:d.description,onChange:e=>F("description",e.target.value),placeholder:"Brief description of the menu...",rows:"3"})]})]}),(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsxs)("div",{className:"section-header",children:[(0,Ng.jsx)("h2",{children:"Menu Meals"}),(0,Ng.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:U,children:"+ Add Meal"})]}),N.meals&&(0,Ng.jsx)("span",{className:"field-error",children:N.meals}),(0,Ng.jsxs)(Bb,{sensors:O,collisionDetection:_y,onDragStart:e=>{const{active:t}=e,n=B(t.id);T(n)},onDragEnd:e=>{const{active:t,over:n}=e;if(T(null),!n)return;const r=t.id,i=n.id;if(r===i)return;const s=d.meals.findIndex(e=>e.id===r),a=d.meals.findIndex(e=>e.id===i);-1!==s&&-1!==a&&h(e=>({...e,meals:sw(e.meals,s,a)}))},children:[(0,Ng.jsx)(fw,{items:d.meals.map(e=>e.id),strategy:uw,children:(0,Ng.jsx)("div",{className:"menu-meals",children:d.meals.map(e=>(0,Ng.jsx)(Cw,{meal:e,onUpdate:t=>((e,t)=>{h(n=>({...n,meals:n.meals.map(n=>n.id===e?{...n,...t}:n)}))})(e.id,t),onRemove:()=>{return t=e.id,void h(e=>({...e,meals:e.meals.filter(e=>e.id!==t)}));var t},onAddRecipe:()=>{return t=e.id,j(t),void S(!0);var t},onRemoveRecipe:t=>((e,t)=>{h(n=>({...n,meals:n.meals.map(n=>n.id===e?{...n,recipes:n.recipes.filter(e=>e.id!==t)}:n)}))})(e.id,t)},e.id))})}),(0,Ng.jsx)(iw,{children:I?(0,Ng.jsx)("div",{className:"drag-item",children:I.recipe_name}):null})]}),0===d.meals.length&&(0,Ng.jsxs)("div",{className:"empty-sections",children:[(0,Ng.jsx)("p",{children:"No meals yet. Add your first meal to start building the menu."}),(0,Ng.jsx)("button",{type:"button",className:"btn btn-primary",onClick:U,children:"Add First Meal"})]})]})]})]}),k&&(0,Ng.jsx)(jw,{onSelect:async e=>{if(C){var t,n;let r=e.serves;if(m){const e=(m.guest_count||0)+(m.staff_count||0);e>0&&(r=e)}const i={id:`recipe-${Date.now()}`,recipe_id:e.id,recipe_name:e.name,serves:r,original_serves:e.serves,notes:"",allergens:e.allergens||[]};if(m&&(null===(t=m.allergens)||void 0===t?void 0:t.length)>0&&(null===(n=e.allergens)||void 0===n?void 0:n.length)>0){const t=m.allergens.filter(t=>e.allergens.includes(t));if(t.length>0)return P(t.map(t=>({allergen:t,recipe:e.name}))),R(!0),h(e=>({...e,pendingRecipe:{mealId:C,recipe:i}})),S(!1),void j(null)}V(C,i)}S(!1),j(null)},onClose:()=>{S(!1),j(null)}}),A&&(0,Ng.jsx)("div",{className:"modal-overlay",onClick:()=>R(!1),children:(0,Ng.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,Ng.jsx)("h3",{children:"\u26a0\ufe0f Allergy Warning"}),(0,Ng.jsx)("p",{children:"The following allergens in this recipe match guest allergies:"}),(0,Ng.jsx)("ul",{className:"allergy-conflicts",children:D.map((e,t)=>(0,Ng.jsxs)("li",{children:[(0,Ng.jsx)("strong",{children:e.allergen})," in ",e.recipe]},t))}),(0,Ng.jsx)("p",{children:"Do you want to continue adding this recipe?"}),(0,Ng.jsxs)("div",{className:"modal-actions",children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{R(!1),P([]),h(e=>{const{pendingRecipe:t,...n}=e;return n})},children:"No, Cancel"}),(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:()=>{d.pendingRecipe&&V(d.pendingRecipe.mealId,d.pendingRecipe.recipe),R(!1),P([]),h(e=>{const{pendingRecipe:t,...n}=e;return n})},children:"Yes, Continue"})]})]})})]})}function Tw(e){let{eventId:t,recipes:n,menus:r,ingredients:s,onClose:a}=e;const[o,l]=(0,i.useState)(null),[c,u]=(0,i.useState)([]),[d,h]=(0,i.useState)({}),[f,p]=(0,i.useState)(!0),[m,g]=(0,i.useState)("category");(0,i.useEffect)(()=>{v()},[t]);const v=async()=>{try{p(!0);const e=await Tp(jf(wg,"events",t));if(e.exists()){const n={id:e.id,...e.data()};l(n);const i=r.filter(e=>e.event_id===t);u(i),y(n,i)}}catch(e){console.error("Error loading event data:",e)}finally{p(!1)}},y=(e,t)=>{const r={};t.forEach(t=>{var i;null===(i=t.sections)||void 0===i||i.forEach(t=>{var i;null===(i=t.items)||void 0===i||i.forEach(i=>{var s;const a=n.find(e=>e.id===i.recipe_id);if(!a)return;const o=a.serves||4,l=(e.guest_count||50)/o;null===(s=a.ingredients)||void 0===s||s.forEach(e=>{const n=b(e);if(!n)return;const i=n.name.toLowerCase();r[i]||(r[i]={name:n.name,quantity:0,unit:n.unit,recipes:[],category:w(n.name),supplier:x(n.name)}),r[i].quantity+=(n.quantity||1)*l,r[i].recipes.push({name:a.name,menuSection:t.name})})})})}),h(r)},b=e=>{const t=e.match(/^([\d.\/\s]+)?\s*([a-zA-Z]+)?\s+(.+)/);return t?{quantity:parseFloat(t[1])||1,unit:t[2]||"each",name:t[3]||e}:{name:e,quantity:1,unit:"each"}},w=e=>{const t=s.find(t=>t.name.toLowerCase()===e.toLowerCase());return(null===t||void 0===t?void 0:t.category)||"other"},x=e=>{const t=s.find(t=>t.name.toLowerCase()===e.toLowerCase());return(null===t||void 0===t?void 0:t.preferred_supplier)||"Unknown"},_=()=>{const e={};return Object.entries(d).forEach(t=>{var n;let[r,i]=t;const s="category"===m?i.category:"supplier"===m?i.supplier:(null===(n=i.recipes[0])||void 0===n?void 0:n.name)||"Unknown";e[s]||(e[s]=[]),e[s].push({key:r,...i})}),e};return f?(0,Ng.jsx)("div",{className:"shopping-list-overlay",onClick:a,children:(0,Ng.jsx)("div",{className:"shopping-list-modal",onClick:e=>e.stopPropagation(),children:(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Generating shopping list..."})]})})}):(0,Ng.jsx)("div",{className:"shopping-list-overlay",onClick:a,children:(0,Ng.jsxs)("div",{className:"shopping-list-modal",onClick:e=>e.stopPropagation(),children:[(0,Ng.jsxs)("div",{className:"modal-header",children:[(0,Ng.jsx)("h2",{children:"Shopping List"}),(0,Ng.jsx)("button",{className:"close-btn",onClick:a,children:"\u2715"})]}),(0,Ng.jsxs)("div",{className:"event-info",children:[(0,Ng.jsx)("h3",{children:null===o||void 0===o?void 0:o.name}),(0,Ng.jsxs)("p",{children:[(null===o||void 0===o?void 0:o.guest_count)||"?"," guests \u2022",c.length," menu",1!==c.length?"s":""," \u2022",Object.keys(d).length," ingredients"]})]}),(0,Ng.jsxs)("div",{className:"list-controls",children:[(0,Ng.jsxs)("div",{className:"group-by",children:[(0,Ng.jsx)("label",{children:"Group by:"}),(0,Ng.jsxs)("select",{value:m,onChange:e=>g(e.target.value),children:[(0,Ng.jsx)("option",{value:"category",children:"Category"}),(0,Ng.jsx)("option",{value:"supplier",children:"Supplier"}),(0,Ng.jsx)("option",{value:"recipe",children:"Recipe"})]})]}),(0,Ng.jsxs)("div",{className:"actions",children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{window.print()},children:"\ud83d\udda8\ufe0f Print"}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{const e=Object.entries(_()).map(e=>{let[t,n]=e;return`\n${t.toUpperCase()}\n`+n.map(e=>`- ${e.quantity.toFixed(2)} ${e.unit} ${e.name}`).join("\n")}).join("\n"),t=new Blob([e],{type:"text/plain"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=`shopping-list-${(null===o||void 0===o?void 0:o.name)||"event"}.txt`,r.click(),URL.revokeObjectURL(n)},children:"\ud83d\udce5 Export"})]})]}),(0,Ng.jsx)("div",{className:"shopping-list-content printable",children:0===Object.entries(_()).length?(0,Ng.jsx)("p",{className:"empty-message",children:"No ingredients found. Make sure menus have recipes assigned."}):Object.entries(_()).map(e=>{let[t,n]=e;return(0,Ng.jsxs)("div",{className:"ingredient-group",children:[(0,Ng.jsx)("h4",{className:"group-title",children:t}),(0,Ng.jsxs)("table",{className:"ingredient-table",children:[(0,Ng.jsx)("thead",{children:(0,Ng.jsxs)("tr",{children:[(0,Ng.jsx)("th",{children:"Quantity"}),(0,Ng.jsx)("th",{children:"Unit"}),(0,Ng.jsx)("th",{children:"Ingredient"}),(0,Ng.jsx)("th",{className:"no-print",children:"Used In"})]})}),(0,Ng.jsx)("tbody",{children:n.map(e=>(0,Ng.jsxs)("tr",{children:[(0,Ng.jsx)("td",{className:"quantity",children:e.quantity.toFixed(2)}),(0,Ng.jsx)("td",{className:"unit",children:e.unit}),(0,Ng.jsx)("td",{className:"name",children:e.name}),(0,Ng.jsxs)("td",{className:"recipes no-print",children:[e.recipes.slice(0,2).map((e,t)=>(0,Ng.jsx)("span",{className:"recipe-tag",children:e.name},t)),e.recipes.length>2&&(0,Ng.jsxs)("span",{className:"recipe-tag more",children:["+",e.recipes.length-2]})]})]},e.key))})]})]},t)})}),(0,Ng.jsx)("div",{className:"modal-footer",children:(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:a,children:"Close"})})]})})}function Aw(){const e=ne(),{hasRole:t}=kg(),{selectedEventId:n,recipes:r,menus:s}=jg(),[a,o]=(0,i.useState)([]),[l,c]=(0,i.useState)(!0),[u,d]=(0,i.useState)(""),[h,f]=(0,i.useState)("all"),[p,m]=(0,i.useState)(!1),[g,v]=(0,i.useState)(new Set);(0,i.useEffect)(()=>{const e=Mp(fp(Cf(wg,"ingredients"),yp("name")),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));o(t),c(!1)},e=>{console.error("Error fetching ingredients:",e),c(!1)});return()=>e()},[]);const y=a.filter(e=>{if(u){var t,n;const r=u.toLowerCase(),i=null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(r),s=null===(n=e.preferred_supplier)||void 0===n?void 0:n.toLowerCase().includes(r);if(!i&&!s)return!1}return"all"===h||e.category===h}),b=()=>{e("/ingredients/new")},w=e=>{switch(e){case"produce":return"\ud83e\udd6c";case"protein":return"\ud83e\udd69";case"dairy":return"\ud83e\udd5b";case"grains":return"\ud83c\udf3e";case"spices":return"\ud83e\uddc2";case"condiments":return"\ud83c\udf6f";case"baking":return"\ud83e\uddc1";case"beverages":return"\ud83e\udd64";default:return"\ud83d\udce6"}};return l?(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading ingredients..."})]}):(0,Ng.jsxs)("div",{className:"ingredient-list",children:[(0,Ng.jsxs)("div",{className:"ingredient-list-header",children:[(0,Ng.jsx)("h1",{children:"Ingredient Management"}),(0,Ng.jsxs)("div",{className:"header-actions",children:[n&&(0,Ng.jsxs)("button",{className:"btn btn-secondary",onClick:()=>{n?m(!0):alert("Please select an event first")},children:[(0,Ng.jsx)("span",{className:"btn-icon",children:"\ud83d\udccb"}),"Shopping List"]}),t("user")&&(0,Ng.jsxs)("button",{className:"btn btn-primary",onClick:b,children:[(0,Ng.jsx)("span",{className:"btn-icon",children:"\u2795"}),"Add Ingredient"]})]})]}),(0,Ng.jsxs)("div",{className:"ingredient-filters",children:[(0,Ng.jsxs)("div",{className:"search-bar",children:[(0,Ng.jsx)("span",{className:"search-icon",children:"\ud83d\udd0d"}),(0,Ng.jsx)("input",{type:"text",placeholder:"Search ingredients or suppliers...",value:u,onChange:e=>d(e.target.value),className:"search-input"}),u&&(0,Ng.jsx)("button",{className:"clear-search",onClick:()=>d(""),children:"\u2715"})]}),(0,Ng.jsx)("div",{className:"category-filters",children:["all","produce","protein","dairy","grains","spices","condiments","baking","beverages","other"].map(e=>(0,Ng.jsx)("button",{className:"category-btn "+(h===e?"active":""),onClick:()=>f(e),children:"all"===e?"All":(0,Ng.jsxs)(Ng.Fragment,{children:[(0,Ng.jsx)("span",{className:"category-icon",children:w(e)}),e.charAt(0).toUpperCase()+e.slice(1)]})},e))})]}),(0,Ng.jsxs)("div",{className:"results-summary",children:["Showing ",y.length," of ",a.length," ingredients"]}),(0,Ng.jsxs)("div",{className:"ingredients-table-container",children:[(0,Ng.jsxs)("table",{className:"ingredients-table",children:[(0,Ng.jsx)("thead",{children:(0,Ng.jsxs)("tr",{children:[t("user")&&(0,Ng.jsx)("th",{className:"checkbox-col"}),(0,Ng.jsx)("th",{children:"Name"}),(0,Ng.jsx)("th",{children:"Category"}),(0,Ng.jsx)("th",{children:"Unit"}),(0,Ng.jsx)("th",{children:"Cost"}),(0,Ng.jsx)("th",{children:"Supplier"}),(0,Ng.jsx)("th",{children:"Stock Status"}),(0,Ng.jsx)("th",{className:"actions-col",children:"Actions"})]})}),(0,Ng.jsx)("tbody",{children:y.map(n=>(0,Ng.jsxs)("tr",{children:[t("user")&&(0,Ng.jsx)("td",{children:(0,Ng.jsx)("input",{type:"checkbox",checked:g.has(n.id),onChange:()=>{return e=n.id,void v(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n});var e}})}),(0,Ng.jsxs)("td",{className:"name-cell",children:[(0,Ng.jsx)("span",{className:"category-icon",children:w(n.category)}),n.name]}),(0,Ng.jsx)("td",{children:n.category||"Other"}),(0,Ng.jsx)("td",{children:n.unit||"-"}),(0,Ng.jsx)("td",{children:n.cost_per_unit?`$${n.cost_per_unit.toFixed(2)}`:"-"}),(0,Ng.jsx)("td",{children:n.preferred_supplier||"-"}),(0,Ng.jsx)("td",{children:(0,Ng.jsx)("span",{className:"stock-status "+(n.in_stock?"in-stock":"out-of-stock"),children:n.in_stock?"In Stock":"Out of Stock"})}),(0,Ng.jsxs)("td",{className:"actions-cell",children:[(0,Ng.jsx)("button",{className:"action-btn view",onClick:()=>{return t=n.id,void e(`/ingredients/${t}`);var t},title:"View details",children:"\ud83d\udc41\ufe0f"}),t("user")&&(0,Ng.jsx)("button",{className:"action-btn edit",onClick:()=>e(`/ingredients/${n.id}/edit`),title:"Edit",children:"\u270f\ufe0f"})]})]},n.id))})]}),0===y.length&&(0,Ng.jsxs)("div",{className:"empty-state",children:[(0,Ng.jsx)("p",{children:"No ingredients found."}),t("user")&&(0,Ng.jsx)("button",{className:"btn btn-primary",onClick:b,children:"Add First Ingredient"})]})]}),p&&(0,Ng.jsx)(Tw,{eventId:n,recipes:r,menus:s,ingredients:a,onClose:()=>m(!1)})]})}function Rw(){const{id:e}=re(),t=ne(),{hasRole:n}=kg(),[r,s]=(0,i.useState)(null),[a,o]=(0,i.useState)(!0),[l,c]=(0,i.useState)(null),[u,d]=(0,i.useState)(!1);(0,i.useEffect)(()=>{h()},[e]);const h=async()=>{try{o(!0);const t=await Tp(jf(wg,"ingredients",e));if(!t.exists())return void c("Ingredient not found");s({id:t.id,...t.data()})}catch(t){console.error("Error loading ingredient:",t),c("Failed to load ingredient")}finally{o(!1)}},f=e=>{var t;if(!e)return"No date";return((null===(t=e.toDate)||void 0===t?void 0:t.call(e))||new Date(e)).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})};return a?(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading ingredient..."})]}):l?(0,Ng.jsxs)("div",{className:"error-container",children:[(0,Ng.jsx)("h2",{children:"Error"}),(0,Ng.jsx)("p",{children:l}),(0,Ng.jsx)(Te,{to:"/ingredients",className:"btn btn-secondary",children:"Back to Ingredients"})]}):r?(0,Ng.jsxs)("div",{className:"ingredient-viewer",children:[(0,Ng.jsx)("div",{className:"ingredient-header",children:(0,Ng.jsxs)("div",{className:"ingredient-header-content",children:[(0,Ng.jsx)(Te,{to:"/ingredients",className:"back-link",children:"\u2190 Back to Ingredients"}),(0,Ng.jsxs)("div",{className:"ingredient-title",children:[(0,Ng.jsx)("span",{className:"category-icon",children:(e=>{switch(e){case"produce":return"\ud83e\udd6c";case"protein":return"\ud83e\udd69";case"dairy":return"\ud83e\udd5b";case"grains":return"\ud83c\udf3e";case"spices":return"\ud83e\uddc2";case"condiments":return"\ud83c\udf6f";case"baking":return"\ud83e\uddc1";case"beverages":return"\ud83e\udd64";default:return"\ud83d\udce6"}})(r.category)}),(0,Ng.jsx)("h1",{children:r.name||"Unnamed Ingredient"})]}),(0,Ng.jsx)("div",{className:"ingredient-actions",children:n("user")&&(0,Ng.jsxs)(Ng.Fragment,{children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{t(`/ingredients/${e}/edit`)},children:"\u270f\ufe0f Edit"}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>{t("/ingredients/new",{state:{duplicateFrom:{...r,name:`${r.name} (Copy)`,id:void 0,created_at:void 0,created_by:void 0}}})},children:"\ud83d\udccb Duplicate"}),(0,Ng.jsx)("button",{className:"btn btn-danger",onClick:()=>d(!0),children:"\ud83d\uddd1\ufe0f Delete"})]})})]})}),u&&(0,Ng.jsx)("div",{className:"modal-overlay",onClick:()=>d(!1),children:(0,Ng.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,Ng.jsx)("h3",{children:"Delete Ingredient?"}),(0,Ng.jsxs)("p",{children:['Are you sure you want to delete "',r.name,'"? This action cannot be undone.']}),(0,Ng.jsxs)("div",{className:"modal-actions",children:[(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>d(!1),children:"Cancel"}),(0,Ng.jsx)("button",{className:"btn btn-danger",onClick:async()=>{try{await Op(jf(wg,"ingredients",e)),t("/ingredients")}catch(n){console.error("Error deleting ingredient:",n),alert("Failed to delete ingredient")}},children:"Delete Ingredient"})]})]})}),(0,Ng.jsxs)("div",{className:"ingredient-content",children:[(0,Ng.jsxs)("div",{className:"content-grid",children:[(0,Ng.jsxs)("div",{className:"info-card",children:[(0,Ng.jsx)("h2",{children:"Basic Information"}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Category:"}),(0,Ng.jsx)("span",{className:"info-value",children:r.category?r.category.charAt(0).toUpperCase()+r.category.slice(1):"Other"})]}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Unit:"}),(0,Ng.jsx)("span",{className:"info-value",children:r.unit||"-"})]}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Cost per Unit:"}),(0,Ng.jsx)("span",{className:"info-value",children:(p=r.cost_per_unit,p||0===p?`$${p.toFixed(2)}`:"-")})]})]}),(0,Ng.jsxs)("div",{className:"info-card",children:[(0,Ng.jsx)("h2",{children:"Supplier Information"}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Preferred Supplier:"}),(0,Ng.jsx)("span",{className:"info-value",children:r.preferred_supplier||"-"})]}),r.supplier_contact&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Contact:"}),(0,Ng.jsx)("span",{className:"info-value",children:r.supplier_contact})]}),r.supplier_email&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Email:"}),(0,Ng.jsx)("span",{className:"info-value",children:(0,Ng.jsx)("a",{href:`mailto:${r.supplier_email}`,children:r.supplier_email})})]}),r.supplier_phone&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Phone:"}),(0,Ng.jsx)("span",{className:"info-value",children:(0,Ng.jsx)("a",{href:`tel:${r.supplier_phone}`,children:r.supplier_phone})})]}),r.min_order_quantity&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Min Order:"}),(0,Ng.jsxs)("span",{className:"info-value",children:[r.min_order_quantity," ",r.unit]})]}),r.lead_time_days&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Lead Time:"}),(0,Ng.jsxs)("span",{className:"info-value",children:[r.lead_time_days," days"]})]})]}),(0,Ng.jsxs)("div",{className:"info-card",children:[(0,Ng.jsx)("h2",{children:"Inventory Status"}),(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Status:"}),(0,Ng.jsx)("span",{className:"stock-status "+(r.in_stock?"in-stock":"out-of-stock"),children:r.in_stock?"In Stock":"Out of Stock"})]}),void 0!==r.stock_quantity&&null!==r.stock_quantity&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Current Stock:"}),(0,Ng.jsxs)("span",{className:"info-value",children:[r.stock_quantity," ",r.unit]})]}),void 0!==r.reorder_point&&null!==r.reorder_point&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Reorder Point:"}),(0,Ng.jsxs)("span",{className:"info-value",children:[r.reorder_point," ",r.unit]})]}),r.storage_location&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Storage Location:"}),(0,Ng.jsx)("span",{className:"info-value",children:r.storage_location})]})]}),(0,Ng.jsxs)("div",{className:"info-card",children:[(0,Ng.jsx)("h2",{children:"Metadata"}),r.created_by&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Created by:"}),(0,Ng.jsx)("span",{className:"info-value",children:r.created_by})]}),r.created_at&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Created:"}),(0,Ng.jsx)("span",{className:"info-value",children:f(r.created_at)})]}),r.updated_at&&(0,Ng.jsxs)("div",{className:"info-row",children:[(0,Ng.jsx)("span",{className:"info-label",children:"Last Updated:"}),(0,Ng.jsx)("span",{className:"info-value",children:f(r.updated_at)})]})]})]}),r.notes&&(0,Ng.jsxs)("div",{className:"notes-section",children:[(0,Ng.jsx)("h2",{children:"Notes"}),(0,Ng.jsx)("p",{children:r.notes})]}),(0,Ng.jsxs)("div",{className:"usage-section",children:[(0,Ng.jsx)("h2",{children:"Recipes Using This Ingredient"}),(0,Ng.jsx)("p",{className:"coming-soon",children:"Recipe usage tracking coming soon!"})]})]})]}):null;var p}const Dw=["produce","protein","dairy","grains","spices","condiments","baking","beverages","other"],Pw=["each","dozen","pound","ounce","gram","kilogram","liter","milliliter","cup","tablespoon","teaspoon","bunch","box","can","jar","package","bottle"];function Ow(){const{id:e}=re(),t=ne(),{currentUser:n}=kg(),r=!e,[s,a]=(0,i.useState)({name:"",category:"other",unit:"each",cost_per_unit:"",preferred_supplier:"",supplier_contact:"",supplier_email:"",supplier_phone:"",min_order_quantity:"",lead_time_days:"",in_stock:!0,stock_quantity:"",reorder_point:"",storage_location:"",notes:"",allergens:[]}),[o,l]=(0,i.useState)(!r),[c,u]=(0,i.useState)(!1),[d,h]=(0,i.useState)(null),[f,p]=(0,i.useState)({});(0,i.useEffect)(()=>{r||m()},[e,r]);const m=async()=>{try{l(!0);const t=await Tp(jf(wg,"ingredients",e));if(!t.exists())return void h("Ingredient not found");const n=t.data();a({name:n.name||"",category:n.category||"other",unit:n.unit||"each",cost_per_unit:n.cost_per_unit||"",preferred_supplier:n.preferred_supplier||"",supplier_contact:n.supplier_contact||"",supplier_email:n.supplier_email||"",supplier_phone:n.supplier_phone||"",min_order_quantity:n.min_order_quantity||"",lead_time_days:n.lead_time_days||"",in_stock:!1!==n.in_stock,stock_quantity:n.stock_quantity||"",reorder_point:n.reorder_point||"",storage_location:n.storage_location||"",notes:n.notes||"",allergens:n.allergens||[]})}catch(t){console.error("Error loading ingredient:",t),h("Failed to load ingredient")}finally{l(!1)}},g=(e,t)=>{a(n=>({...n,[e]:t})),f[e]&&p(t=>{const n={...t};return delete n[e],n})},v=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);return o?(0,Ng.jsxs)("div",{className:"loading-container",children:[(0,Ng.jsx)("div",{className:"spinner"}),(0,Ng.jsx)("p",{children:"Loading ingredient..."})]}):d&&!r?(0,Ng.jsxs)("div",{className:"error-container",children:[(0,Ng.jsx)("h2",{children:"Error"}),(0,Ng.jsx)("p",{children:d}),(0,Ng.jsx)("button",{className:"btn btn-secondary",onClick:()=>t("/ingredients"),children:"Back to Ingredients"})]}):(0,Ng.jsx)("div",{className:"ingredient-editor",children:(0,Ng.jsxs)("form",{onSubmit:async i=>{if(i.preventDefault(),(()=>{const e={};return s.name.trim()||(e.name="Ingredient name is required"),s.cost_per_unit&&isNaN(parseFloat(s.cost_per_unit))&&(e.cost_per_unit="Cost must be a valid number"),s.supplier_email&&!v(s.supplier_email)&&(e.supplier_email="Invalid email address"),p(e),0===Object.keys(e).length})()){u(!0),h(null);try{const i={...s,cost_per_unit:s.cost_per_unit?parseFloat(s.cost_per_unit):null,min_order_quantity:s.min_order_quantity?parseInt(s.min_order_quantity):null,lead_time_days:s.lead_time_days?parseInt(s.lead_time_days):null,stock_quantity:s.stock_quantity?parseFloat(s.stock_quantity):null,reorder_point:s.reorder_point?parseFloat(s.reorder_point):null,updated_at:Vp()};if(r){i.created_at=Vp(),i.created_by=n.email;const e=jf(wg,"ingredients").id;await Dp(jf(wg,"ingredients",e),i),t(`/ingredients/${e}`)}else await Pp(jf(wg,"ingredients",e),i),t(`/ingredients/${e}`)}catch(a){console.error("Error saving ingredient:",a),h("Failed to save ingredient. Please try again.")}finally{u(!1)}}},children:[(0,Ng.jsxs)("div",{className:"editor-header",children:[(0,Ng.jsx)("h1",{children:r?"Add New Ingredient":"Edit Ingredient"}),(0,Ng.jsxs)("div",{className:"editor-actions",children:[(0,Ng.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{window.confirm("Are you sure you want to cancel? Any unsaved changes will be lost.")&&t(e?`/ingredients/${e}`:"/ingredients")},disabled:c,children:"Cancel"}),(0,Ng.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:c,children:c?"Saving...":"Save Ingredient"})]})]}),d&&(0,Ng.jsx)("div",{className:"error-message",children:d}),(0,Ng.jsxs)("div",{className:"editor-content",children:[(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Basic Information"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"name",children:"Ingredient Name *"}),(0,Ng.jsx)("input",{id:"name",type:"text",value:s.name,onChange:e=>g("name",e.target.value),placeholder:"Enter ingredient name",className:f.name?"error":""}),f.name&&(0,Ng.jsx)("span",{className:"field-error",children:f.name})]}),(0,Ng.jsxs)("div",{className:"form-row",children:[(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"category",children:"Category"}),(0,Ng.jsxs)("div",{className:"select-with-icon",children:[(0,Ng.jsx)("span",{className:"select-icon",children:(e=>{switch(e){case"produce":return"\ud83e\udd6c";case"protein":return"\ud83e\udd69";case"dairy":return"\ud83e\udd5b";case"grains":return"\ud83c\udf3e";case"spices":return"\ud83e\uddc2";case"condiments":return"\ud83c\udf6f";case"baking":return"\ud83e\uddc1";case"beverages":return"\ud83e\udd64";default:return"\ud83d\udce6"}})(s.category)}),(0,Ng.jsx)("select",{id:"category",value:s.category,onChange:e=>g("category",e.target.value),children:Dw.map(e=>(0,Ng.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"unit",children:"Unit of Measure"}),(0,Ng.jsx)("select",{id:"unit",value:s.unit,onChange:e=>g("unit",e.target.value),children:Pw.map(e=>(0,Ng.jsx)("option",{value:e,children:e},e))})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"cost_per_unit",children:"Cost per Unit ($)"}),(0,Ng.jsx)("input",{id:"cost_per_unit",type:"number",value:s.cost_per_unit,onChange:e=>g("cost_per_unit",e.target.value),min:"0",step:"0.01",placeholder:"0.00",className:f.cost_per_unit?"error":""}),f.cost_per_unit&&(0,Ng.jsx)("span",{className:"field-error",children:f.cost_per_unit})]})]})]}),(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Supplier Information"}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"preferred_supplier",children:"Preferred Supplier"}),(0,Ng.jsx)("input",{id:"preferred_supplier",type:"text",value:s.preferred_supplier,onChange:e=>g("preferred_supplier",e.target.value),placeholder:"Supplier name"})]}),(0,Ng.jsxs)("div",{className:"form-row",children:[(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"supplier_contact",children:"Contact Name"}),(0,Ng.jsx)("input",{id:"supplier_contact",type:"text",value:s.supplier_contact,onChange:e=>g("supplier_contact",e.target.value),placeholder:"Contact person"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"supplier_email",children:"Email"}),(0,Ng.jsx)("input",{id:"supplier_email",type:"email",value:s.supplier_email,onChange:e=>g("supplier_email",e.target.value),placeholder:"supplier@example.com",className:f.supplier_email?"error":""}),f.supplier_email&&(0,Ng.jsx)("span",{className:"field-error",children:f.supplier_email})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"supplier_phone",children:"Phone"}),(0,Ng.jsx)("input",{id:"supplier_phone",type:"tel",value:s.supplier_phone,onChange:e=>g("supplier_phone",e.target.value),placeholder:"(555) 123-4567"})]})]}),(0,Ng.jsxs)("div",{className:"form-row",children:[(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"min_order_quantity",children:"Min Order Quantity"}),(0,Ng.jsx)("input",{id:"min_order_quantity",type:"number",value:s.min_order_quantity,onChange:e=>g("min_order_quantity",e.target.value),min:"0",placeholder:"0"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"lead_time_days",children:"Lead Time (days)"}),(0,Ng.jsx)("input",{id:"lead_time_days",type:"number",value:s.lead_time_days,onChange:e=>g("lead_time_days",e.target.value),min:"0",placeholder:"0"})]})]})]}),(0,Ng.jsxs)("section",{className:"editor-section",children:[(0,Ng.jsx)("h2",{children:"Inventory Information"}),(0,Ng.jsx)("div",{className:"form-group",children:(0,Ng.jsxs)("label",{className:"checkbox-label",children:[(0,Ng.jsx)("input",{type:"checkbox",checked:s.in_stock,onChange:e=>g("in_stock",e.target.checked)}),(0,Ng.jsx)("span",{children:"Currently in stock"})]})}),(0,Ng.jsxs)("div",{className:"form-row",children:[(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"stock_quantity",children:"Current Stock"}),(0,Ng.jsx)("input",{id:"stock_quantity",type:"number",value:s.stock_quantity,onChange:e=>g("stock_quantity",e.target.value),min:"0",step:"0.01",placeholder:"0"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"reorder_point",children:"Reorder Point"}),(0,Ng.jsx)("input",{id:"reorder_point",type:"number",value:s.reorder_point,onChange:e=>g("reorder_point",e.target.value),min:"0",step:"0.01",placeholder:"0"})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"storage_location",children:"Storage Location"}),(0,Ng.jsx)("input",{id:"storage_location",type:"text",value:s.storage_location,onChange:e=>g("storage_location",e.target.value),placeholder:"e.g., Walk-in cooler, Pantry shelf A3"})]})]}),(0,Ng.jsxs)("div",{className:"form-group",children:[(0,Ng.jsx)("label",{htmlFor:"notes",children:"Notes"}),(0,Ng.jsx)("textarea",{id:"notes",value:s.notes,onChange:e=>g("notes",e.target.value),placeholder:"Additional notes about this ingredient...",rows:"3"})]})]})]})]})})}function Lw(e){let{message:t,isUser:n}=e;return(0,Ng.jsxs)("div",{className:"chat-message "+(n?"user":"assistant"),children:[(0,Ng.jsx)("div",{className:"message-avatar",children:n?"\ud83d\udc64":"\ud83e\udd16"}),(0,Ng.jsxs)("div",{className:"message-content",children:[(0,Ng.jsxs)("div",{className:"message-header",children:[(0,Ng.jsx)("span",{className:"message-sender",children:n?"You":"AI Assistant"}),(0,Ng.jsx)("span",{className:"message-time",children:(e=>{if(!e)return"";const t=e.toDate?e.toDate():new Date(e),n=new Date,r=n-t;if(r<6e4)return"Just now";if(r<36e5){const e=Math.floor(r/6e4);return`${e} minute${e>1?"s":""} ago`}return t.toDateString()===n.toDateString()?t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):t.getFullYear()===n.getFullYear()?t.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})(t.timestamp)})]}),(0,Ng.jsx)("div",{className:"message-body",children:(r=t.content,r.split("\n\n").map((e,t)=>{if(e.includes("\n\u2022")||e.includes("\n-")){const n=e.split("\n"),r=n[0],i=n.slice(1);return(0,Ng.jsxs)("div",{children:[r&&(0,Ng.jsx)("p",{children:r}),(0,Ng.jsx)("ul",{children:i.map((e,t)=>(0,Ng.jsx)("li",{children:e.replace(/^[\u2022\-]\s*/,"")},t))})]},t)}if(e.match(/\n\d+\./)){const n=e.split("\n"),r=n[0],i=n.slice(1);return(0,Ng.jsxs)("div",{children:[r&&(0,Ng.jsx)("p",{children:r}),(0,Ng.jsx)("ol",{children:i.map((e,t)=>(0,Ng.jsx)("li",{children:e.replace(/^\d+\.\s*/,"")},t))})]},t)}return(0,Ng.jsx)("p",{children:e},t)}))})]})]});var r}function Mw(e){let{onSendMessage:t,disabled:n,placeholder:r}=e;const[s,a]=(0,i.useState)(""),[o,l]=(0,i.useState)(!1),c=(0,i.useRef)(null);(0,i.useEffect)(()=>{u()},[s]);const u=()=>{const e=c.current;if(!e)return;e.style.height="auto";const t=Math.min(e.scrollHeight,200);e.style.height=`${t}px`,l(t>60)},d=e=>{e.preventDefault(),s.trim()&&!n&&(t(s),a(""),l(!1),c.current&&(c.current.style.height="auto"))};return(0,Ng.jsxs)("div",{className:"chat-input-container "+(o?"expanded":""),children:[(0,Ng.jsx)("div",{className:"quick-actions",children:[{icon:"\ud83d\udccb",label:"Suggest menu",action:"Can you suggest a menu for my event?"},{icon:"\ud83e\udd57",label:"Find recipes",action:"Show me some vegetarian recipe options"},{icon:"\ud83d\udcca",label:"Scale recipe",action:"Help me scale a recipe for more guests"},{icon:"\ud83d\uded2",label:"Shopping list",action:"Create a shopping list for my menu"}].map((e,t)=>(0,Ng.jsxs)("button",{className:"quick-action-btn",onClick:()=>(e=>{var t;a(e),null===(t=c.current)||void 0===t||t.focus()})(e.action),disabled:n,title:e.label,children:[(0,Ng.jsx)("span",{className:"action-icon",children:e.icon}),(0,Ng.jsx)("span",{className:"action-label",children:e.label})]},t))}),(0,Ng.jsxs)("form",{onSubmit:d,className:"chat-input-form",children:[(0,Ng.jsxs)("div",{className:"input-wrapper",children:[(0,Ng.jsx)("textarea",{ref:c,value:s,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),d(e))},placeholder:r,disabled:n,className:"message-input",rows:1}),(0,Ng.jsxs)("div",{className:"input-actions",children:[s.length>0&&(0,Ng.jsx)("span",{className:"char-count",children:s.length}),(0,Ng.jsx)("button",{type:"submit",disabled:!s.trim()||n,className:"send-btn",title:"Send message (Enter)",children:(0,Ng.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,Ng.jsx)("path",{d:"M22 2L11 13",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Ng.jsx)("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})]}),(0,Ng.jsxs)("div",{className:"input-hint",children:["Press ",(0,Ng.jsx)("kbd",{children:"Enter"})," to send, ",(0,Ng.jsx)("kbd",{children:"Shift + Enter"})," for new line"]})]})]})}function Fw(e){let{onSelectPrompt:t}=e;return(0,Ng.jsxs)("div",{className:"suggested-prompts",children:[(0,Ng.jsx)("h3",{children:"Try asking about:"}),(0,Ng.jsx)("div",{className:"prompt-categories",children:[{category:"Menu Planning",icon:"\ud83d\udccb",suggestions:["Suggest a menu for a summer wedding with 100 guests","What appetizers pair well with Italian main courses?","Create a vegetarian menu that will impress meat-eaters","Help me plan a cocktail party menu for 50 people"]},{category:"Recipe Help",icon:"\ud83d\udc68\u200d\ud83c\udf73",suggestions:["How do I scale this recipe from 4 to 40 servings?","What can I substitute for eggs in baking recipes?","Give me ideas for gluten-free desserts","Convert this recipe to be dairy-free"]},{category:"Event Planning",icon:"\ud83d\udcc5",suggestions:["Create a timeline for prepping a 3-course dinner","How much food do I need for 75 guests?","What should I consider for outdoor event catering?","Help me plan around common food allergies"]},{category:"Shopping & Prep",icon:"\ud83d\uded2",suggestions:["Generate a shopping list for my event menu","What ingredients can I prep ahead of time?","How should I organize my shopping by supplier?","Calculate ingredient costs for my menu"]}].map((e,n)=>(0,Ng.jsxs)("div",{className:"prompt-category",children:[(0,Ng.jsxs)("div",{className:"category-header",children:[(0,Ng.jsx)("span",{className:"category-icon",children:e.icon}),(0,Ng.jsx)("h4",{children:e.category})]}),(0,Ng.jsx)("div",{className:"prompt-list",children:e.suggestions.map((e,n)=>(0,Ng.jsx)("button",{className:"prompt-button",onClick:()=>t(e),children:e},n))})]},n))}),(0,Ng.jsx)("div",{className:"prompts-footer",children:(0,Ng.jsx)("p",{children:"\ud83d\udca1 Tip: I work best when you provide specific details about your event!"})})]})}function Uw(){var e;const{currentUser:t}=kg(),{selectedEventId:n,events:r,recipes:s,menus:a}=jg(),[o,l]=(0,i.useState)([]),[c,u]=(0,i.useState)(!1),[d,h]=(0,i.useState)(!1),f=(0,i.useRef)(null),[p,m]=(0,i.useState)(null);(0,i.useEffect)(()=>{g()},[t]),(0,i.useEffect)(()=>{if(!p)return;var e;const t=Mp(fp(Cf(wg,"conversations",p,"messages"),yp("timestamp","asc"),(xf("limit",e=100),bp._create("limit",e,"F"))),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));l(t),N()});return()=>t()},[p]);const g=async()=>{try{const e={userId:t.uid,createdAt:Vp(),lastMessageAt:Vp(),context:{eventId:n,eventCount:r.length,recipeCount:s.length,menuCount:a.length}},i=await Lp(Cf(wg,"conversations"),e);m(i.id),await y("assistant",v(),i.id)}catch(e){console.error("Error initializing conversation:",e)}},v=()=>{const e=r.find(e=>e.id===n);return e?`Hello! I'm your AI assistant for Mountain Medicine Catering. I see you're currently planning for "${e.name}". How can I help you with this event today?`:"Hello! I'm your AI assistant for Mountain Medicine Catering. I can help you with:\n\u2022 Recipe suggestions and modifications\n\u2022 Menu planning and pairing ideas\n\u2022 Dietary restrictions and allergen management\n\u2022 Event planning tips\n\u2022 Ingredient substitutions\n\u2022 Scaling recipes for different guest counts\n\nWhat would you like to know?"},y=async function(e,t){const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)||p;if(n)try{await Lp(Cf(wg,"conversations",n,"messages"),{role:e,content:t,timestamp:Vp()}),await Pp(jf(wg,"conversations",n),{lastMessageAt:Vp()})}catch(r){console.error("Error adding message:",r)}},b=async e=>{if(e.trim()&&!d){h(!0);try{await y("user",e);const t=await w(e);await y("assistant",t)}catch(t){console.error("Error sending message:",t),await y("assistant","I apologize, but I encountered an error. Please try again.")}finally{h(!1)}}},w=async e=>{const t=x();try{const n=vg(_g,"chatAssistant");return(await n({message:e,conversationId:p,eventContext:t})).data.response}catch(n){return console.error("AI response error:",n),_(e,t)}},x=()=>{var e;const t=r.find(e=>e.id===n);return{selectedEvent:t,eventMenus:a.filter(e=>e.event_id===n),totalRecipes:s.length,recentRecipes:s.slice(0,5).map(e=>e.name),hasAllergyData:(null===t||void 0===t||null===(e=t.allergens)||void 0===e?void 0:e.length)>0}},_=(e,t)=>{const n=e.toLowerCase();if(t.selectedEvent){if(n.includes("menu")||n.includes("suggest")){const e=t.eventMenus.length;return 0===e?`I notice you haven't created any menus yet for ${t.selectedEvent.name}. Would you like me to suggest a menu based on the event type and guest count of ${t.selectedEvent.guest_count||"unknown"} guests?\n\nSome popular menu combinations include:\n\u2022 Appetizers: 3-4 options\n\u2022 Main courses: 2-3 options (including vegetarian)\n\u2022 Sides: 2-3 options\n\u2022 Desserts: 2 options\n\nWhat type of cuisine or style are you considering?`:`You have ${e} menu${e>1?"s":""} created for ${t.selectedEvent.name}. Would you like me to:\n\u2022 Review your current menu selections\n\u2022 Suggest complementary dishes\n\u2022 Help with portion planning for ${t.selectedEvent.guest_count||"your"} guests\n\u2022 Create a shopping list\n\nWhat would be most helpful?`}if(n.includes("allergen")||n.includes("allergy")){if(t.hasAllergyData){const e=t.selectedEvent.allergens.join(", ");return`For ${t.selectedEvent.name}, you have the following allergens to consider: ${e}.\n\nI can help you:\n\u2022 Find recipes that avoid these allergens\n\u2022 Suggest substitutions for existing recipes\n\u2022 Create allergen-free versions of popular dishes\n\u2022 Generate allergy warnings for your menus\n\nWhat specific allergen concerns would you like to address?`}return`I don't see any allergen information recorded for ${t.selectedEvent.name} yet. \n\nWould you like to:\n\u2022 Add guest allergy information\n\u2022 Get suggestions for common allergen-free options\n\u2022 Learn about allergen labeling best practices\n\nRecording allergies helps ensure guest safety and satisfaction.`}}return n.includes("recipe")?n.includes("scale")||n.includes("portion")?"I can help you scale recipes for different guest counts. To scale a recipe effectively:\n\n1. **Identify the original serving size** - Check the recipe's current yield\n2. **Calculate the scaling factor** - Divide desired servings by original servings\n3. **Adjust ingredients proportionally** - Multiply each ingredient by the factor\n4. **Consider cooking adjustments**:\n   \u2022 Cooking times may need adjustment for larger batches\n   \u2022 Seasoning often doesn't scale linearly (taste as you go)\n   \u2022 Baking recipes may need to be made in multiple batches\n\nWhich recipe would you like to scale, and for how many guests?":`You currently have ${t.totalRecipes} recipes in your collection. Some recent additions include: ${t.recentRecipes.join(", ")}.\n\nI can help you:\n\u2022 Find recipes by ingredient or cuisine type\n\u2022 Suggest recipe modifications\n\u2022 Create shopping lists from recipes\n\u2022 Import new recipes from URLs or text\n\nWhat would you like to do with recipes?`:`I understand you're asking about "${e}". \n\nAs your catering assistant, I can help with:\n\u2022 Menu planning and recipe suggestions\n\u2022 Dietary restrictions and substitutions  \n\u2022 Event timeline planning\n\u2022 Portion calculations\n\u2022 Shopping list generation\n\u2022 Recipe scaling\n\nCould you provide more details about what you're looking for?`},N=()=>{var e;null===(e=f.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};return(0,Ng.jsxs)("div",{className:"ai-chat",children:[(0,Ng.jsxs)("div",{className:"chat-header",children:[(0,Ng.jsx)("h1",{children:"AI Catering Assistant"}),n&&(0,Ng.jsxs)("div",{className:"event-context",children:[(0,Ng.jsx)("span",{className:"context-label",children:"Planning for:"}),(0,Ng.jsx)("span",{className:"context-value",children:null===(e=r.find(e=>e.id===n))||void 0===e?void 0:e.name})]})]}),(0,Ng.jsx)("div",{className:"chat-container",children:0!==o.length||c?(0,Ng.jsxs)("div",{className:"messages-container",children:[o.map(e=>(0,Ng.jsx)(Lw,{message:e,isUser:"user"===e.role},e.id)),d&&(0,Ng.jsxs)("div",{className:"thinking-indicator",children:[(0,Ng.jsxs)("div",{className:"typing-dots",children:[(0,Ng.jsx)("span",{}),(0,Ng.jsx)("span",{}),(0,Ng.jsx)("span",{})]}),(0,Ng.jsx)("span",{className:"thinking-text",children:"AI is thinking..."})]}),(0,Ng.jsx)("div",{ref:f})]}):(0,Ng.jsxs)("div",{className:"welcome-container",children:[(0,Ng.jsx)("div",{className:"welcome-icon",children:"\ud83e\udd16"}),(0,Ng.jsx)("h2",{children:"Welcome to your AI Assistant!"}),(0,Ng.jsx)("p",{children:"I'm here to help with all your catering needs."}),(0,Ng.jsx)(Fw,{onSelectPrompt:e=>{b(e)}})]})}),(0,Ng.jsx)(Mw,{onSendMessage:b,disabled:d||!p,placeholder:d?"AI is thinking...":"Ask me anything about catering..."})]})}function Vw(){return(0,Ng.jsx)(Ce,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:(0,Ng.jsx)(Sg,{children:(0,Ng.jsxs)(xe,{children:[(0,Ng.jsx)(be,{path:"/login",element:(0,Ng.jsx)(Pg,{})}),(0,Ng.jsx)(be,{path:"/*",element:(0,Ng.jsx)(Ag,{children:(0,Ng.jsx)(Ig,{children:(0,Ng.jsx)(Rg,{children:(0,Ng.jsxs)(xe,{children:[(0,Ng.jsx)(be,{path:"/",element:(0,Ng.jsx)(Og,{})}),(0,Ng.jsx)(be,{path:"/events",element:(0,Ng.jsx)(bv,{})}),(0,Ng.jsx)(be,{path:"/events/new",element:(0,Ng.jsx)(kv,{})}),(0,Ng.jsx)(be,{path:"/events/:id",element:(0,Ng.jsx)(xv,{})}),(0,Ng.jsx)(be,{path:"/events/:id/edit",element:(0,Ng.jsx)(kv,{})}),(0,Ng.jsx)(be,{path:"/events/:eventId/allergies",element:(0,Ng.jsx)(Tv,{})}),(0,Ng.jsx)(be,{path:"/recipes",element:(0,Ng.jsx)(Vg,{})}),(0,Ng.jsx)(be,{path:"/recipes/new",element:(0,Ng.jsx)(mv,{})}),(0,Ng.jsx)(be,{path:"/recipes/import",element:(0,Ng.jsx)(yv,{})}),(0,Ng.jsx)(be,{path:"/recipes/:id",element:(0,Ng.jsx)(hv,{})}),(0,Ng.jsx)(be,{path:"/recipes/:id/edit",element:(0,Ng.jsx)(mv,{})}),(0,Ng.jsx)(be,{path:"/menus",element:(0,Ng.jsx)(Rv,{})}),(0,Ng.jsx)(be,{path:"/menus/new",element:(0,Ng.jsx)(Iw,{})}),(0,Ng.jsx)(be,{path:"/menus/:id",element:(0,Ng.jsx)(Dv,{})}),(0,Ng.jsx)(be,{path:"/menus/:id/edit",element:(0,Ng.jsx)(Iw,{})}),(0,Ng.jsx)(be,{path:"/ingredients",element:(0,Ng.jsx)(Aw,{})}),(0,Ng.jsx)(be,{path:"/ingredients/new",element:(0,Ng.jsx)(Ow,{})}),(0,Ng.jsx)(be,{path:"/ingredients/:id",element:(0,Ng.jsx)(Rw,{})}),(0,Ng.jsx)(be,{path:"/ingredients/:id/edit",element:(0,Ng.jsx)(Ow,{})}),(0,Ng.jsx)(be,{path:"/chat",element:(0,Ng.jsx)(Uw,{})})]})})})})})]})})})}a.createRoot(document.getElementById("root")).render((0,Ng.jsx)(i.StrictMode,{children:(0,Ng.jsx)(Vw,{})}))})();
//# sourceMappingURL=main.8361646a.js.map